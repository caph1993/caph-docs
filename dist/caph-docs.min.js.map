{"version":3,"file":"caph-docs.min.js","mappings":"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","sources":["webpack://caph/./src/parser.js","webpack://caph/./src/utils.js","webpack://caph/webpack/bootstrap","webpack://caph/webpack/runtime/define property getters","webpack://caph/webpack/runtime/hasOwnProperty shorthand","webpack://caph/webpack/runtime/make namespace object","webpack://caph/./src/build-constants.js","webpack://caph/./src/script-loader.js","webpack://caph/./node_modules/.pnpm/preact@10.10.6/node_modules/preact/dist/preact.module.js","webpack://caph/./node_modules/.pnpm/preact@10.10.6/node_modules/preact/hooks/dist/hooks.module.js","webpack://caph/./src/preact-parser.js","webpack://caph/./src/preact-globals.js","webpack://caph/./src/main.js","webpack://caph/./src/index.js"],"sourcesContent":["//@ts-check\n/// <reference path=\"types.js\" />\nimport { isString, assert, assertNonNull } from \"./utils\";\n\n/** @typedef {({children, ...props})=>any} ComponentType*/\n/** @typedef {Object} AttributesType*/\n/** @typedef {string|ComponentType|null} TagType*/\n/**\n * @typedef {(type:any, props:any, ...children)=>(any extends Array? never: any)} CreateElementType\n*/\n/** @typedef {(text:string) => AstNode} RuleParser*/\n/** @typedef {{regStart:string, regEnd:string, parser:RuleParser}} CustomRule*/\n\n/**\n * @typedef {[null, null, AstNodeArray]|[string|ComponentType, AttributesType|null, AstNodeArray]} AstParent\n */\n/**\n * @typedef {string|AstParent} AstNode\n*/\n/** @typedef {AstNode[]} AstNodeArray*/\n\n\n\n/**@param {string} str*/\nfunction htmlSafe(str) {\n  // e.g. converts < into &lt;\n  return new Option(str).innerHTML;\n}\n\nconst htmlSafeUndo = (/** @type {string} */ str)=>{\n  // e.g. converts &lt; into <, etc. Prevents left trim caused by DOMParser\n  const [, l, content] = assertNonNull(str.match(/^(\\s*)(.*)$/s));\n  const doc = new DOMParser().parseFromString(content, \"text/html\");\n  const text = l+(doc.documentElement.textContent || '');\n  // if(str!=text) console.log(`Converted ${str} into ${text}`)\n  return text;\n}\n\n\n//https://stackoverflow.com/a/70329711\n\nexport const AstParser = (class {\n\n  ESC = '\\ue000';\n  SPEC = `https://html.spec.whatwg.org/multipage/syntax.html`;\n  DEBUG = false;\n\n\n  static parseAst(/** @type {TemplateStringsArray} */{raw:strings}, ...values){\n    const cls = this;\n    return new cls(strings, values).root\n  }\n\n  warn(...args){console.warn(...args)}; // Overriden during tests\n  error(...args){console.error(...args)}; // Overriden during tests\n\n\n  /**\n   * @param {readonly string[]} strings\n   * @param {readonly any[]} values\n   * @param {readonly CustomRule[]} customRules\n   * @param {0|1|2} debug\n  */\n  constructor(strings, values, customRules=[], debug=0){\n    /** @type {typeof AstParser} */ //@ts-ignore\n    this.cls = this.constructor;\n    let str = strings.join(this.ESC);\n    let escaped = {};\n    let regEscaped = new RegExp(`${this.ESC}|\\\\\\\\\"|\\\\\\\\'`, 'g');\n    str = str.replace(regEscaped, (match, index)=>{\n      //console.log(`Escaping ${match} at ${index}`);\n      escaped[index] = match;\n      return this.ESC;\n    });\n    this.pos = 0;\n    this.str = str;\n    this.values = values;\n    this.valueIndex = 0;\n    this.escaped = escaped;\n    this.errorStop = false;\n    debug && console.log('PARSING', this.str);\n    this.DEBUG = debug==2;\n\n    //console.log(this.cls);\n    /** @type {readonly CustomRule[]} */\n    this.customRules = customRules;\n    /** @type {(tag:TagType)=>(null|string[])} */\n    this.optionalClose = this.cls.optionalClose.bind(this.cls);\n\n    this.REG_EXP_TEXT = new RegExp(`.*?(?=${[\n      '$', '<', this.ESC,\n      ...this.customRules.map(({regStart})=>regStart),\n    ].join('|')})`, 'ys');\n\n    /**@type {AstParent} */\n    this.parent = [null, null, []];\n    /**@type {AstNode} */\n    this.root = this.parent;\n    this.parseRoot();\n\n    /**@param {CreateElementType} createElement @param {ComponentType} FragmentComponent*/\n    this.evalTree = (createElement, FragmentComponent)=>{\n      const evalTree = (/** @type {AstNode}*/ root) => {\n        if (!Array.isArray(root)) return root;\n        let [tag, props, children] = root;\n        if(tag=='@injected') return root[2][0];\n        assert(Array.isArray(children));\n        children = children.map(child =>evalTree(child));\n        if(tag==null){\n          assert(props==null);\n          tag = FragmentComponent;\n        }\n        return createElement(tag, props, ...children);\n      }\n      return evalTree(this.root);\n    }\n    \n  }\n  \n  parseRoot(){\n    try{\n      this.parseChildrenAndParentClose();\n      assert(this.parent===this.root);\n    } catch (error){\n      console.log(error);\n      if(error.name !== 'caph-parser-error') throw error;\n      if(this.pos==this.str.length && this.parent===this.root){\n        // Pass. Safe error: expected </> at end because we simulate a fragment root\n      } else{ this.error(error)}\n    }\n    if(this.parent===this.root && this.root[2].length == 1) this.root = this.root[2][0];\n  }\n\n  get parentTag(){ return this.parent[0]; }\n  get parentProps(){ return this.parent[1]; }\n  get children(){ return this.parent[2]; }\n\n  childlessTags = {\n    br: true, '!doctype': true, area: true, base: true, col: true, command: true, embed: true, hr: true,img: true, input: true, keygen: true, link: true, meta: true, param: true, source: true, track: true, wbr: true\n  };\n\n  // spacePreservingTags = {\n  //   pre: true, span: true, code: true, p: true, b: true, i: true,\n  //   a: true, li: true,\n  // };\n\n  // https://html.spec.whatwg.org/multipage/syntax.html#optional-tags\n  /** @type {{[key:string]:string[]}}*/\n  static _optionalClose = {\n    'li': ['li'],\n    'dt': ['dt', 'dd'],\n    'dd': ['dd', 'dt'],\n    'p': ['p', 'address', 'article', 'aside', 'blockquote', 'details', 'div', 'dl', 'fieldset', 'figcaption', 'figure', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'header', 'hgroup', 'hr', 'main', 'menu', 'nav', 'ol', 'pre', 'section', 'table'],\n    'rt': ['rt', 'rp'],\n    'rp': ['rp', 'rt'],\n    'optgroup': ['optgroup'],\n    'option': ['option', 'optgroup'],\n    //'caption': [], // Disabled rule\n    //'colgroup': [], // Disabled rule\n    'thead': ['tbody','tfoot'],\n    'tbody': ['tbody', 'tfoot'],\n    'tfoot': [],\n    'tr': ['tr'],\n    'td': ['td', 'th'],\n    'th': ['th', 'td'],\n  };\n\n  static optionalClose(/** @type {TagType}*/ tag){\n    if(!tag || !isString(tag)) return null;\n    return this._optionalClose[tag];\n  }\n\n  run(/** @type {RegExp}*/regExp){\n    // Execute the regular expression on str at pos, and move forward\n    const {pos, str} = this;\n    regExp.lastIndex = pos;\n    const match = regExp.exec(str);\n    if(!match) this.throw(`No match for ${regExp}`);\n    if(match.index<pos) throw `Regexp must use 'ys' flag. Match for at ${match.index} is before previous match at ${pos}`;\n    this.pos += match[0].length;\n    return match;\n  }\n\n  tryRun(/** @type {RegExp}*/regExp){\n    try{ return this.run(regExp); }\n    catch(e){ return null; }\n  }\n  tryRunUndo(/** @type {RegExp}*/regExp){\n    const pos = this.pos;\n    try{ return this.run(regExp); }\n    catch(e){ return null; }\n    finally{ this.pos = pos; }\n  }\n\n  debugPosition(delta=0, length=50){ // Just for printing debug info\n    const {pos, str} = this;\n    const at = Math.max(0, pos+delta);\n    const short = str.slice(at, at+length).replace('\\n', '(\\\\n)');\n    return `${at}...${short}...${at+length}`;\n  }\n\n  parseChildrenAndParentClose(){\n    /*\n      Parses the children of a parent tag or fragment.\n      Called (i) from the root level,\n      or (ii) after a parent \"head\" (`<div ...>`) has been consumed,\n      or (iii) after a sibling has been consumed entirely.\n     */\n    while(true){ // capture children until parent close tag is found or end is reached\n      this.DEBUG && console.log('parseSibling', this.parent, this.debugPosition());\n      // Parse text preceeding the first sibling\n      let [text] = this.run(this.REG_EXP_TEXT);\n      if(text.length) this.children.push(text);\n  \n      if(this.tryRun(new RegExp(`${this.ESC}`, 'ys'))){\n        let value = this.values[this.valueIndex++];\n        for(value of Array.isArray(value)?value:[value]){\n          if(value||value===0) this.children.push(['@injected', null, [value]]);\n        }\n        continue;\n      }\n\n      // Comment, DOCTYPE, or CDATA\n      if(this.str.startsWith('<!', this.pos)){\n        this.consumeComment();\n        continue;\n      }\n\n      let endReached = this.pos==this.str.length;\n      if(endReached && this.parentTag && !this.optionalClose(this.parentTag))\n          this.throw(`Expected closing tag </${this.parentTag}> or </>`);\n      if(endReached) break;\n      \n      if(this.customRules.length){\n        const parsedRule = (()=>{\n          for(let {regStart, regEnd, parser} of this.customRules){\n            let m = this.tryRun(new RegExp(`${regStart}(.*?)(${regEnd})`, 'ys'));\n            if(m) return parser(this.replaceText(m[1], this.pos-m[2].length-m[1].length));\n          }\n          return null;\n        })();\n        if(parsedRule){\n          this.children.push(parsedRule);\n          continue;\n        }\n      }\n\n      // Parent close\n      let /** @type {TagType} */ tag;\n      if(this.tryRun(/<\\/\\s*>/ys)) break;\n      if(this.tryRun(/<\\//ys)){\n        let result = this.tryRun(new RegExp(`([^>\\\\s]+)\\\\s*>`, 'ys'));\n        if(!result) this.throw(`Expected close tag for parent ${this.parentTag||'fragment'}`);\n        let _tag = result[1];\n        if (_tag==this.ESC) tag = this.values[this.valueIndex++];\n        else tag = _tag;\n        if(tag!==this.parentTag) this.throw(`Unmatched close tag ${tag}!=${this.parentTag}`);\n        break;\n      }\n\n      const optionalClose = this.optionalClose(this.parentTag);\n      if(optionalClose){\n        if((()=>{\n          for(let tag of optionalClose){\n            if(this.tryRunUndo(new RegExp(`<${tag}(>|\\\\s)`, 'ys'),)){\n              return true;\n            }\n          }\n        })()) break;\n      }\n\n      const /** @type {AstParent} */ newParent = [null, null, []];\n      this.children.push(newParent);\n\n      const grandParent = this.parent;\n      this.parent = newParent; // change parent temporarily\n      this.parseParent(grandParent); // this restores parent\n      \n      if(newParent[0] == null){ // shortcut fragment nieces as siblings\n        assert(this.children.pop() === newParent);\n        this.children.push(...newParent[2]);\n      }\n    }\n  }\n\n  parseParent(grandParent){\n    /*\n      Parses an element from the \"head\" opening (`<div ...>`)\n      until the \"tail\" close  (`</div>` or `</>`). \n      Called just at the beginning of the head opening.\n    */\n    this.DEBUG && console.log('parseParent ', this.parent, this.debugPosition());\n\n    let reg = new RegExp(`<([^\\\\s>\\\\/\\\\.]*)`, 'ys');\n    let _tag = this.run(reg)[1];\n    let /** @type {TagType} */ tag;\n    if (_tag==this.ESC){\n      tag = this.values[this.valueIndex++];\n      if(isString(tag)) this.throw(`Tag must be a component, not a string.`);\n    }\n    else if(!_tag.length) tag = null; //null means fragment\n    else if(_tag.match(/[^a-z0-9._-]/i)) this.throw(`Error with tag ${_tag}`);\n    else tag = _tag;\n    if (tag === undefined) this.throw(`Undefined component`);\n    \n    this.parent[0] = tag;\n    let admitsChildren = !this.childlessTags[(''+tag)?.toLowerCase()];\n    let /** @type {'jsx'|'tex'|'raw'|'pre'|null}*/ spacing=null;\n    \n    while(true){ // While attributes\n\n      this.run(/\\s*/ys); // Consume whitespace after `<div` or after attribute value\n      const endReached = this.pos==this.str.length;\n      if(endReached) this.throw(`Expected closing end ...> or .../> for tag ${tag}`);\n      \n      // Handle head close\n      if(this.tryRun(/\\/>/ys)){ admitsChildren = false; break; }\n      else if(this.tryRun(/>/ys)) break;\n\n      // Read next attribute\n      if(!this.parentProps) this.parent[1] = {};\n      if(this.tryRun(new RegExp(`\\\\.\\\\.\\\\.${this.ESC}`, 'ys'))){\n        this.parent[1] = {...this.parentProps, ...this.values[this.valueIndex++]};\n      }\n      else{\n        let [key] = this.run(/.*?(?=\\s|>|=)/ys);\n        let _value = this.tryRun(/=/ys) && this.run(new RegExp(`\\\\\".*?\\\\\"|\\\\'.*?\\\\'|${this.ESC}`, 'ys'))[0];\n        let value;\n        // .innerHTML may transform `<div attr >` into `< attr=\"\" >`\n        if(!_value || _value==\"''\"||_value=='\"\"') value = true; \n        else if(_value==this.ESC) value = this.values[this.valueIndex++];\n        else value = this.replaceText(_value.slice(1,-1), this.pos-_value.length+1); // slice for quotes\n        if(key.endsWith('-eval')){\n          key = key.slice(0,-5);\n          value = eval(value);\n        }\n        const prevValue = this.parentProps[key];\n        if(key=='class') value = !prevValue?value:prevValue+' '+value;\n        else if(key=='style') value = !prevValue?value:prevValue+' '+value;\n        else if(prevValue!==undefined) this.warn(`Replacing attribute ${key}.\\nPrevious and new values:`, prevValue, value);\n        \n        if(key.startsWith('(')){\n          if(key=='(component)') {} // ?? temporary code\n          else if(key=='(spacing)'){\n            if(!['jsx', 'pre', 'tex', 'raw'].includes(value)) this.throw(`Invalid spacing mode: ${value}`);\n            spacing = value;\n            continue;\n          } else this.throw(`Invalid attribute: ${key}`);\n        }\n        this.parentProps[key] = value;\n      }\n    }\n\n    if(admitsChildren){\n      if(tag=='style'){ // Style is closed differently\n        let m = this.tryRun(/(.*?)<\\/style\\s*>/ys);\n        if(!m) this.throw(`Style tag not closed properly.`);\n        this.parent[2] = [m[1]];\n      } else if(tag=='script'){ // Script is closed differently\n        let m = this.tryRun(/(.*?)<\\/script\\s*>/ys);\n        if(!m) this.throw(`Script tag not closed properly.`);\n        let code = m[1];\n        if(code.match(/^\\s*(String\\.raw)?\\`(.*)\\`\\s*$/ys)){\n          code = eval(code);\n          code = htmlSafe(code);\n          this.parent[0] = 'div';\n          this.parent[1] = {'(component)':'code', ...this.parentProps};\n          this.parent[2] = [code];\n        } else{\n          this.parent[2] = [code];\n        }\n      } else{\n        this.parseChildrenAndParentClose(); // (Huge step)\n        if(!spacing){\n          if(!isString(tag)) spacing = 'jsx';\n          else if(tag=='pre' || tag=='textarea') spacing = 'pre';\n          else spacing = 'jsx';\n        }\n        if(spacing=='jsx') this.parent[2] = this.cls.spacingRulesJsx(this.children);\n        else if(spacing=='tex') this.parent[2] = this.cls.spacingRulesParagraphs(this.children);\n      }\n    }\n    this.parent = grandParent;\n  }\n\n  static spacingRulesJsx(children){ // JSX spacing\n    // https://reactjs.org/blog/2014/02/20/react-v0.9.html#jsx-whitespace\n    // https://www.w3.org/TR/REC-html40/struct/text.html#h-9.1\n    // https://stackoverflow.com/q/433493\n    \n    function trimText(text){\n      // End spaces are preserved only if they are inline\n      return text.replace(/^(\\s*)(.*?)(\\s*)$/s, (_, l, middle, r)=>{\n        if(l.includes('\\n')) l='';\n        if(r.includes('\\n')) r='';\n        return `${l}${middle}${r}`\n      });\n    }\n    const ESC = '\\ue000';\n    const stack = children.filter(x=>!isString(x)).reverse();\n    const text = children.map(x=>isString(x)?x:ESC).join('');\n    const newChildren = [];\n    text.split(ESC).forEach((str, i)=>{\n      if(i) newChildren.push(stack.pop());\n      if(str.length) str = trimText(str);\n      if(str.length) newChildren.push(str);\n    })\n    assert(stack.length==0);\n    return newChildren;\n  }\n\n  // https://html.spec.whatwg.org/multipage/syntax.html#element-restrictions\n  static spacingRulesPre(children){\n    const first = children[0];\n    if(isString(first) && first.startsWith('\\n')) children[0] = children[0].slice(1);\n    return children;\n  }\n\n  static spacingRulesParagraphs(children){\n    const ESC = '\\ue000';\n    const stack = children.filter(x=>!isString(x)).reverse();\n    const text = children.map(x=>isString(x)?x:ESC).join('');\n    /** @type {AstNode[]}*/\n    const newChildren = text.split(/\\s*?\\n\\s*?\\n\\s*/s).map(text=>{\n      const elems = [];\n      text.split(ESC).forEach((str, i)=>{\n        if(i) elems.push(stack.pop());\n        if(str.length) elems.push(str);\n      })\n      return ['div', {'class':\"caph-paragraph\"}, elems];\n    });\n    assert(stack.length==0);\n    return newChildren;\n  }\n\n  /** @type {(reason:string)=>never}*/\n  throw(reason){\n    const error = new Error(`${reason}\n      Ignoring what follows.\n      Error occurred here:\n      ${this.debugPosition(-5)}\n    `);\n    error.name = 'caph-parser-error';\n    throw error;\n  }\n\n  consumeComment(){\n    const regComment = new RegExp(\n      [`<!--.*?-->`, `<!\\\\[CDATA\\\\[.*?\\\\]\\\\]>`, `<!DOCTYPE\\\\s*.*?>`,].join('|'),\n      'iys',\n    );\n    let result = this.tryRun(regComment);\n    if(!result) this.throw(`Unexpected <!`);\n    let [text] = result;\n    if(text.endsWith('/>')) this.warn(`Non compliant tag found.\\n${this.SPEC}`);\n    this.replaceText(text, this.pos-text.length); // Consume the fields inside, if any\n  }\n\n  /**\n   * @param {string} text\n   * @param {number} posOfText\n   * @returns {string}*/\n  replaceText(text, posOfText){\n    return text.replace(new RegExp(this.ESC, 'g'), (_, index)=>{\n      assert(this.str[posOfText+index] === this.ESC);\n      const original = this.escaped[posOfText+index];\n      if (original != this.ESC) return original;\n      return this.values[this.valueIndex++];\n    });\n  }\n  // asString(obj) {\n  //   let out = `${obj}`;\n  //   if (out == \"[object Object]\") {\n  //     // let seen = [];\n  //     // out = JSON.stringify(obj, function (key, val) {\n  //     //   if (val != null && typeof val == \"object\") {\n  //     //     if (seen.indexOf(val) >= 0) return;\n  //     //     seen.push(val);\n  //     //   }\n  //     //   return val; // https://stackoverflow.com/q/9382167\n  //     // });\n  //     out = obj; //PROBLEM\n  //   }\n  //   return out;\n  // }\n\n});\n\n\nconst exampleCreateElement = /**@type {CreateElementType} */ (type, props, ...children)=> (!type||isString(type))? {tag:type, props, children} : type({children, ...props});\n\nconst exampleFragmentComponent = /**@type {ComponentType} */  (({children})=>({tag:null, props:null, children}));\n\nconst exampleCustomRules = /** @type {CustomRule[]} */ [\n  {\n    regStart: `(?<!\\\\\\\\)\\\\$\\\\$`,\n    regEnd: `(?<!\\\\\\\\)\\\\$\\\\$`,\n    parser: /**@type {RuleParser}*/ ((text)=>['div', {'(component)': '@math', displayMode:true}, [text]]),\n  },\n  {\n    regStart: `(?<!\\\\\\\\)\\\\$`,\n    regEnd: `(?<!\\\\\\\\)\\\\$`,\n    parser: /**@type {RuleParser}*/ ((text)=>['div', {'(component)': '@math', displayMode:false}, [text]]),\n  },\n  {\n    regStart: `(?<!\\\\\\\\)\\`\\`\\``,\n    regEnd: `(?<!\\\\\\\\)\\`\\`\\``,\n    parser: /**@type {RuleParser}*/ ((text)=>{\n      text = text.replace(/\\\\\\`\\`\\`/g, '```');\n      let progLang = assertNonNull(text.match(/^[^\\n]*/));\n      return ['div', {'(component)': '@code', ...(!progLang.length?{}:{progLang})}, [text]];\n    }),\n  },\n  {\n    regStart: `(?<!\\\\\\\\)\\``,\n    regEnd: `(?<!\\\\\\\\)\\``,\n    parser: /**@type {RuleParser}*/ ((text)=>{\n      text = text.replace(/\\\\\\`/g, '`');\n      return ['div', {'(component)': '@code'}, [text]]\n    }),\n  },\n];\n\n\n\nexport const createParser = ()=>{\n\n  const settings = {\n    createElement: exampleCreateElement,\n    FragmentComponent: exampleFragmentComponent,\n    customRules: exampleCustomRules,\n    debug: /** @type {0|1|2}*/(0),\n  }\n  \n  const parseAst = (/** @type {TemplateStringsArray} */ templateString, ...values)=> new AstParser(templateString.raw, values, settings.customRules, settings.debug);\n  \n  const parse = (/** @type {TemplateStringsArray} */ templateString, ...values)=> parseAst(templateString, ...values).evalTree(settings.createElement, settings.FragmentComponent);\n\n  const astUndoHtml = (/** @type {AstNode}*/ root) => {\n    if (isString(root)) return htmlSafeUndo(root);\n    if (!Array.isArray(root)) return root;\n    root[2] = root[2].map(child => astUndoHtml(child));\n    return root;\n  }\n  const parseAstHtml = (/** @type {string}*/str) => {\n    // Parse html, undoing html safe conversions, and then create element\n    let tmp = /** @type {TemplateStringsArray}*/(/**@type {any}*/({raw:[str]}));\n    let ast = parseAst(tmp);\n    ast.root = astUndoHtml(ast.root)\n    return ast;\n  }\n  const parseHtml = (/** @type {string}*/str) => parseAstHtml(str).evalTree(settings.createElement, settings.FragmentComponent);\n\n  return { settings, parse, parseAst, parseAstHtml, parseHtml, }\n}\n\n","//@ts-check\n\n/** https://github.com/Microsoft/TypeScript/issues/23405#issuecomment-873331031 */\n/** @template T  @param {T} value @param {string} [valueName] @returns {T extends undefined ? never : T} */\nexport function assertDefined(value, valueName) {\n  if (value === undefined) {\n    throw new Error(`Encountered unexpected undefined value${valueName? ` for '${valueName}'` : \"\"}`);\n  }\n  return /** @type {*} */ (value);\n}\n\n/** @template T @param {T} value @returns {T extends null ? never : T} */\nexport function assertNonNull(value) {\n  if (!value && (value===null||value === undefined)) throw new Error(`Encountered unexpected undefined value`);\n  return /** @type {*} */ (value);\n}\n\n/** @template T @param {T} value @returns {T extends null ? never : T} */\nexport function nonNull(value) { return /** @type {*} */ (value); }\n\n\n/** @type {(obj: any) => obj is String} */\nexport function isString(obj) {\n  return Object.prototype.toString.call(obj) === \"[object String]\";\n}\n\n// utils = {\n//   unindent: (text) => {\n//     let lines = text.split('\\n');\n//     let n = lines.filter(l => l.trim().length)\n//       .map(l => l.length - l.trimStart().length)\n//       .reduce((p, c) => Math.min(c, p), 1000);\n//     return lines.map(l => l.slice(n)).join('\\n');\n//   }\n// };\n// _URL_resolve(url) {\n//   return new URL(url, document.baseURI).href;\n// }\n// // _URL_is_absolute(url) {\n// //   //https://stackoverflow.com/q/10687099\n// //   return new URL(document.baseURI).origin !== new URL(url, document.baseURI).origin;\n// // }\n\n// _html_safe(str) {\n//   // e.g. converts < into &lt;\n//   return new Option(str).innerHTML;\n// }\n// _html_safe_undo(str) {\n//   // e.g. converts &lt; into <\n//   const doc = new DOMParser().parseFromString(str, \"text/html\");\n//   const text = doc.documentElement.textContent;\n//   return text;\n// }\n\n\nexport function assert(/** @type {boolean|any}*/condition, ...messages) {\n  if (condition) return;\n  throw new Error(...messages);\n}\n\nexport function sleep(/** @type {number}*/ms) {\n  return new Promise((ok, err) => setTimeout(ok, ms));\n}\n\nclass MyBoolean {\n  static assert(condition, ...messages) {\n    if (condition) return;\n    throw new Error(...messages);\n  }\n  static all(arr) {\n    for (let x of arr) if (!x) return false;\n    return true;\n  }\n  static any(arr) {\n    for (let x of arr) if (x) return true;\n    return false;\n  }\n  static assert_all(arr, ...messages) { assert(this.all(arr), ...messages); }\n  static assert_any(arr, ...messages) { assert(this.any(arr), ...messages); }\n}\n\n\nclass MyArray {\n  static any(arr) {\n    for (let x of arr) if (x) return true;\n    return false;\n  }\n  static all(arr) {\n    for (let x of arr) if (!x) return false;\n    return true;\n  }\n  static sum(arr) {\n    return arr.reduce((p, c) => p + c, 0);\n  }\n  static max(arr, initialValue) {\n    initialValue = initialValue || 0;\n    return arr.reduce((p, c) => Math.max(p, c), initialValue);\n  }\n  static min(arr, initialValue) {\n    initialValue = initialValue || 1e10;\n    return arr.reduce((p, c) => Math.min(p, c), initialValue);\n  }\n  static zeros(n) {\n    const l = [];\n    for (let i = 0; i < n; i++)l.push(0);\n    return l;\n  }\n  static arange(n) {\n    return MyArray.zeros(n).map((z, i) => i);\n  }\n  static sEquality(a, b) {\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length !== b.length) return false;\n    for (let i = 0; i < a.length; ++i) if (a[i] != b[i]) return false;\n    return true;\n  }\n  static hEquality(a, b) {\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length !== b.length) return false;\n    for (let i = 0; i < a.length; ++i) if (a[i] !== b[i]) return false;\n    return true;\n  }\n}\n\nexport class MyPromise {\n  static async sleep(ms) {\n    await new Promise((ok, err) => setTimeout(ok, ms));\n  }\n  static async finish_all(promises, { debug = false } = {}) {\n    // Ensures completion of all promises even if some throw exceptions\n    return await new Promise((ok, err) => {\n      if (promises.length == 0) return ok([]);\n      let any_error = false;\n      let cnt = 0;\n      let outs = promises.map((p) => null);\n      Promise.all(promises.map(async (p, i) => {\n        try { outs[i] = await p; }\n        catch (e) {\n          any_error = true; outs[i] = e;\n          if (debug) console.error(...e);\n        }\n        cnt++;\n        if (cnt == promises.length) {\n          if (any_error) err(outs);\n          else ok(outs);\n        }\n      }));\n    });\n  }\n  static async finish_all_log(promises) {\n    try { var outs = await MyPromise.finish_all(promises); }\n    catch (err) {\n      var outs = err; console.error(...err);\n      err.forEach(e => console.warn(...e));\n    }\n    return outs;\n  }\n\n  static async until(/** @type {()=>any}*/ func, { ms = 200, timeout = 0 } = {}) {\n    if (timeout && ms > timeout) ms = timeout / 10;\n    let t0 = (new Date()).getTime();\n    let value;\n    while (!(value = await func())) {\n      if (timeout && (new Date()).getTime()-t0 > timeout)\n        throw MyPromise.Timeout;\n      await sleep(ms);\n    }\n    return value;\n  }\n  static Timeout = new Error('Timeout');\n  static async timeout(promise, ms) {\n    let finished = false;\n    let [resp, _] = await Promise.all([\n      promise.then(e => { finished = true; return e; }),\n      MyPromise.until(() => finished, { timeout: ms })\n    ]);\n    return resp;\n  }\n}\nexport const until=MyPromise.until;\n\n\nexport class MyDocument {\n\n  /**\n   * @param {string} tag \n   * @param {{\n   *  style?: {[key: string]: string},\n   *  id?: string,\n   * classList?: string[],\n   * text?: string,\n   * html?: string,\n   * eventListeners?: {[key: string]: (e: Event) => void},\n   * parent?: HTMLElement,\n   * where?: 'beforebegin' | 'afterbegin' | 'beforeend' | 'afterend',\n   * }} options\n   * @returns {HTMLElement}\n   */\n  static createElement(tag, {\n    style = {}, id, classList = [], text, html,\n    eventListeners = {}, parent, where, ...attrs } = {}) {\n    let e = document.createElement(tag);\n    if(id!==undefined) e.setAttribute(\"id\", id);\n    classList.forEach(s => e.classList.add(s));\n    if (text !==undefined) e.innerText = text;\n    if (html !==undefined) e.innerHTML = html;\n    if (id !==undefined) e.id = id;\n    MyObject.forEach(attrs, (value, key) => e.setAttribute(key, value));\n    MyObject.forEach(style, (value, key) => e.style[key] = value);\n    MyObject.forEach(eventListeners, (value, key) =>\n      e.addEventListener(key, value));\n    if (parent || where) {\n      parent = parent || document.body;\n      where = where || 'beforeend';\n      parent.insertAdjacentElement(where, e);\n    }\n    return e;\n  }\n  static right_click(element) {\n    element.focus();\n    if (window.CustomEvent) {\n      element.dispatchEvent(new CustomEvent('contextmenu'));\n    } else if (document.createEvent) {\n      var ev = document.createEvent('HTMLEvents');\n      ev.initEvent('contextmenu', true, false);\n      element.dispatchEvent(ev);\n    } else { // Internet Explorer\n      element.fireEvent('oncontextmenu');\n    }\n    // return;\n    // element.focus();\n    // let e = element.ownerDocument.createEvent('MouseEvents');\n    // e.initMouseEvent('contextmenu', true, true,\n    //   element.ownerDocument.defaultView, 1, 0, 0, 0, 0, false,\n    //   false, false, false, 2, null);\n    // return !element.dispatchEvent(e);\n  }\n}\n\nclass MyObject {\n\n  static indexBy(arr, key) {\n    let M = {};\n    arr.forEach((obj) => {\n      let value = obj[key];\n      M[value] = obj;\n    });\n    return M;\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static map(obj, func) {\n    return MyObject._object_op('map', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(boolean|any))} func */\n  /** @returns {Object} */\n  static filter(obj, func) {\n    return MyObject._object_op('filter', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static apply(obj, func) {\n    return MyObject._object_op('apply', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static forEach(obj, func) {\n    return MyObject._object_op('forEach', obj, func);\n  }\n\n  /** @param {Object} src */\n  /** @param {'apply'|'filter'|'forEach'|'map'} op*/\n  static _object_op(op, src, func) {\n    assert(1 <= func.length && func.length <= 3);\n    let dest = {};\n    for (let key of Object.keys(src)) {\n      let value = src[key]\n      let result = MyObject._func(func, value, key, src);\n      if (op == 'map') dest[key] = result;\n      else if (op == 'filter') { if (result) dest[key] = value; }\n      else if (op == 'apply') src[key] = result;\n      else if (op == 'forEach') 1 == 1;\n    }\n    return (op == 'map' || op == 'filter') ? dest : null;\n  }\n\n  static _func(func, value, key, src) {\n    return (\n      func.length == 1 ? func(value)\n        : func.length == 2 ? func(value, key)\n          : func(value, key, src)\n    );\n  }\n\n  static reduce_dots(obj) {\n    // converts {'a.b':1, 'a.c':2, b:3} into {a:{b:1,c:2}, 'b':3}. Returns copy (shallow or deep)\n    let dotted = MyObject.filter(obj, (v, k) => k.indexOf('.') >= 0);\n    let no_dots = MyObject.filter(obj, (v, k) => k.indexOf('.') == -1);\n    if (Object.keys(dotted).length == 0) return no_dots;\n    MyObject.forEach(dotted, (v, k) => {\n      let start = k.slice(0, k.indexOf('.'));\n      let end = k.slice(k.indexOf('.') + 1);\n      no_dots[start] = no_dots[start] || {};\n      no_dots[start][end] = v;\n    });\n    return MyObject.reduce_dots(no_dots);\n  }\n\n  static deep_assign(obj, ...objs) {\n    for (let o of objs) {\n      if (!o) continue;\n      for (let key of Object.keys(o)) {\n        if (obj[key] === undefined || typeof (o[key]) != \"object\") obj[key] = o[key];\n        else MyObject.deep_assign(obj[key], o[key]);\n      }\n    }\n    return obj;\n  }\n\n  static deep_copy(obj, ...objs) {\n    if (obj === undefined) return undefined;\n    if (obj === null) return null;\n    if (Array.isArray(obj))\n      return obj.map(x => MyObject.deep_copy(x));\n    if (typeof (obj) == \"object\")\n      return MyObject.map(obj, value => MyObject.deep_copy(value));\n    if (typeof (obj) == \"function\")\n      return obj; // DOES NOT CREATE COPY FOR FUNCTIONS\n    return MyObject.deep_assign(obj, ...objs);\n  }\n\n  static deep_default(default_obj, ...objs) {\n    let obj = MyObject.deep_copy(default_obj);\n    return MyObject.deep_assign(obj, ...objs);\n  }\n\n  /** @param {((value:any, key?:any, obj?:any)=>(boolean|any))} filter_func */\n  static find(obj, filter_func) {\n    for (let key in obj)\n      if (MyObject._func(filter_func, obj[key], key))\n        return key;\n    return null;\n  }\n  static toEntries(obj) {\n    return Object.keys(obj).map(k => [k, obj[k]]);\n  }\n}\n\n\nclass MyDecorators {\n  static once(fn) {\n    let returnValue, canRun = true;\n    return function runOnce() {\n      if (canRun) {\n        returnValue = fn.apply(this, arguments);\n        canRun = false;\n      }\n      return returnValue;\n    }\n  }\n}\n\n\nfunction get_property_handler(object, property) {\n  let access, proto = object;\n  object._hidden_modified = false;\n  while (!access) {\n    proto = Object.getPrototypeOf(proto);\n    access = Object.getOwnPropertyDescriptor(proto, property);\n  }\n  return access;\n}\n\nfunction update_property_handler(object, property, create_handler) {\n  let prev = get_property_handler(object, property);\n  Object.defineProperty(object, property, create_handler(prev));\n}\n\n\nexport const Queue = class {\n\n  constructor(arr) {\n    this.data = [...(arr || []), null];\n    this.lr = [0, (arr?arr.length:0)];\n  }\n  get capacity() {\n    return this.data.length;\n  }\n  get length() {\n    const [i, j] = this.lr;\n    return j >= i ? j - i : this.capacity - i + j;\n  }\n  toArray() {\n    const [i, j] = this.lr;\n    if (j >= i) return this.data.slice(i, j);\n    else return this.data.slice(i).concat(this.data.slice(0, j));\n  }\n  [Symbol.iterator]() {\n    let index = -1;\n    // copy because I would need to update the pointer during resizing. Could be done.\n    let data = [...this.toArray()];\n    return {\n      next: () => ({\n        value: data[++index],\n        done: !(index in data)\n      })\n    };\n  };\n  resize(newLength) {\n    if (newLength === undefined) {\n      if (this.length + 2 >= this.capacity)\n        return this.resize(1 + 3 * this.length);\n      if (this.length <= this.capacity >> 2)\n        return this.resize(this.capacity >> 1);\n      return;\n    }\n    const arr = this.toArray()\n    this.data = [...arr, ...new Array(newLength - arr.length).fill(null)];\n    this.lr = [0, arr.length];\n  }\n  _mod_add(lrIndex, retK, afterK) {\n    const mod = this.capacity;\n    const add = (i, k) => ((i % mod) + k + mod) % mod;\n    const out = add(this.lr[lrIndex], retK);\n    this.lr[lrIndex] = add(this.lr[lrIndex], afterK);\n    return out;\n  }\n  pushRight(x) {\n    this.resize();\n    this.data[this._mod_add(1, 0, +1)] = x;\n  }\n  pushLeft(x) {\n    this.resize();\n    this.data[this._mod_add(0, -1, -1)] = x;\n  }\n  popRight() {\n    this.resize();\n    return this.data[this._mod_add(1, -1, -1)];\n  }\n  popLeft() {\n    this.resize();\n    return this.data[this._mod_add(0, 0, +1)];\n  }\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","//@ts-check\n\nconst compressed = [];\nexport const distPlugins = [\n  'core-menu',\n  'core-about',\n  'katex',\n  'codemirror',\n  'phonetics',\n  // 'fabric.lz.js',\n  // 'mathjax-svg',\n  // // 'gtag',\n  // 'document',\n  // 'slides',\n  // 'whiteboard',\n  // //'figure-editor',\n  // 'hyphenator',\n  // 'auto-scroll',\n].map(name=>({\n  key: `@${name}`,\n  dist: `@dist/components/${name}${compressed.includes(name)?'.lz':''}.js`,\n  src: `plugins/${name}/plugin-${name}.js`,\n}));\n\nexport const compressor = {\n  dist: '@dist/lzutf8.min.js',\n  src: 'libraries/lzutf8-0.6.3/lzutf8.min.js',\n};\n\n/**@param {any} compressor @param {string} text @returns {string}*/\nexport const compress = (compressor, text)=> compressor.compress(text, {outputEncoding: 'Base64'});\n\n/**@param {any} compressor @param {string} text @returns {string}*/\nexport const decompress = (compressor, text)=> compressor.decompress(text, {inputEncoding: 'Base64'});\n\n","//@ts-check\nimport { MyDocument, sleep, until } from \"./utils\";\nimport {compressor, decompress, distPlugins} from \"./build-constants\";\n\n\nconst plugins = Object.fromEntries(distPlugins.map(e => [e.key, e]));\n\nexport const scriptLoader = (()=>{\n\n  let dist = './dist';\n  for (const e of document.querySelectorAll('script')) {\n    const m = e.src.match(/^(.*)\\/caph-docs\\.(?:min\\.)?js$/)\n    if (m) dist = m[1];\n  }\n  //console.log(dist);\n\n  const div = document.getElementById('core-sources') || MyDocument.createElement('div', {\n    id: 'core-sources',\n    parent: document.head,\n    where: 'beforeend',\n  });\n\n\n  const _randomSessionSuffix = ('' + Math.random()).slice(2);\n  const parseKey = (/** @type {string} */ key)=>{\n    // key is like either 'userComponent', './userFileComponent', '@caphPlugin', '@dist/caphPlugin', 'full URL'\n    let url = key.replace(/^@dist\\/(.*)$/, (_, p)=>`${dist}/${p}`);\n    if(url.startsWith('./')) url += `?${_randomSessionSuffix}`;\n    url = new URL(url, document.baseURI).href;\n    /** @type {string|null} */\n    let proxyKey = null;\n    if(plugins[key]) ({dist:proxyKey} = plugins[key]);\n    return {url, proxyKey};\n  }\n\n  /**\n   * @param {string} ref \n   * @param {{\n   * parent?: HTMLElement|null,\n   * where?: 'beforebegin' | 'afterbegin' | 'beforeend' | 'afterend',\n   * attrs?: {[key:string]:string},\n   * autoAttrs?: boolean,\n   * isCompressed?: boolean|null,\n   * msTimeout?: number,\n   * }} options\n   */\n  const load = (ref, { attrs={}, parent=null, where='beforeend', autoAttrs=true} = {})=>{\n    ({url:ref} = parseKey(ref)); // especially for plugin loading libraries\n    const refBase = ref.split('#')[0].split('?')[0]\n    if (parent == null) parent = div;\n    const ext = refBase.split('.').pop();\n    let tag = ext == 'js' ? 'script' : ext == 'css' ? 'link' : null;\n    if (tag == null) throw new Error('Only .js and .css files can be _sources. Got: ' + ext + ' ' + ref);\n    let /** @type {{[key:string]:string}}*/ defaults = {};\n    if (autoAttrs && tag == 'link') defaults = { rel: 'stylesheet', type: 'text/css' };\n    Object.keys(attrs).forEach(k => defaults[k] = attrs[k]);\n    attrs = defaults;\n    if (tag == 'script') attrs.src = ref;\n    if (tag == 'link') attrs.href = ref;\n    _load_elem(ref, tag, attrs, parent, where);\n  }\n\n  // const loadFont = async(/** @type {string}*/name)=>{\n  //   return await load(`${dist}/font-${name}.css`);\n  // }\n  // async loadPlugin(name) {\n  //   return await this.load(`${dist}/plugin-${name}.js`);\n  // }\n\n  const status = {};\n\n  const _load_elem = (ref, tag, attrs, parent, where) => new Promise((_ok, _err) => {\n    if (status[ref]) return _ok(null); \n    status[ref] = true;\n    let e = document.createElement(tag);\n    for(let key in attrs) e.setAttribute(key, attrs[key]);\n    let done = false;\n    e.onload = () => { if (!done) { done = true; _ok(null); } };\n    e.onerror = (err) => { if (!done) { done = true; _err(err); } }; // HTTP errors only\n    parent.insertAdjacentElement(where, e);\n  });\n\n  const injectStyle = (/** @type {string} */ styleStr)=>{\n    MyDocument.createElement('style', { parent: div, where: 'beforeend', text: styleStr });\n  }\n  return {injectStyle, load, div, dist, parseKey};\n})();\n\nexport const parseKey = scriptLoader.parseKey;\nexport const injectStyle = scriptLoader.injectStyle;\nexport const load = scriptLoader.load;\n","var n,l,u,i,t,o,r,f={},e=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function s(n,l){for(var u in l)n[u]=l[u];return n}function a(n){var l=n.parentNode;l&&l.removeChild(n)}function h(l,u,i){var t,o,r,f={};for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return v(l,f,t,o,null)}function v(n,i,t,o,r){var f={type:n,props:i,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++u:r};return null==r&&null!=l.vnode&&l.vnode(f),f}function y(){return{current:null}}function p(n){return n.children}function d(n,l){this.props=n,this.context=l}function _(n,l){if(null==l)return n.__?_(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?_(n):null}function k(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k(n)}}function b(n){(!n.__d&&(n.__d=!0)&&t.push(n)&&!g.__r++||o!==l.debounceRendering)&&((o=l.debounceRendering)||setTimeout)(g)}function g(){for(var n;g.__r=t.length;)n=t.sort(function(n,l){return n.__v.__b-l.__v.__b}),t=[],n.some(function(n){var l,u,i,t,o,r;n.__d&&(o=(t=(l=n).__v).__e,(r=l.__P)&&(u=[],(i=s({},t)).__v=t.__v+1,j(r,t,i,l.__n,void 0!==r.ownerSVGElement,null!=t.__h?[o]:null,u,null==o?_(t):o,t.__h),z(u,t),t.__e!=o&&k(t)))})}function w(n,l,u,i,t,o,r,c,s,a){var h,y,d,k,b,g,w,x=i&&i.__k||e,C=x.length;for(u.__k=[],h=0;h<l.length;h++)if(null!=(k=u.__k[h]=null==(k=l[h])||\"boolean\"==typeof k?null:\"string\"==typeof k||\"number\"==typeof k||\"bigint\"==typeof k?v(null,k,null,null,k):Array.isArray(k)?v(p,{children:k},null,null,null):k.__b>0?v(k.type,k.props,k.key,null,k.__v):k)){if(k.__=u,k.__b=u.__b+1,null===(d=x[h])||d&&k.key==d.key&&k.type===d.type)x[h]=void 0;else for(y=0;y<C;y++){if((d=x[y])&&k.key==d.key&&k.type===d.type){x[y]=void 0;break}d=null}j(n,k,d=d||f,t,o,r,c,s,a),b=k.__e,(y=k.ref)&&d.ref!=y&&(w||(w=[]),d.ref&&w.push(d.ref,null,k),w.push(y,k.__c||b,k)),null!=b?(null==g&&(g=b),\"function\"==typeof k.type&&k.__k===d.__k?k.__d=s=m(k,s,n):s=A(n,k,d,x,b,s),\"function\"==typeof u.type&&(u.__d=s)):s&&d.__e==s&&s.parentNode!=n&&(s=_(d))}for(u.__e=g,h=C;h--;)null!=x[h]&&(\"function\"==typeof u.type&&null!=x[h].__e&&x[h].__e==u.__d&&(u.__d=_(i,h+1)),N(x[h],x[h]));if(w)for(h=0;h<w.length;h++)M(w[h],w[++h],w[++h])}function m(n,l,u){for(var i,t=n.__k,o=0;t&&o<t.length;o++)(i=t[o])&&(i.__=n,l=\"function\"==typeof i.type?m(i,l,u):A(u,i,i,t,i.__e,l));return l}function x(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(Array.isArray(n)?n.some(function(n){x(n,l)}):l.push(n)),l}function A(n,l,u,i,t,o){var r,f,e;if(void 0!==l.__d)r=l.__d,l.__d=void 0;else if(null==u||t!=o||null==t.parentNode)n:if(null==o||o.parentNode!==n)n.appendChild(t),r=null;else{for(f=o,e=0;(f=f.nextSibling)&&e<i.length;e+=2)if(f==t)break n;n.insertBefore(t,o),r=o}return void 0!==r?r:t.nextSibling}function C(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||H(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||H(n,o,l[o],u[o],i)}function $(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=null==u?\"\":\"number\"!=typeof u||c.test(l)?u:u+\"px\"}function H(n,l,u,i,t){var o;n:if(\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof i&&(n.style.cssText=i=\"\"),i)for(l in i)u&&l in u||$(n.style,l,\"\");if(u)for(l in u)i&&u[l]===i[l]||$(n.style,l,u[l])}else if(\"o\"===l[0]&&\"n\"===l[1])o=l!==(l=l.replace(/Capture$/,\"\")),l=l.toLowerCase()in n?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?i||n.addEventListener(l,o?T:I,o):n.removeEventListener(l,o?T:I,o);else if(\"dangerouslySetInnerHTML\"!==l){if(t)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"href\"!==l&&\"list\"!==l&&\"form\"!==l&&\"tabIndex\"!==l&&\"download\"!==l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null!=u&&(!1!==u||\"a\"===l[0]&&\"r\"===l[1])?n.setAttribute(l,u):n.removeAttribute(l))}}function I(n){this.l[n.type+!1](l.event?l.event(n):n)}function T(n){this.l[n.type+!0](l.event?l.event(n):n)}function j(n,u,i,t,o,r,f,e,c){var a,h,v,y,_,k,b,g,m,x,A,C,$,H=u.type;if(void 0!==u.constructor)return null;null!=i.__h&&(c=i.__h,e=u.__e=i.__e,u.__h=null,r=[e]),(a=l.__b)&&a(u);try{n:if(\"function\"==typeof H){if(g=u.props,m=(a=H.contextType)&&t[a.__c],x=a?m?m.props.value:a.__:t,i.__c?b=(h=u.__c=i.__c).__=h.__E:(\"prototype\"in H&&H.prototype.render?u.__c=h=new H(g,x):(u.__c=h=new d(g,x),h.constructor=H,h.render=O),m&&m.sub(h),h.props=g,h.state||(h.state={}),h.context=x,h.__n=t,v=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=H.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=s({},h.__s)),s(h.__s,H.getDerivedStateFromProps(g,h.__s))),y=h.props,_=h.state,v)null==H.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==H.getDerivedStateFromProps&&g!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(g,x),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(g,h.__s,x)||u.__v===i.__v){h.props=g,h.state=h.__s,u.__v!==i.__v&&(h.__d=!1),h.__v=u,u.__e=i.__e,u.__k=i.__k,u.__k.forEach(function(n){n&&(n.__=u)}),h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(g,h.__s,x),null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,_,k)})}if(h.context=x,h.props=g,h.__v=u,h.__P=n,A=l.__r,C=0,\"prototype\"in H&&H.prototype.render)h.state=h.__s,h.__d=!1,A&&A(u),a=h.render(h.props,h.state,h.context);else do{h.__d=!1,A&&A(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++C<25);h.state=h.__s,null!=h.getChildContext&&(t=s(s({},t),h.getChildContext())),v||null==h.getSnapshotBeforeUpdate||(k=h.getSnapshotBeforeUpdate(y,_)),$=null!=a&&a.type===p&&null==a.key?a.props.children:a,w(n,Array.isArray($)?$:[$],u,i,t,o,r,f,e,c),h.base=u.__e,u.__h=null,h.__h.length&&f.push(h),b&&(h.__E=h.__=null),h.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=L(i.__e,u,i,t,o,r,f,c);(a=l.diffed)&&a(u)}catch(n){u.__v=null,(c||null!=r)&&(u.__e=e,u.__h=!!c,r[r.indexOf(e)]=null),l.__e(n,u,i)}}function z(n,u){l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function L(l,u,i,t,o,r,e,c){var s,h,v,y=i.props,p=u.props,d=u.type,k=0;if(\"svg\"===d&&(o=!0),null!=r)for(;k<r.length;k++)if((s=r[k])&&\"setAttribute\"in s==!!d&&(d?s.localName===d:3===s.nodeType)){l=s,r[k]=null;break}if(null==l){if(null===d)return document.createTextNode(p);l=o?document.createElementNS(\"http://www.w3.org/2000/svg\",d):document.createElement(d,p.is&&p),r=null,c=!1}if(null===d)y===p||c&&l.data===p||(l.data=p);else{if(r=r&&n.call(l.childNodes),h=(y=i.props||f).dangerouslySetInnerHTML,v=p.dangerouslySetInnerHTML,!c){if(null!=r)for(y={},k=0;k<l.attributes.length;k++)y[l.attributes[k].name]=l.attributes[k].value;(v||h)&&(v&&(h&&v.__html==h.__html||v.__html===l.innerHTML)||(l.innerHTML=v&&v.__html||\"\"))}if(C(l,p,y,o,c),v)u.__k=[];else if(k=u.props.children,w(l,Array.isArray(k)?k:[k],u,i,t,o&&\"foreignObject\"!==d,r,e,r?r[0]:i.__k&&_(i,0),c),null!=r)for(k=r.length;k--;)null!=r[k]&&a(r[k]);c||(\"value\"in p&&void 0!==(k=p.value)&&(k!==l.value||\"progress\"===d&&!k||\"option\"===d&&k!==y.value)&&H(l,\"value\",k,y.value,!1),\"checked\"in p&&void 0!==(k=p.checked)&&k!==l.checked&&H(l,\"checked\",k,y.checked,!1))}return l}function M(n,u,i){try{\"function\"==typeof n?n(u):n.current=u}catch(n){l.__e(n,i)}}function N(n,u,i){var t,o;if(l.unmount&&l.unmount(n),(t=n.ref)&&(t.current&&t.current!==n.__e||M(t,null,u)),null!=(t=n.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(n){l.__e(n,u)}t.base=t.__P=null}if(t=n.__k)for(o=0;o<t.length;o++)t[o]&&N(t[o],u,\"function\"!=typeof n.type);i||null==n.__e||a(n.__e),n.__e=n.__d=void 0}function O(n,l,u){return this.constructor(n,u)}function P(u,i,t){var o,r,e;l.__&&l.__(u,i),r=(o=\"function\"==typeof t)?null:t&&t.__k||i.__k,e=[],j(i,u=(!o&&t||i).__k=h(p,null,[u]),r||f,f,void 0!==i.ownerSVGElement,!o&&t?[t]:r?null:i.firstChild?n.call(i.childNodes):null,e,!o&&t?t:r?r.__e:i.firstChild,o),z(e,u)}function S(n,l){P(n,l,S)}function q(l,u,i){var t,o,r,f=s({},l.props);for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),v(l.type,f,t||l.key,o||l.ref,null)}function B(n,l){var u={__c:l=\"__cC\"+r++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var u,i;return this.getChildContext||(u=[],(i={})[l]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(b)},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n=e.slice,l={__e:function(n,l,u,i){for(var t,o,r;l=l.__;)if((t=l.__c)&&!t.__)try{if((o=t.constructor)&&null!=o.getDerivedStateFromError&&(t.setState(o.getDerivedStateFromError(n)),r=t.__d),null!=t.componentDidCatch&&(t.componentDidCatch(n,i||{}),r=t.__d),r)return t.__E=t}catch(l){n=l}throw n}},u=0,i=function(n){return null!=n&&void 0===n.constructor},d.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=s({},this.state),\"function\"==typeof n&&(n=n(s({},u),this.props)),n&&s(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),b(this))},d.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),b(this))},d.prototype.render=p,t=[],g.__r=0,r=0;export{P as render,S as hydrate,h as createElement,h,p as Fragment,y as createRef,i as isValidElement,d as Component,q as cloneElement,B as createContext,x as toChildArray,l as options};\n//# sourceMappingURL=preact.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,c=[],f=[],e=n.__b,a=n.__r,v=n.diffed,l=n.__c,m=n.unmount;function d(t,u){n.__h&&n.__h(r,t,o||u),o=0;var i=r.__H||(r.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({__V:f}),i.__[t]}function p(n){return o=1,y(z,n)}function y(n,u,i){var o=d(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):z(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.u)){r.u=!0;var c=r.shouldComponentUpdate;r.shouldComponentUpdate=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=!1;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),!!i&&(!c||c.call(this,n,t,r))}}return o.__N||o.__}function h(u,i){var o=d(t++,3);!n.__s&&w(o.__H,i)&&(o.__=u,o.i=i,r.__H.__h.push(o))}function s(u,i){var o=d(t++,4);!n.__s&&w(o.__H,i)&&(o.__=u,o.i=i,r.__h.push(o))}function _(n){return o=5,F(function(){return{current:n}},[])}function A(n,t,r){o=6,s(function(){return\"function\"==typeof n?(n(t()),function(){return n(null)}):n?(n.current=t(),function(){return n.current=null}):void 0},null==r?r:r.concat(n))}function F(n,r){var u=d(t++,7);return w(u.__H,r)?(u.__V=n(),u.i=r,u.__h=n,u.__V):u.__}function T(n,t){return o=8,F(function(){return n},t)}function q(n){var u=r.context[n.__c],i=d(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function x(t,r){n.useDebugValue&&n.useDebugValue(r?r(t):t)}function V(n){var u=d(t++,10),i=p();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n){u.__&&u.__(n),i[1](n)}),[i[0],function(){i[1](void 0)}]}function b(){for(var t;t=c.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(j),t.__H.__h.forEach(k),t.__H.__h=[]}catch(r){t.__H.__h=[],n.__e(r,t.__v)}}n.__b=function(n){r=null,e&&e(n)},n.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=f,n.__N=n.i=void 0})):(i.__h.forEach(j),i.__h.forEach(k),i.__h=[])),u=r},n.diffed=function(t){v&&v(t);var o=t.__c;o&&o.__H&&(o.__H.__h.length&&(1!==c.push(o)&&i===n.requestAnimationFrame||((i=n.requestAnimationFrame)||function(n){var t,r=function(){clearTimeout(u),g&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);g&&(t=requestAnimationFrame(r))})(b)),o.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==f&&(n.__=n.__V),n.i=void 0,n.__V=f})),u=r=null},n.__c=function(t,r){r.some(function(t){try{t.__h.forEach(j),t.__h=t.__h.filter(function(n){return!n.__||k(n)})}catch(u){r.some(function(n){n.__h&&(n.__h=[])}),r=[],n.__e(u,t.__v)}}),l&&l(t,r)},n.unmount=function(t){m&&m(t);var r,u=t.__c;u&&u.__H&&(u.__H.__.forEach(function(n){try{j(n)}catch(n){r=n}}),r&&n.__e(r,u.__v))};var g=\"function\"==typeof requestAnimationFrame;function j(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function k(n){var t=r;n.__c=n.__(),r=t}function w(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function z(n,t){return\"function\"==typeof t?t(n):t}export{p as useState,y as useReducer,h as useEffect,s as useLayoutEffect,_ as useRef,A as useImperativeHandle,F as useMemo,T as useCallback,q as useContext,x as useDebugValue,V as useErrorBoundary};\n//# sourceMappingURL=hooks.module.js.map\n","//@ts-check\n/// <reference path=\"types.js\" />\nimport { assertNonNull, assert, until, sleep } from './utils.js';\nimport { createParser } from './parser.js';\nimport { load, parseKey, injectStyle } from './script-loader';\nimport * as preact from 'preact';\nimport { useMemo, useCallback, useState, useEffect} from 'preact/hooks';\n\n/** @typedef {(props:Object)=>Elem} Component */\n\n\nexport const createPreactParser = ()=>{\n  const parser = createParser();\n  parser.settings.FragmentComponent = preact.Fragment;\n  parser.settings.createElement = (type, props, ...children)=> {\n    if (props && props.hasOwnProperty('(component)')) {\n      let pluginKey = props['(component)'];\n      type = plugin(pluginKey);\n      // if (pluginKey) type = plugin(pluginKey);\n      // else console.warn('caph tag without plugin attribute');\n    }\n    const vDom = preact.createElement(type, props, ...children);\n    return vDom;\n  }\n  return parser;\n}\n\nexport const parser = createPreactParser();\n\n/** @type {{[key:string]: Component|Promise<Component>}} */\nexport const pluginDefs = {}\n\n\n/** @type {{[key:string]: Component}} */\nconst _pluginComponents = {}\nexport const plugin = (/** @type {string} */ key)=>{ // key is either a tag or a url\n  const cache = _pluginComponents;\n  return cache[key] || (cache[key] = componentWrapper(key));\n}\n\n/** @type {{[key:string]: Component}} */\nconst _componentWrappers = {};\nconst componentWrapper = (/** @type {string} */ key)=>{\n  const cache = _componentWrappers;\n  return cache[key] || (cache[key] = newPluginLoader(key));\n}\n\n/** @returns {Component} */\nconst newPluginLoader = (/** @type {string}*/ key)=>{\n  //scriptLoader.load('caph-docs/core/plugin-loader.css');\n\n  const loadStatus = {\n    Component: /** @type {null|Component}*/(null),\n    error: null,\n    renderReady: false,\n  }\n\n  function FinalComponent({ children, ...props }) {\n    try {\n      const Component = assertNonNull(loadStatus.Component);\n      const out = Component({ children, ...props });\n      assert(!out.then, `Your component can not be a promise itself (${key}).\n      Maybe you defined pluginDefs[...] = (async ()=>{...}) instead of pluginDefs[...] = (async ()=>{...})()?\n      Please follow the IIFE pattern for async promises.`);\n      return out;\n    } catch (err) {\n      console.error(`Rendering error in plugin ${key}:`, err);\n      return parser.parse`<code class=\"caph-flashing\">${children || '...error...'}</code>`;\n    }\n  }\n\n  function LoadingComponent({ children }) {\n    return parser.parse`\n    <code class=\"caph-flashing\" title=${`${key} is loading...`}>${children || '...'}</code>`;\n  }\n\n  function LoadErrorComponent({}) {\n    return parser.parse`<${plugin('core-error')} tooltip=${loadStatus.error}/>`;\n  }\n\n  const {url, proxyKey} = parseKey(key);\n  const main = async ()=>{\n    // 1. Put the plugin script in the document head and wait for the browser to load the script\n    try{\n      if (pluginDefs.hasOwnProperty(key)){} // already loaded\n      else if (proxyKey) {\n        pluginDefs[key] = componentWrapper(proxyKey);\n      } else if(url) {\n        load(url);\n        await until(() => pluginDefs[url], { timeout: 3800});\n        // assert(pluginDefs[url], `Plugin ${key} not declared in file ${url}`);\n        pluginDefs[key] = pluginDefs[url];\n        if (key != url) delete pluginDefs[url];\n      } else {\n        await until(() => pluginDefs[key], {timeout: 3800});\n      } // User plugin\n    } catch(err){\n      loadStatus.error = err || true;\n      console.error(`Could not load plugin ${key}`, err);\n      return;\n    }\n    // 3. Start the plugin promise but don't wait for it\n    (async()=>{\n      try {\n        loadStatus.Component = await pluginDefs[key];\n        loadStatus.renderReady = true;\n      } catch (err) {\n        loadStatus.error = err || true;\n        console.log(pluginDefs[key])\n        console.error(`Error while awaiting pluginDefs[\"${key}\"]`, err);\n      }\n    })();\n  }\n  main();\n  return ({ children, ...props })=>{\n    const [trigger, setTrigger] = useState(0);\n\n    const asyncLoad = useCallback(async () => {\n      await until(() => loadStatus.renderReady || loadStatus.error);\n      setTrigger(Math.random() * 1e12); // refresh this component\n    }, []);\n    useEffect(()=>{asyncLoad()}, []);\n    \n    const Component = useMemo(()=>{\n      if (loadStatus.renderReady) return FinalComponent;\n      else if (loadStatus.error) return LoadErrorComponent;\n      else return LoadingComponent;\n    }, [trigger]);\n    \n    return Component({ children, ...props })\n  };\n}\n\n\n\n\npluginDefs['core-error'] = (async () => ({ children, tooltip }) => {\n  const help = useCallback(() => {\n    const win = window.open('', '_blank');\n    if (!win) throw new Error('Popup blocked');\n    win.document.write(`\n      <div>\n        1. In tex, use \\\\lt and \\\\gt instead of &lt; and &gt;.\n        <br/>\n        2. In html, use \\\\$ instead of $.\n        <br/>\n        This prevents any parsing misunderstanding.\n      </div>\n    `);\n  }, []);\n  return parser.parse`\n    <a href=\"./error-help\" onclick=${(e) => {\n    e.preventDefault();\n      help();\n    }}>(help?)</a> \n    <code class=\"caph-flashing caph-error\" title=${tooltip}>${children || tooltip || 'Error'}</code>\n  `;\n})();\n\n// pluginDefs['@paragraphs'] = (async () =>({ children }) => useMemo(\n//     ()=>this._evalAst([null, null, parser.spacingRulesParagraphs(preact.toChildArray(children))]),\n//     [children],\n// ))();\n\n// pluginDefs['code'] = (async () => ({ children, progLang }) => useMemo(\n//   ()=>parser..parse`<code>${children}</code>`,\n//   [children],\n// ))(),\n\n\nparser.settings.customRules = [\n  {\n    regStart: `(?<!\\\\\\\\)\\\\$`,\n    regEnd: `(?<!\\\\\\\\)\\\\$`,\n    parser: ((text)=> parser.parse`<div (component)=${'@katex'}>${text}</>`),\n  },\n]\n\nconst reg = /(?<!\\\\)\\\\$(.*?)(?<!\\\\)\\\\$/;\n\n\ninjectStyle(`\n.caph-error{\n  color: #ce1111;\n}\n.caph-flashing{\n  -webkit-animation: caphFlashingAnimation 1s linear infinite;\n  animation: caphFlashingAnimation 1s linear infinite;\n}\n@keyframes caphFlashingAnimation {\n  0% { opacity: 0.3; }\n  100% { opacity: 1; }\n}\n\n.caph-hidden{\n  display: none;\n}\n\n.caph-box-shadow{\n  box-shadow: 0px 0px 0.3rem 0.05rem var(--box-shadow);\n}\n.caph-box-shadow:hover{\n  box-shadow: 0px 0px 0.3rem 0.2rem var(--box-shadow);\n}\n.caph-fullscreen-layer{\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 100;\n}\n.caph-hbox{ display: flex; }\n.caph-vbox{ display: flex; flex-direction: column; }\n.caph-boxcenter{ justify-content: center; }\n.caph-space-around{ justify-content: space-around; }\n.caph-space-between{ justify-content: space-between; }\n.caph-flex{ flex: 1; }\n.caph-hidden{ display:none; }\n.caph-plugin-hidden{ display:none; }\n.caph-border{\n  border: solid 2px var(--text-strong);\n}`)\n","//@ts-check\nimport { MyPromise } from \"./utils\";\nimport { parser, plugin } from \"./preact-parser\";\nimport { createContext, render } from \"preact\";\nimport {useMemo, useCallback, useState, useEffect} from 'preact/hooks';\n\nexport const contexts = {};\ncontexts['core-menu'] = createContext(null);\n\nexport const _globals = {};\nexport function dispatchGlobal(eventName, value) {\n  //console.log('Dispatch', eventName, value);\n  _globals[eventName] = value;\n  let event = new CustomEvent(eventName, {detail:value});\n  window.dispatchEvent(event);\n  return;\n}\nexport async function untilGlobal(eventName) {\n  await MyPromise.until(() => _globals[eventName]);\n  await MyPromise.sleep(500);\n}\nexport function listenToGlobal(eventName) {\n  const initial = useMemo(()=>_globals[eventName], [eventName]);\n  const [value, setValue] = useState(initial);\n  listenToEvent(eventName, setValue);\n  return value;\n}\n\nexport const menu = new class {\n  constructor() {\n    this.addOption('Default', { hold: true });\n    this.latest = this.option = 'Default';\n  }\n  options = [];\n  onEnter = {};\n  onExit = {};\n  hold = {};\n\n  /**\n   * @param {string} option\n   * @param {{onEnter?:()=>void, onExit?:()=>void, hold?:boolean}} options\n  */\n  addOption(option, { onEnter, onExit, hold } = {}) {\n    this.onEnter[option] = onEnter;\n    this.onExit[option] = onExit;\n    this.hold[option] = hold;\n    if (this.options[option]) return;\n    this.options.push(option);\n    this.options[option] = 1;\n    dispatchGlobal('caph-menu-options', Math.random());\n  }\n  setOption(option) {\n    dispatchGlobal('caph-menu-option', Math.random());\n    if (this.hold[option]) {\n      this.onExit[this.latest] && this.onExit[this.latest]();\n      this.latest = this.option;\n      this.option = option;\n    }\n    this.onEnter[option] && this.onEnter[option]();\n  }\n};\n\nexport async function inject(vDom) {\n  // const node = MyDocument.createElement('div', {\n  //   parent: document.body,\n  //   where: 'afterbegin',\n  //   id: 'core-body',\n  // })\n  const node = document.body;\n  render(vDom, node);\n}\n\nMyPromise.until(() => document.body).then(()=>{\n  inject(parser.parse`\n    <${plugin('@core-menu')}/>\n    <${plugin('@core-about')}/>\n  `);\n});\n\n/**\n * @param {string} eventName \n * @param {(data:any)=>void} callback \n */\nexport function listenToEvent(eventName, callback) {\n  useEffect(() => {\n    const actualCallback = (/** @type {Event|CustomEvent}*/ e) => {\n      //@ts-ignore: event.detail is not defined for non-custom events\n      try{callback(e.detail);}\n      catch(err){}\n    }\n    window.addEventListener(eventName, actualCallback);\n    return () => {\n      window.removeEventListener(eventName, actualCallback);\n    }\n  }, [eventName, callback]);\n}\n\n","//@ts-check\nimport { MyPromise, sleep, assert, Queue, assertNonNull } from \"./utils\";\nimport { createParser as createAstParser } from \"./parser\";\nimport { parser, pluginDefs, plugin, createPreactParser } from \"./preact-parser\";\nimport { contexts, menu, listenToEvent, listenToGlobal } from \"./preact-globals\";\nimport { toChildArray } from \"preact\";\nimport { useMemo, useState } from \"preact/hooks\";\nimport { load, injectStyle } from \"./script-loader\";\nimport * as scriptLoader from \"./script-loader\";\nimport * as preactBase from \"preact\";\nimport * as preactHooks from \"preact/hooks\";\nimport { compressor, decompress } from \"./build-constants\";\n/** @typedef {import(\"./preact-parser\").Component} Component */ \n\n\nexport const preact = {...preactBase, ...preactHooks};\nwindow[\"preact\"] = preact;\n\nexport const libraries = {};\nlibraries.preact = preact;\n(async()=>{ libraries.lzutf8=await MyPromise.until(()=>window['LZUTF8']); })();\n\nexport { scriptLoader, load, injectStyle, createAstParser };\nexport {parser, pluginDefs, plugin, createPreactParser};\nexport const {parse, parseAst, parseAstHtml, parseHtml} = parser;\n\nconst noRulesParser = createPreactParser();\nnoRulesParser.settings.customRules = [];\nexport const {parse: parseNoMarkup} = noRulesParser;\n\n\nexport const parseElem = (/** @type {HTMLElement}*/elem, /** @type {('clear'|'hide'|'remove')?}*/action) => {\n  const html = elem.innerHTML;\n  if(!action){} // Do nothing\n  else if(action=='clear') elem.innerHTML = '';\n  else if(action=='remove') elem.remove();\n  else if (action=='hide') elem.classList.add('caph-hidden');\n  return parseHtml(html);\n}\n\nexport const until = MyPromise.until;\nexport {assert, sleep};\nexport const collections = { Queue };\nexport {contexts, menu, listenToEvent, listenToGlobal};\n\n\n/** @param {Component | Promise<Component>} definition */ \nexport const defineFileComponent = (definition)=>{\n  const elem = assertNonNull(document?.currentScript);\n  /** @type {string}*/\n  const src = elem.getAttribute('data-original-src')||elem['src'];\n  pluginDefs[src] = definition;\n}\n\n/** @param {string} dist @param {string} compressedSequence */ \nexport const injectCompressedScript = async (dist, compressedSequence)=>{\n  /* Used in all compressed plugins. See build-plugins.js */  \n  await load(compressor.dist);\n  await until(()=>window['LZUTF8']);\n  const jsCode = decompress(window[\"LZUTF8\"], compressedSequence);\n  const e = document.createElement('script');\n  const {url} = scriptLoader.parseKey(dist);\n  e.setAttribute('data-original-src', url);\n  e.innerHTML = jsCode;\n  document.getElementById('core-sources')?.insertAdjacentElement('beforeend', e);\n}\n\n\n\nexport const settings = {\n  get mathParser(){ return parser.mathParser; },\n  mathMacros: {},\n  set mathParser(/** @type {'@katex'|'@mathjax'} */value) {\n    parser.mathParser = value;\n  }\n};\n\ninjectStyle(`\ndiv.caph-paragraph + div.caph-paragraph { margin-top: 1em; }\n.caph-paragraph h1,h2,h3,h4,h5,h6,ul,ol{ margin:0; }\n`);\n\n// tab effects: https://alvarotrigo.com/blog/html-css-tabs/\ninjectStyle(`\n.tabs-header>label>input { display: none; }\n.tabs-parent { width: 100%; }\n.tabs-header {\n  margin-top: 0.1em;\n  border-bottom: 1px solid;\n}\n.tab-label:hover {\n  top: -0.25rem;\n  transition: top 0.25s;\n}\n.tabs{\n  border: solid 1px;\n  border-top: none;\n}\n.tab-label {\n  padding-left: 1em;\n  padding-right: 1em;\n  border-radius: 0.3em 0.3em 0 0;\n  background: unset;\n  border: solid 1px;\n  white-space:nowrap;\n}\n/* https://stackoverflow.com/a/10148189/3671939 */\n.tab-label { white-space:nowrap; }\n.tab-label > span{ white-space: normal; }\n\n.tab-label-true {\n  font-weight: bold;\n  border-bottom: solid 2px white;\n}\n.tab-content-false { display:none; }\n.tab-content-true {\n  display: true;\n  opacity: 1;\n\tanimation-name: fadeInOpacity;\n\tanimation-iteration-count: 1;\n\tanimation-timing-function: ease-in;\n\tanimation-duration: 0.15s;\n}\n@keyframes fadeInOpacity {\n\t0% { opacity: 0; }\n\t100% { opacity: 1;}\n}\n.tab-content-true { padding: 1vw; }\n`);\npluginDefs['@tabs'] = ({/** @type {string[]} */ labels, defaultLabel, children})=>{\n  const zipped = useMemo(()=>toChildArray(children).map(\n    (child,i) => ({label:labels[i]||`Tab ${i+1}`, child})\n  ), [labels, children]);\n  const [option, setOption] = useState(defaultLabel || zipped[0]?.label);\n  return parse`\n  <div class=\"tabs-parent\">\n    <div class=\"tabs-header\">\n      ${labels.map((label)=>parse`\n        <label class=\"tab-label\" class=${'tab-label-'+(option==label)}>\n          <input type=\"radio\" checked=${option==label} onClick=${()=>setOption(label)}/>\n          <span>${label}</>\n        </label>`\n      )}\n    </div>\n    <div class=\"tabs\">\n      ${zipped.map(({label, child})=>parse`\n        <div class=${'tab-content-'+(option==label)}>${child}</>`\n      )}\n    </div>\n  </>`;\n}\n","import * as caph from './main';\n\nexport default caph;"],"names":["htmlSafe","str","Option","innerHTML","htmlSafeUndo","l","content","match","DOMParser","parseFromString","documentElement","textContent","AstParser","ESC","SPEC","DEBUG","static","raw","strings","values","this","root","warn","args","console","error","constructor","customRules","debug","cls","join","escaped","regEscaped","RegExp","replace","index","pos","valueIndex","errorStop","log","optionalClose","bind","REG_EXP_TEXT","map","regStart","parent","parseRoot","evalTree","createElement","FragmentComponent","Array","isArray","tag","props","children","child","parseChildrenAndParentClose","name","length","parentTag","parentProps","childlessTags","br","area","base","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","_optionalClose","run","regExp","lastIndex","exec","throw","tryRun","e","tryRunUndo","debugPosition","delta","at","Math","max","slice","text","push","value","startsWith","consumeComment","endReached","parsedRule","regEnd","parser","m","replaceText","result","_tag","newParent","grandParent","parseParent","pop","reg","undefined","admitsChildren","toLowerCase","spacing","key","_value","endsWith","eval","prevValue","includes","code","spacingRulesJsx","spacingRulesParagraphs","stack","filter","x","reverse","newChildren","split","forEach","i","_","middle","r","trimText","first","elems","reason","Error","regComment","posOfText","original","exampleCreateElement","type","exampleFragmentComponent","exampleCustomRules","displayMode","progLang","createParser","settings","parseAst","templateString","astUndoHtml","parseAstHtml","ast","parse","parseHtml","assertNonNull","isString","obj","Object","prototype","toString","call","assert","condition","messages","sleep","ms","Promise","ok","err","setTimeout","MyPromise","promises","any_error","cnt","outs","p","all","async","finish_all","func","timeout","t0","Date","getTime","Timeout","promise","finished","resp","then","until","MyDocument","style","id","classList","html","eventListeners","where","attrs","document","setAttribute","s","add","innerText","MyObject","addEventListener","body","insertAdjacentElement","element","focus","window","CustomEvent","dispatchEvent","createEvent","ev","initEvent","fireEvent","arr","M","_object_op","op","src","dest","keys","_func","dotted","v","k","indexOf","no_dots","start","end","reduce_dots","objs","o","deep_assign","deep_copy","default_obj","filter_func","Queue","data","lr","capacity","j","toArray","concat","Symbol","iterator","next","done","resize","newLength","fill","_mod_add","lrIndex","retK","afterK","mod","out","pushRight","pushLeft","popRight","popLeft","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","defineProperty","enumerable","get","prop","hasOwnProperty","toStringTag","compressed","distPlugins","dist","plugins","fromEntries","scriptLoader","querySelectorAll","div","getElementById","head","_randomSessionSuffix","random","parseKey","url","URL","baseURI","href","proxyKey","status","injectStyle","styleStr","load","ref","autoAttrs","refBase","ext","defaults","rel","_ok","_err","onload","onerror","_load_elem","n","u","t","f","c","a","parentNode","removeChild","h","arguments","defaultProps","__k","__","__b","__e","__d","__c","__h","__v","vnode","y","current","context","b","g","__r","debounceRendering","sort","some","__P","__n","ownerSVGElement","z","w","C","A","N","appendChild","nextSibling","insertBefore","$","setProperty","test","H","cssText","T","I","removeEventListener","removeAttribute","event","contextType","__E","render","O","sub","state","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","L","diffed","localName","nodeType","createTextNode","createElementNS","is","childNodes","dangerouslySetInnerHTML","attributes","__html","checked","unmount","componentWillUnmount","P","firstChild","S","q","B","Consumer","Provider","splice","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","__H","__V","__N","every","F","V","shift","clearTimeout","cancelAnimationFrame","requestAnimationFrame","createPreactParser","pluginKey","pluginDefs","_pluginComponents","cache","componentWrapper","_componentWrappers","newPluginLoader","loadStatus","Component","renderReady","FinalComponent","LoadingComponent","LoadErrorComponent","main","trigger","setTrigger","asyncLoad","tooltip","help","win","open","write","preventDefault","contexts","_globals","dispatchGlobal","eventName","detail","listenToGlobal","initial","setValue","listenToEvent","menu","addOption","hold","latest","option","options","onEnter","onExit","setOption","callback","actualCallback","vDom","inject","preact","libraries","lzutf8","noRulesParser","parseNoMarkup","parseElem","elem","action","remove","collections","defineFileComponent","currentScript","getAttribute","injectCompressedScript","compressedSequence","jsCode","compressor","decompress","inputEncoding","mathParser","mathMacros","labels","defaultLabel","zipped","label"],"sourceRoot":""}