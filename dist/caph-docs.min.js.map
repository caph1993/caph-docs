{"version":3,"file":"caph-docs.min.js","mappings":"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","sources":["webpack://caph/./src/parser.js","webpack://caph/./src/utils.js","webpack://caph/webpack/bootstrap","webpack://caph/webpack/runtime/define property getters","webpack://caph/webpack/runtime/hasOwnProperty shorthand","webpack://caph/webpack/runtime/make namespace object","webpack://caph/./src/collections.js","webpack://caph/./src/build-constants.js","webpack://caph/./src/script-loader.js","webpack://caph/./node_modules/.pnpm/preact@10.10.6/node_modules/preact/dist/preact.module.js","webpack://caph/./node_modules/.pnpm/preact@10.10.6/node_modules/preact/hooks/dist/hooks.module.js","webpack://caph/./src/preact-parser.js","webpack://caph/./src/preact-globals.js","webpack://caph/./src/main.js","webpack://caph/./src/index.js"],"sourcesContent":["//@ts-check\n/// <reference path=\"types.js\" />\nimport { isString, assert, assertNonNull } from \"./utils.js\";\n\n/** @typedef {({children, ...props})=>any} ComponentType*/\n/** @typedef {Object} AttributesType*/\n/** @typedef {string|ComponentType|null} TagType*/\n/**\n * @typedef {(type:any, props:any, ...children)=>(any extends Array? never: any)} CreateElementType\n*/\n// /** @typedef {(text:string) => AstNode} RuleParser*/\n// /** @typedef {{regStart:string, regEnd:string, parser:RuleParser}} CustomRule*/\n\n/** @typedef {{start:RegExp, capture:RegExp, component:string}} ParsingRule*/\n\n/**\n * @typedef {[null, null, AstNodeArray]|[string|ComponentType, AttributesType|null, AstNodeArray]} AstParent\n */\n/**\n * @typedef {string|AstParent} AstNode\n*/\n/** @typedef {AstNode[]} AstNodeArray*/\n\n/** @typedef {'jsx'|'tex'|'raw'|'pre'} SpacingType*/\n\n\n/**@param {string} str*/\nfunction htmlSafe(str) {\n  // e.g. converts < into &lt;\n  return new Option(str).innerHTML;\n}\n\nconst htmlSafeUndo = (/** @type {string} */ str)=>{\n  // e.g. converts &lt; into <, etc. Prevents left trim caused by DOMParser\n  const [, l, content] = assertNonNull(str.match(/^(\\s*)(.*)$/s));\n  const doc = new DOMParser().parseFromString(content, \"text/html\");\n  const text = l+(doc.documentElement.textContent || '');\n  // if(str!=text) console.log(`Converted ${str} into ${text}`)\n  return text;\n}\n\n\n//https://stackoverflow.com/a/70329711\n\nexport const AstParser = (class {\n\n  ESC = '\\ue000';\n  SPEC = `https://html.spec.whatwg.org/multipage/syntax.html`;\n  DEBUG = false;\n\n  str;\n  values;\n  pos;\n  parsingRules;\n\n\n  static parseAst(/** @type {TemplateStringsArray} */{raw:strings}, ...values){\n    const cls = this;\n    return new cls(strings, values).root\n  }\n\n  warn(...args){console.warn(...args)}; // Overriden during tests\n  error(...args){console.error(...args)}; // Overriden during tests\n\n  /**\n   * @param {readonly string[]} strings\n   * @param {readonly any[]} values\n   * @param {readonly ParsingRule[]} parsingRules\n   * @param {0|1|2} debug\n  */\n  constructor(strings, values, parsingRules=[], debug=0){\n    /** @type {typeof AstParser} */ //@ts-ignore\n    this.cls = this.constructor;\n    let str = strings.join(this.ESC);\n    let escaped = {};\n    let regEscaped = new RegExp(`${this.ESC}|\\\\\\\\\"|\\\\\\\\'`, 'g');\n    str = str.replace(regEscaped, (match, index)=>{\n      //console.log(`Escaping ${match} at ${index}`);\n      escaped[index] = match;\n      return this.ESC;\n    });\n    this.pos = 0;\n    this.str = str;\n    this.values = values;\n    this.valueIndex = 0;\n    this.escaped = escaped;\n    this.errorStop = false;\n    debug && console.log('PARSING', this.str);\n    this.DEBUG = debug==2;\n\n    //console.log(this.cls);\n    this.parsingRules = parsingRules;\n    /** @type {(tag:TagType)=>(null|string[])} */\n    this.optionalClose = this.cls.optionalClose.bind(this.cls);\n\n    this.REG_EXP_TEXT = new RegExp(`.*?(?=${[\n      '$', '<', this.ESC,\n      ...this.parsingRules.map(({start})=>start.source),\n    ].join('|')})`, 'ys');\n\n    /**@type {AstParent} */\n    this.parent = [null, null, []];\n    /**@type {AstNode} */\n    this.root = this.parent;\n    this.parseRoot();\n\n    /**@param {CreateElementType} createElement @param {ComponentType} FragmentComponent*/\n    this.evalTree = (createElement, FragmentComponent)=>{\n      const evalTree = (/** @type {AstNode}*/ root) => {\n        if (!Array.isArray(root)) return root;\n        let [tag, props, children] = root;\n        if(tag=='@injected') return root[2][0];\n        assert(Array.isArray(children));\n        children = children.map(child =>evalTree(child));\n        if(tag==null){\n          assert(props==null);\n          tag = FragmentComponent;\n        }\n        return createElement(tag, props, ...children);\n      }\n      return evalTree(this.root);\n    }\n    \n  }\n  \n  parseRoot(){\n    try{\n      this.parseChildrenAndParentClose();\n      \n      assert(this.parent===this.root);\n    } catch (error){\n      console.log(error);\n      if(error.name !== 'caph-parser-error') throw error;\n      if(this.pos==this.str.length && this.parent===this.root){\n        // Pass. Safe error: expected </> at end because we simulate a fragment root\n      } else{ this.error(error)}\n    }\n    if(this.parent===this.root && this.root[2].length == 1) this.root = this.root[2][0];\n  }\n\n  get parentTag(){ return this.parent[0]; }\n  get parentProps(){ return this.parent[1]; }\n  get children(){ return this.parent[2]; }\n\n  childlessTags = {\n    br: true, '!doctype': true, area: true, base: true, col: true, command: true, embed: true, hr: true,img: true, input: true, keygen: true, link: true, meta: true, param: true, source: true, track: true, wbr: true\n  };\n\n  // spacePreservingTags = {\n  //   pre: true, span: true, code: true, p: true, b: true, i: true,\n  //   a: true, li: true,\n  // };\n\n  // https://html.spec.whatwg.org/multipage/syntax.html#optional-tags\n  /** @type {{[key:string]:string[]}}*/\n  static _optionalClose = {\n    'li': ['li'],\n    'dt': ['dt', 'dd'],\n    'dd': ['dd', 'dt'],\n    'p': ['p', 'address', 'article', 'aside', 'blockquote', 'details', 'div', 'dl', 'fieldset', 'figcaption', 'figure', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'header', 'hgroup', 'hr', 'main', 'menu', 'nav', 'ol', 'pre', 'section', 'table'],\n    'rt': ['rt', 'rp'],\n    'rp': ['rp', 'rt'],\n    'optgroup': ['optgroup'],\n    'option': ['option', 'optgroup'],\n    //'caption': [], // Disabled rule\n    //'colgroup': [], // Disabled rule\n    'thead': ['tbody','tfoot'],\n    'tbody': ['tbody', 'tfoot'],\n    'tfoot': [],\n    'tr': ['tr'],\n    'td': ['td', 'th'],\n    'th': ['th', 'td'],\n  };\n\n  static optionalClose(/** @type {TagType}*/ tag){\n    if(!tag || !isString(tag)) return null;\n    return this._optionalClose[tag];\n  }\n\n  run(/** @type {RegExp}*/regExp){\n    // Execute the regular expression on str at pos, and move forward\n    const {pos, str} = this;\n    regExp.lastIndex = pos;\n    const match = regExp.exec(str);\n    if(!match) this.throw(`No match for ${regExp}`);\n    if(match.index<pos) throw `Regexp must use 'ys' flag. Match for at ${match.index} is before previous match at ${pos}`;\n    this.pos += match[0].length;\n    return match;\n  }\n\n  tryRun(/** @type {RegExp}*/regExp){\n    try{ return this.run(regExp); }\n    catch(e){ return null; }\n  }\n  tryRunUndo(/** @type {RegExp}*/regExp){\n    const pos = this.pos;\n    try{ return this.run(regExp); }\n    catch(e){ return null; }\n    finally{ this.pos = pos; }\n  }\n\n  debugPosition(delta=0, length=50){ // Just for printing debug info\n    const {pos, str} = this;\n    const at = Math.max(0, pos+delta);\n    const short = str.slice(at, at+length).replace('\\n', '(\\\\n)');\n    return `${at}...${short}...${at+length}`;\n  }\n\n  /** @param {SpacingType|null} spacing*/\n  parseChildrenAndParentClose(spacing=null){\n    /*\n      Parses the children of a parent tag or fragment.\n      Called (i) from the root level,\n      or (ii) after a parent \"head\" (`<div ...>`) has been consumed,\n      or (iii) after a sibling has been consumed entirely.\n     */\n    while(true){ // capture children until parent close tag is found or end is reached\n      this.DEBUG && console.log('parseSibling', this.parent, this.debugPosition());\n      // Parse text preceeding the first sibling\n      let [text] = this.run(this.REG_EXP_TEXT);\n      if(text.length) this.children.push(text);\n  \n      if(this.tryRun(new RegExp(`${this.ESC}`, 'ys'))){\n        let value = this.values[this.valueIndex++];\n        for(value of Array.isArray(value)?value:[value]){\n          if(value||value===0) this.children.push(['@injected', null, [value]]);\n        }\n        continue;\n      }\n\n      // Comment, DOCTYPE, or CDATA\n      if(this.str.startsWith('<!', this.pos)){\n        this.consumeComment();\n        continue;\n      }\n\n      let endReached = this.pos==this.str.length;\n      if(endReached && this.parentTag && !this.optionalClose(this.parentTag))\n          this.throw(`Expected closing tag </${this.parentTag}> or </>`);\n      if(endReached) break;\n      \n      if(this.parsingRules.length){\n        const parsedRule = (/**@returns {AstNode?} */()=>{\n          for(let {start, capture, component} of this.parsingRules){\n            if(!this.tryRun(start)) continue;\n            const textStart = this.pos;\n            let [_, text] = this.run(capture);\n            text = this.replaceText(text, textStart);\n            return ['div', {'(component)': component}, [text]];\n          }\n          return null;\n        })();\n        if(parsedRule){\n          this.children.push(parsedRule);\n          continue;\n        }\n      }\n\n      // Parent close\n      let /** @type {TagType} */ tag;\n      if(this.tryRun(/<\\/\\s*>/ys)) break;\n      if(this.tryRun(/<\\//ys)){\n        let result = this.tryRun(new RegExp(`([^>\\\\s]+)\\\\s*>`, 'ys'));\n        if(!result) this.throw(`Expected close tag for parent ${this.parentTag||'fragment'}`);\n        let _tag = result[1];\n        if (_tag==this.ESC) tag = this.values[this.valueIndex++];\n        else tag = _tag;\n        if(tag!==this.parentTag) this.throw(`Unmatched close tag ${tag}!=${this.parentTag}`);\n        break;\n      }\n\n      const optionalClose = this.optionalClose(this.parentTag);\n      if(optionalClose){\n        if((()=>{\n          for(let tag of optionalClose){\n            if(this.tryRunUndo(new RegExp(`<${tag}(>|\\\\s)`, 'ys'),)){\n              return true;\n            }\n          }\n        })()) break;\n      }\n\n      const /** @type {AstParent} */ newParent = [null, null, []];\n      this.children.push(newParent);\n\n      const grandParent = this.parent;\n      this.parent = newParent; // change parent temporarily\n      this.parseParent(grandParent); // this restores parent\n      \n      if(newParent[0] == null){ // shortcut fragment nieces as siblings\n        assert(this.children.pop() === newParent);\n        this.children.push(...newParent[2]);\n      }\n    }\n\n    if(!spacing||spacing=='jsx') this.parent[2] = this.cls.spacingRulesJsx(this.children);\n    else if(spacing=='tex') this.parent[2] = this.cls.spacingRulesParagraphs(this.children);\n  }\n\n  parseParent(grandParent){\n    /*\n      Parses an element from the \"head\" opening (`<div ...>`)\n      until the \"tail\" close  (`</div>` or `</>`). \n      Called just at the beginning of the head opening.\n    */\n    this.DEBUG && console.log('parseParent ', this.parent, this.debugPosition());\n\n    let reg = new RegExp(`<([^\\\\s>\\\\/\\\\.]*)`, 'ys');\n    let _tag = this.run(reg)[1];\n    let /** @type {TagType} */ tag;\n    if (_tag==this.ESC){\n      tag = this.values[this.valueIndex++];\n      if(isString(tag)) this.throw(`Tag must be a component, not a string.`);\n    }\n    else if(!_tag.length) tag = null; //null means fragment\n    else if(_tag.match(/[^a-z0-9._-]/i)) this.throw(`Error with tag ${_tag}`);\n    else tag = _tag;\n    if (tag === undefined) this.throw(`Undefined component`);\n    \n    this.parent[0] = tag;\n    let admitsChildren = !this.childlessTags[(''+tag)?.toLowerCase()];\n    let /** @type {SpacingType|null}*/ spacing=null;\n    \n    while(true){ // While attributes\n\n      this.run(/\\s*/ys); // Consume whitespace after `<div` or after attribute value\n      const endReached = this.pos==this.str.length;\n      if(endReached) this.throw(`Expected closing end ...> or .../> for tag ${tag}`);\n      \n      // Handle head close\n      if(this.tryRun(/\\/>/ys)){ admitsChildren = false; break; }\n      else if(this.tryRun(/>/ys)) break;\n\n      // Read next attribute\n      if(!this.parentProps) this.parent[1] = {};\n      if(this.tryRun(new RegExp(`\\\\.\\\\.\\\\.${this.ESC}`, 'ys'))){\n        this.parent[1] = {...this.parentProps, ...this.values[this.valueIndex++]};\n      }\n      else{\n        let [key] = this.run(/.*?(?=\\s|>|=)/ys);\n        let _value = this.tryRun(/=/ys) && this.run(new RegExp(`\\\\\".*?\\\\\"|\\\\'.*?\\\\'|${this.ESC}`, 'ys'))[0];\n        let value;\n        // .innerHTML may transform `<div attr >` into `< attr=\"\" >`\n        if(!_value || _value==\"''\"||_value=='\"\"') value = true; \n        else if(_value==this.ESC) value = this.values[this.valueIndex++];\n        else value = this.replaceText(_value.slice(1,-1), this.pos-_value.length+1); // slice for quotes\n        if(key.endsWith('-eval')){\n          key = key.slice(0,-5);\n          value = eval(value);\n        }\n        const prevValue = this.parentProps[key];\n        if(key=='class') value = !prevValue?value:prevValue+' '+value;\n        else if(key=='style') value = !prevValue?value:prevValue+' '+value;\n        else if(prevValue!==undefined) this.warn(`Replacing attribute ${key}.\\nPrevious and new values:`, prevValue, value);\n        \n        if(key.startsWith('(')){\n          if(key=='(component)') {} // ?? temporary code\n          else if(key=='(spacing)'){\n            if(!['jsx', 'pre', 'tex', 'raw'].includes(value)) this.throw(`Invalid spacing mode: ${value}`);\n            spacing = value;\n            continue;\n          } else this.throw(`Invalid attribute: ${key}`);\n        }\n        this.parentProps[key] = value;\n      }\n    }\n\n    if(admitsChildren){\n      if(tag=='style'){ // Style is closed differently\n        let m = this.tryRun(/(.*?)<\\/style\\s*>/ys);\n        if(!m) this.throw(`Style tag not closed properly.`);\n        this.parent[2] = [m[1]];\n      }\n      else if(tag=='script'){ // Script is closed differently\n        let m = this.tryRun(/(.*?)<\\/script\\s*>/ys);\n        if(!m) this.throw(`Script tag not closed properly.`);\n        let code = m[1];\n        if(code.match(/^\\s*(String\\.raw)?\\`(.*)\\`\\s*$/ys)){\n          code = eval(code);\n          code = htmlSafe(code);\n          this.parent[0] = 'div';\n          this.parent[1] = {'(component)':'code', ...this.parentProps};\n          this.parent[2] = [code];\n        } else{\n          this.parent[2] = [code];\n        }\n      }\n      else{\n        if(!spacing){\n          if(!isString(tag)) spacing = 'jsx';\n          else if(tag=='pre' || tag=='textarea') spacing = 'pre';\n          else spacing = 'jsx';\n        }\n        this.parseChildrenAndParentClose(spacing); // (Huge step)\n        \n      }\n    }\n    this.parent = grandParent;\n  }\n\n  static spacingRulesJsx(children){ // JSX spacing\n    // https://reactjs.org/blog/2014/02/20/react-v0.9.html#jsx-whitespace\n    // https://www.w3.org/TR/REC-html40/struct/text.html#h-9.1\n    // https://stackoverflow.com/q/433493\n    /** @param {string} text*/\n    function trimText(text){\n      // End spaces are preserved only if they are inline\n      return text.replace(/^(\\s*)(.*?)(\\s*)$/s, (_, l, middle, r)=>{\n        if(l.includes('\\n')) l = '';\n        if(r.includes('\\n')) r = '';\n        return `${l}${middle}${r}`\n      });\n    }\n    const ESC = '\\ue000';\n    const stack = children.filter(x=>!isString(x)).reverse();\n    const text = children.map(x=>isString(x)?x:ESC).join('');\n    const newChildren = [];\n    text.split(ESC).forEach((str, i)=>{\n      if(i) newChildren.push(stack.pop());\n      if(str.length) str = trimText(str);\n      if(str.length) newChildren.push(str);\n    })\n    assert(stack.length==0);\n    return newChildren;\n  }\n\n  // https://html.spec.whatwg.org/multipage/syntax.html#element-restrictions\n  static spacingRulesPre(children){\n    const first = children[0];\n    if(isString(first) && first.startsWith('\\n'))\n      children[0] = children[0].slice(1);\n    return children;\n  }\n\n  static spacingRulesParagraphs(children){\n    const ESC = '\\ue000';\n    const stack = children.filter(x=>!isString(x)).reverse();\n    const text = children.map(x=>isString(x)?x:ESC).join('');\n    /** @type {AstNode[]}*/\n    const newChildren = text.split(/\\s*?\\n\\s*?\\n\\s*/s).map(text=>{\n      const elems = [];\n      text.split(ESC).forEach((str, i)=>{\n        if(i) elems.push(stack.pop());\n        if(str.length) elems.push(str);\n      })\n      return ['div', {'class':\"caph-paragraph\"}, elems];\n    });\n    assert(stack.length==0);\n    return newChildren;\n  }\n\n  /** @type {(reason:string)=>never}*/\n  throw(reason){\n    const error = new Error(`${reason}\n      Ignoring what follows.\n      Error occurred here:\n      ${this.debugPosition(-5)}\n    `);\n    error.name = 'caph-parser-error';\n    throw error;\n  }\n\n  consumeComment(){\n    const regComment = new RegExp(\n      [`<!--.*?-->`, `<!\\\\[CDATA\\\\[.*?\\\\]\\\\]>`, `<!DOCTYPE\\\\s*.*?>`,].join('|'),\n      'iys',\n    );\n    let result = this.tryRun(regComment);\n    if(!result) this.throw(`Unexpected <!`);\n    let [text] = result;\n    if(text.endsWith('/>')) this.warn(`Non compliant tag found.\\n${this.SPEC}`);\n    this.replaceText(text, this.pos-text.length); // Consume the fields inside, if any\n  }\n\n  /**\n   * @param {string} text\n   * @param {number} posOfText\n   * @returns {string}*/\n  replaceText(text, posOfText){\n    return text.replace(new RegExp(this.ESC, 'g'), (_, index)=>{\n      assert(this.str[posOfText+index] === this.ESC);\n      const original = this.escaped[posOfText+index];\n      if (original != this.ESC) return original;\n      return this.values[this.valueIndex++];\n    });\n  }\n  // asString(obj) {\n  //   let out = `${obj}`;\n  //   if (out == \"[object Object]\") {\n  //     // let seen = [];\n  //     // out = JSON.stringify(obj, function (key, val) {\n  //     //   if (val != null && typeof val == \"object\") {\n  //     //     if (seen.indexOf(val) >= 0) return;\n  //     //     seen.push(val);\n  //     //   }\n  //     //   return val; // https://stackoverflow.com/q/9382167\n  //     // });\n  //     out = obj; //PROBLEM\n  //   }\n  //   return out;\n  // }\n\n});\n\n\nconst exampleCreateElement = /**@type {CreateElementType} */ (type, props, ...children)=> (!type||isString(type))? {tag:type, props, children} : type({children, ...props});\n\nconst exampleFragmentComponent = /**@type {ComponentType} */  (({children})=>({tag:null, props:null, children}));\n\n\n/** @type {ParsingRule[]} */\nconst exampleParsingRules = [\n  {component: '@mathInline', start: /(?<!\\\\)\\$(?!\\$)/y, capture: /(.*?)(?<!\\\\)\\$/y, },\n  {component: '@mathDisplay', start: /(?<!\\\\)\\$\\$/y, capture: /(.*?)(?<!\\\\)\\$\\$/y, },\n  {component: '@codeInline', start: /(?<!\\\\)`(?!``)/y, capture: /(.*?)(?<!\\\\)`/y, },\n  {component: '@codeDisplay', start: /(?<!\\\\)```/y, capture: /(.*?)(?<!\\\\)```/y, },\n]\n\n// const exampleCustomRules = /** @type {CustomRule[]} */ [\n//   {\n//     regStart: `(?<!\\\\\\\\)\\\\$\\\\$`,\n//     regEnd: `(?<!\\\\\\\\)\\\\$\\\\$`,\n//     parser: /**@type {RuleParser}*/ ((text)=>['div', {'(component)': '@math', displayMode:true}, [text]]),\n//   },\n//   {\n//     regStart: `(?<!\\\\\\\\)\\\\$`,\n//     regEnd: `(?<!\\\\\\\\)\\\\$`,\n//     parser: /**@type {RuleParser}*/ ((text)=>['div', {'(component)': '@math', displayMode:false}, [text]]),\n//   },\n//   {\n//     regStart: `(?<!\\\\\\\\)\\`\\`\\``,\n//     regEnd: `(?<!\\\\\\\\)\\`\\`\\``,\n//     parser: /**@type {RuleParser}*/ ((text)=>{\n//       text = text.replace(/\\\\\\`\\`\\`/g, '```');\n//       let progLang = assertNonNull(text.match(/^[^\\n]*/));\n//       return ['div', {'(component)': '@code', ...(!progLang.length?{}:{progLang})}, [text]];\n//     }),\n//   },\n//   {\n//     regStart: `(?<!\\\\\\\\)\\``,\n//     regEnd: `(?<!\\\\\\\\)\\``,\n//     parser: /**@type {RuleParser}*/ ((text)=>{\n//       text = text.replace(/\\\\\\`/g, '`');\n//       return ['div', {'(component)': '@code'}, [text]]\n//     }),\n//   },\n// ];\n\n\n\nexport const createParser = ()=>{\n\n  const settings = {\n    createElement: exampleCreateElement,\n    FragmentComponent: exampleFragmentComponent,\n    parsingRules: exampleParsingRules,\n    debug: /** @type {0|1|2}*/(0),\n  }\n  \n  const parseAst = (/** @type {TemplateStringsArray} */ templateString, ...values)=> new AstParser(templateString.raw, values, settings.parsingRules, settings.debug);\n  \n  const parse = (/** @type {TemplateStringsArray} */ templateString, ...values)=> parseAst(templateString, ...values).evalTree(settings.createElement, settings.FragmentComponent);\n\n  const astUndoHtml = (/** @type {AstNode}*/ root) => {\n    if (isString(root)) return htmlSafeUndo(root);\n    if (!Array.isArray(root)) return root;\n    root[2] = root[2].map(child => astUndoHtml(child));\n    return root;\n  }\n  const parseAstHtml = (/** @type {string}*/str) => {\n    // Parse html, undoing html safe conversions, and then create element\n    let tmp = /** @type {TemplateStringsArray}*/(/**@type {any}*/({raw:[str]}));\n    let ast = parseAst(tmp);\n    ast.root = astUndoHtml(ast.root)\n    return ast;\n  }\n  const parseHtml = (/** @type {string}*/str) => parseAstHtml(str).evalTree(settings.createElement, settings.FragmentComponent);\n\n  return { settings, parse, parseAst, parseAstHtml, parseHtml, }\n}\n\n","//@ts-check\n\n/** https://github.com/Microsoft/TypeScript/issues/23405#issuecomment-873331031 */\n/** @template T  @param {T} value @param {string} [valueName] @returns {T extends undefined ? never : T} */\nexport function assertDefined(value, valueName) {\n  if (value === undefined) {\n    throw new Error(`Encountered unexpected undefined value${valueName? ` for '${valueName}'` : \"\"}`);\n  }\n  return /** @type {*} */ (value);\n}\n\n/** @template T @param {T} value @returns {T extends null ? never : T} */\nexport function assertNonNull(value) {\n  if (!value && (value===null||value === undefined)) throw new Error(`Encountered unexpected undefined value`);\n  return /** @type {*} */ (value);\n}\n\n/** @template T @param {T} value @returns {T extends null ? never : T} */\nexport function nonNull(value) { return /** @type {*} */ (value); }\n\n/** @type {(n: number) => number[]} */\nexport function range(n) {\n  return [...Array(n).fill(0)].map((x,i)=>i);\n}\n\n/** @type {(obj: any) => obj is String} */\nexport function isString(obj) {\n  return Object.prototype.toString.call(obj) === \"[object String]\";\n}\n\nexport function rand32(){\n  return Math.floor(Math.random()*(1<<32))\n}\n\n// utils = {\n//   unindent: (text) => {\n//     let lines = text.split('\\n');\n//     let n = lines.filter(l => l.trim().length)\n//       .map(l => l.length - l.trimStart().length)\n//       .reduce((p, c) => Math.min(c, p), 1000);\n//     return lines.map(l => l.slice(n)).join('\\n');\n//   }\n// };\n// _URL_resolve(url) {\n//   return new URL(url, document.baseURI).href;\n// }\n// // _URL_is_absolute(url) {\n// //   //https://stackoverflow.com/q/10687099\n// //   return new URL(document.baseURI).origin !== new URL(url, document.baseURI).origin;\n// // }\n\n// _html_safe(str) {\n//   // e.g. converts < into &lt;\n//   return new Option(str).innerHTML;\n// }\n// _html_safe_undo(str) {\n//   // e.g. converts &lt; into <\n//   const doc = new DOMParser().parseFromString(str, \"text/html\");\n//   const text = doc.documentElement.textContent;\n//   return text;\n// }\n\n\nexport function assert(/** @type {boolean|any}*/condition, ...messages) {\n  if (condition) return;\n  throw new Error(...messages);\n}\n\nexport function sleep(/** @type {number}*/ms) {\n  return new Promise((ok, err) => setTimeout(ok, ms));\n}\n\n/** @param {any} first @param {any} second  @param {any[]} more*/\nexport function assertEq(first, second, ...more) {\n  for(let other of [second, ...more]){\n    if (first==other) continue;\n    if (Array.isArray(first) && Array.isArray(other) && arrayEq(first, other)) continue;\n    throw new Error('Elements are different');\n  }\n}\n/** @param {any[]} first @param {any[]} second  @param {any[][]} more*/\nexport function arrayEq(first, second, ...more) {\n  for(let other of [second, ...more]){\n    if(first.length != other.length) return false;\n    for(let i=0;i<first.length;i++){\n      if(first[i]!=other[i]) return false;\n    }\n  }\n  return true;\n}\n\nclass MyBoolean {\n  static assert(condition, ...messages) {\n    if (condition) return;\n    throw new Error(...messages);\n  }\n  static all(arr) {\n    for (let x of arr) if (!x) return false;\n    return true;\n  }\n  static any(arr) {\n    for (let x of arr) if (x) return true;\n    return false;\n  }\n  static assert_all(arr, ...messages) { assert(this.all(arr), ...messages); }\n  static assert_any(arr, ...messages) { assert(this.any(arr), ...messages); }\n}\n\n\nclass MyArray {\n  static any(arr) {\n    for (let x of arr) if (x) return true;\n    return false;\n  }\n  static all(arr) {\n    for (let x of arr) if (!x) return false;\n    return true;\n  }\n  static sum(arr) {\n    return arr.reduce((p, c) => p + c, 0);\n  }\n  static max(arr, initialValue) {\n    initialValue = initialValue || 0;\n    return arr.reduce((p, c) => Math.max(p, c), initialValue);\n  }\n  static min(arr, initialValue) {\n    initialValue = initialValue || 1e10;\n    return arr.reduce((p, c) => Math.min(p, c), initialValue);\n  }\n  static zeros(n) {\n    const l = [];\n    for (let i = 0; i < n; i++)l.push(0);\n    return l;\n  }\n  static arange(n) {\n    return MyArray.zeros(n).map((z, i) => i);\n  }\n  static sEquality(a, b) {\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length !== b.length) return false;\n    for (let i = 0; i < a.length; ++i) if (a[i] != b[i]) return false;\n    return true;\n  }\n  static hEquality(a, b) {\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length !== b.length) return false;\n    for (let i = 0; i < a.length; ++i) if (a[i] !== b[i]) return false;\n    return true;\n  }\n}\n\nexport class MyPromise {\n  static async sleep(ms) {\n    await new Promise((ok, err) => setTimeout(ok, ms));\n  }\n  static async finish_all(promises, { debug = false } = {}) {\n    // Ensures completion of all promises even if some throw exceptions\n    return await new Promise((ok, err) => {\n      if (promises.length == 0) return ok([]);\n      let any_error = false;\n      let cnt = 0;\n      let outs = promises.map((p) => null);\n      Promise.all(promises.map(async (p, i) => {\n        try { outs[i] = await p; }\n        catch (e) {\n          any_error = true; outs[i] = e;\n          if (debug) console.error(...e);\n        }\n        cnt++;\n        if (cnt == promises.length) {\n          if (any_error) err(outs);\n          else ok(outs);\n        }\n      }));\n    });\n  }\n  static async finish_all_log(promises) {\n    try { var outs = await MyPromise.finish_all(promises); }\n    catch (err) {\n      var outs = err; console.error(...err);\n      err.forEach(e => console.warn(...e));\n    }\n    return outs;\n  }\n\n  static async until(/** @type {()=>any}*/ func, { ms = 200, timeout = 0 } = {}) {\n    if (timeout && ms > timeout) ms = timeout / 10;\n    let t0 = (new Date()).getTime();\n    let value;\n    while (!(value = await func())) {\n      if (timeout && (new Date()).getTime()-t0 > timeout)\n        throw MyPromise.Timeout;\n      await sleep(ms);\n    }\n    return value;\n  }\n  static Timeout = new Error('Timeout');\n  static async timeout(promise, ms) {\n    let finished = false;\n    let [resp, _] = await Promise.all([\n      promise.then(e => { finished = true; return e; }),\n      MyPromise.until(() => finished, { timeout: ms })\n    ]);\n    return resp;\n  }\n}\nexport const until=MyPromise.until;\n\n\nexport class MyDocument {\n\n  /**\n   * @param {string} tag \n   * @param {{\n   *  style?: {[key: string]: string},\n   *  id?: string,\n   * classList?: string[],\n   * text?: string,\n   * html?: string,\n   * eventListeners?: {[key: string]: (e: Event) => void},\n   * parent?: HTMLElement,\n   * where?: 'beforebegin' | 'afterbegin' | 'beforeend' | 'afterend',\n   * }} options\n   * @returns {HTMLElement}\n   */\n  static createElement(tag, {\n    style = {}, id, classList = [], text, html,\n    eventListeners = {}, parent, where, ...attrs } = {}) {\n    let e = document.createElement(tag);\n    if(id!==undefined) e.setAttribute(\"id\", id);\n    classList.forEach(s => e.classList.add(s));\n    if (text !==undefined) e.innerText = text;\n    if (html !==undefined) e.innerHTML = html;\n    if (id !==undefined) e.id = id;\n    MyObject.forEach(attrs, (value, key) => e.setAttribute(key, value));\n    MyObject.forEach(style, (value, key) => e.style[key] = value);\n    MyObject.forEach(eventListeners, (value, key) =>\n      e.addEventListener(key, value));\n    if (parent || where) {\n      parent = parent || document.body;\n      where = where || 'beforeend';\n      parent.insertAdjacentElement(where, e);\n    }\n    return e;\n  }\n  static right_click(element) {\n    element.focus();\n    if (window.CustomEvent) {\n      element.dispatchEvent(new CustomEvent('contextmenu'));\n    } else if (document.createEvent) {\n      var ev = document.createEvent('HTMLEvents');\n      ev.initEvent('contextmenu', true, false);\n      element.dispatchEvent(ev);\n    } else { // Internet Explorer\n      element.fireEvent('oncontextmenu');\n    }\n    // return;\n    // element.focus();\n    // let e = element.ownerDocument.createEvent('MouseEvents');\n    // e.initMouseEvent('contextmenu', true, true,\n    //   element.ownerDocument.defaultView, 1, 0, 0, 0, 0, false,\n    //   false, false, false, 2, null);\n    // return !element.dispatchEvent(e);\n  }\n}\n\nclass MyObject {\n\n  static indexBy(arr, key) {\n    let M = {};\n    arr.forEach((obj) => {\n      let value = obj[key];\n      M[value] = obj;\n    });\n    return M;\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static map(obj, func) {\n    return MyObject._object_op('map', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(boolean|any))} func */\n  /** @returns {Object} */\n  static filter(obj, func) {\n    return MyObject._object_op('filter', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static apply(obj, func) {\n    return MyObject._object_op('apply', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static forEach(obj, func) {\n    return MyObject._object_op('forEach', obj, func);\n  }\n\n  /** @param {Object} src */\n  /** @param {'apply'|'filter'|'forEach'|'map'} op*/\n  static _object_op(op, src, func) {\n    assert(1 <= func.length && func.length <= 3);\n    let dest = {};\n    for (let key of Object.keys(src)) {\n      let value = src[key]\n      let result = MyObject._func(func, value, key, src);\n      if (op == 'map') dest[key] = result;\n      else if (op == 'filter') { if (result) dest[key] = value; }\n      else if (op == 'apply') src[key] = result;\n      else if (op == 'forEach') 1 == 1;\n    }\n    return (op == 'map' || op == 'filter') ? dest : null;\n  }\n\n  static _func(func, value, key, src) {\n    return (\n      func.length == 1 ? func(value)\n        : func.length == 2 ? func(value, key)\n          : func(value, key, src)\n    );\n  }\n\n  static reduce_dots(obj) {\n    // converts {'a.b':1, 'a.c':2, b:3} into {a:{b:1,c:2}, 'b':3}. Returns copy (shallow or deep)\n    let dotted = MyObject.filter(obj, (v, k) => k.indexOf('.') >= 0);\n    let no_dots = MyObject.filter(obj, (v, k) => k.indexOf('.') == -1);\n    if (Object.keys(dotted).length == 0) return no_dots;\n    MyObject.forEach(dotted, (v, k) => {\n      let start = k.slice(0, k.indexOf('.'));\n      let end = k.slice(k.indexOf('.') + 1);\n      no_dots[start] = no_dots[start] || {};\n      no_dots[start][end] = v;\n    });\n    return MyObject.reduce_dots(no_dots);\n  }\n\n  static deep_assign(obj, ...objs) {\n    for (let o of objs) {\n      if (!o) continue;\n      for (let key of Object.keys(o)) {\n        if (obj[key] === undefined || typeof (o[key]) != \"object\") obj[key] = o[key];\n        else MyObject.deep_assign(obj[key], o[key]);\n      }\n    }\n    return obj;\n  }\n\n  static deep_copy(obj, ...objs) {\n    if (obj === undefined) return undefined;\n    if (obj === null) return null;\n    if (Array.isArray(obj))\n      return obj.map(x => MyObject.deep_copy(x));\n    if (typeof (obj) == \"object\")\n      return MyObject.map(obj, value => MyObject.deep_copy(value));\n    if (typeof (obj) == \"function\")\n      return obj; // DOES NOT CREATE COPY FOR FUNCTIONS\n    return MyObject.deep_assign(obj, ...objs);\n  }\n\n  static deep_default(default_obj, ...objs) {\n    let obj = MyObject.deep_copy(default_obj);\n    return MyObject.deep_assign(obj, ...objs);\n  }\n\n  /** @param {((value:any, key?:any, obj?:any)=>(boolean|any))} filter_func */\n  static find(obj, filter_func) {\n    for (let key in obj)\n      if (MyObject._func(filter_func, obj[key], key))\n        return key;\n    return null;\n  }\n  static toEntries(obj) {\n    return Object.keys(obj).map(k => [k, obj[k]]);\n  }\n}\n\n\nclass MyDecorators {\n  static once(fn) {\n    let returnValue, canRun = true;\n    return function runOnce() {\n      if (canRun) {\n        returnValue = fn.apply(this, arguments);\n        canRun = false;\n      }\n      return returnValue;\n    }\n  }\n}\n\n\nfunction get_property_handler(object, property) {\n  let access, proto = object;\n  object._hidden_modified = false;\n  while (!access) {\n    proto = Object.getPrototypeOf(proto);\n    access = Object.getOwnPropertyDescriptor(proto, property);\n  }\n  return access;\n}\n\nfunction update_property_handler(object, property, create_handler) {\n  let prev = get_property_handler(object, property);\n  Object.defineProperty(object, property, create_handler(prev));\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","//@ts-check\nimport { isString, range, rand32 } from \"./utils.js\";\n\n/**@template T */\nexport const BruteForceQueue = class {\n  /** @param {T[]} items*/\n  constructor(...items) { this.arr=items||[]; }\n  get length() { return this.arr.length; }\n  *[Symbol.iterator]() { for(let x of this.arr) yield x; };\n  /** @param {T} x*/\n  pushRight(x) { this.arr.push(x); }\n  /** @param {T} x*/\n  pushLeft(x) { this.arr.unshift(x); }\n  popRight() { return this.arr.pop(); }\n  popLeft() { return this.arr.shift(); }\n}\n\n\n/**@template T */\nexport const Queue = class {\n\n  /** @param {T[]} items*/\n  constructor(...items) {\n    /** @type {T[]} */\n    this.arr = [...(items || [])];\n    this.start = 0;\n    this.iterI = 0;\n  }\n  get length() { return this.arr.length-this.start; }\n  _resize(){\n    // Guarantees some unallocated space at the left side\n    const m = 1 + (this.length>>1);\n    //@ts-ignore: ...annoying bug in jsdoc+vscode with...\n    this.arr = [...Array(m).fill(null), ...this];\n    this.iterI = this.iterI - this.start + m;\n    this.start = m;\n  }\n  *[Symbol.iterator]() {\n    this.iterI = this.start;\n    while(this.iterI < this.arr.length){\n      let i = this.iterI++;\n      yield this.arr[i];\n    }\n  }\n  /** @param {T} x*/\n  pushRight(x) { this.arr.push(x); }\n  /** @param {T} x*/\n  pushLeft(x) {\n    if(this.start==0) this._resize();\n    this.arr[--this.start] = x;\n  }\n  popRight() {\n    if(this.start==this.arr.length) return undefined;\n    if(2*this.length < this.arr.length) this._resize();\n    return this.arr.pop();\n  }\n  popLeft() {\n    if(this.start==this.arr.length) return undefined;\n    if(2*this.length < this.arr.length) this._resize();\n    return this.arr[this.start++];\n  }\n}\n\n// Heap\n// Heap with update (Heap Object)\n// RMQ with Fenwick tree\n// RMQ inverse (set max min, get value)\n// Suffix array\n\n\n// https://caph.info/wiki/\n\nexport const BruteForceSuffixArray = (/**@type {string|number[]}*/seq)=>{\n  let arr = !isString(seq)?seq:[...seq].map((_,i)=>seq.charCodeAt(i));\n  const n = arr.length;\n  const suffixArray = range(n);\n  suffixArray.sort((i,j)=>{\n    for(let k=0; i+k<n && j+k<n; k++){\n      if(arr[i+k]<arr[j+k]) return -1;\n      if(arr[i+k]>arr[j+k]) return 1;\n    }\n    return i>j?-1:1;\n  });\n  return {suffixArray};\n}\n\nexport const SuffixArray = (/**@type {string|number[]}*/seq)=>{\n  // Convert to sequence of numbers\n  let rank = !isString(seq)?seq:[...seq].map((_,i)=>seq.charCodeAt(i));\n  let n = rank.length;\n  let shift = 0;\n  while(1<<shift <= n) shift+=1\n  let quickStop = false;\n\n  /** @param {number[]} arr @returns {number[]}*/\n  const ranked = (arr)=>{\n    // Rescales [20 44 44 30 20 10] /**@type {number}*/o [1 3 3 2 1 0]\n    let sortedUnique = [...new Set(arr)].sort((a,b)=>a-b);\n    let ranks = Object.fromEntries(sortedUnique.map((x,i)=>[x,i]));\n    if(sortedUnique.length==n) quickStop = true;\n    return arr.map(x=>ranks[x]);\n  }\n\n  rank = ranked(rank);\n  for(let k=1; !quickStop && k <= n; k = 2*k){\n    rank = rank.map((x,i) => (x<<shift) + (rank[i+k]||0));\n    rank[n-k] -= 1; // resolve the crucial tie with end character\n    rank = ranked(rank);\n  }\n\n  const suffixArray = [...Array(n).fill(0)];\n  for(let i=0;i<n;i++) suffixArray[rank[i]] = i\n\n  const pr/**@type {number}*/ = (k=10)=>{\n    for(let i=0;i<n;i++){\n      let j = suffixArray[i];\n      let s = isString(seq)? seq.substring(j, j+k) : JSON.stringify(seq.slice(i,j));\n      if(s.includes('\\n')) s = s.substring(0, s.indexOf('\\n')) + '|';\n      console.log(`${i} ${j} ${s}`);\n    }\n    return\n  }\n  return {suffixArray, pr/**@type {number}*/, rank};\n}\n\n\n// https://github.com/OpenGenus/cosmos/pull/2407/files\n// https://cp-algorithms.com/data_structures/treap.html#union\n\n// Structure representing a treap node\n/**@typedef {{left:Treap|null, right:Treap|null}} TreapAux*/\n\n\nconst oo = 2<<50;\nexport class Treap{\n  key;\n  minimum;\n  priority;\n  cnt = 1; // Size of this subtree (+1 per node)\n  rvs = false;\n  left = /**@type {Treap|null}*/(null);\n  right = /**@type {Treap|null}*/(null);\n  /** @param {number} key */\n  constructor(key){\n    this.key = key;\n    this.minimum = key;\n    this.priority = Math.random();\n  }\n\n  //Updates the amount of nodes that the subtree starting at root has\n  updateCnt() {\n    this.cnt = 1 + (this.left?.cnt||0) + (this.right?.cnt||0) ;\n  }\n\n  //Updates the minimum of the keys that subtree starting at root has\n  updateMinimum() {\n    this.minimum = Math.min(this.key, this.left?.minimum||oo, this.right?.minimum||oo);\n  }\n\n  //Lazy propagation for the reverse operation\n  push() {\n    if(this.rvs) {\n      this.rvs = false;\n      let tmp = this.left;\n      this.left = this.right;\n      this.right = tmp;\n      if(this.left != null) this.left.rvs = !this.left.rvs;\n      if(this.right != null) this.right.rvs = !this.right.rvs;\n    }\n  }\n\n  /*\n  * Combines two subtrees T1 and T2 and returns the new tree(root).\n  * This operation has O(logN) complexity.\n  * It works under the assumption that T1 and T2 are ordered (all keys in T1 are smaller than keys in T2).\n  */\n  merge(/**@type {Treap|null}*/ T1, /**@type {Treap|null}*/ T2) {\n    T1?.push(); T2?.push();\n    let newRoot /**@type {Treap} */;\n    if(!T1 || !T2) newRoot = /**@type {Treap}*/ (T1 || T2);\n    else if(T1.priority > T2.priority) {\n      T1.right?.merge(T1.right, T2);\n      newRoot = T1;\n    }\n    else {\n      T2.left?.merge(T1, T2.left);\n      newRoot = T2;\n    }\n    // Assignment: this = newRoot\n    if(this!==newRoot){\n      this.key = newRoot.key;\n      this.minimum = newRoot.minimum;\n      this.priority = newRoot.priority;\n      this.cnt = newRoot.cnt;\n      this.rvs = newRoot.rvs;\n      this.left = newRoot.left;\n      this.right = newRoot.right;\n    }\n    this.updateCnt();\n    this.updateMinimum();\n  }\n\n  /**\n   * Separates tree this in 2 subtrees left and right trees (which are the return values of split)\n   * so that left contains all elements with key XL<k, and R contains all elements with key XR>k.\n   * This operation has O(logN) complexity.\n   * @param {number} k \n   * @param {TreapAux} aux \n   * @param {number} add \n   */\n  split(k, aux, add = 0) {\n    this.push();\n    const cur_key = add + (this.left?.cnt||0);\n    if(cur_key < k) {\n      let newAux = {left:this.right, right:aux.right};\n      this.right?.split(k, newAux, add + 1 + (this.left?.cnt||0));\n      aux.left = this;\n    }\n    else {\n      let newAux = {left:aux.left, right:this.left};\n      this.left?.split(k, newAux, add);\n      aux.right = this;\n    }\n    this.updateCnt();\n    this.updateMinimum();\n  }\n\n  //This operation inserts a node with key = k to the treap\n  /**\n   * @param {number} idx\n   * @param {number} k\n   */\n  insert(idx, k) {\n    const newNode = new Treap(k);\n    /**@type {TreapAux}*/\n    let aux = { left:null, right:null};\n    console.log(this);\n    this.split(idx, aux);\n    aux.left?.merge(aux.left, newNode);\n    console.log(aux)\n    this.merge(aux.left, aux.right);\n    console.log(this)\n    this.updateCnt();\n    this.updateMinimum();\n  }\n\n  //This operation erases the node with key = k from the treap\n  erase(/**@type {number}*/ k) {\n    this.push();\n    if(this.key == k) this.merge(this.left, this.right);\n    else if(this.key < k) this.right?.erase(k);\n    else this.left?.erase(k);\n    this.updateCnt();\n    this.updateMinimum();\n  }\n\n  preorder(out=[]) {\n    out.push(this.key);\n    console.log(!!this.left, !!this.right)\n    this.left?.preorder(out);\n    this.right?.preorder(out);\n    return out;\n  }\n\n  //In T3 is the tree with the values [a,b]\n  /**\n   * @param {number} a\n   * @param {number} b\n   */\n  minimum_query(a, b) {\n    let /**@type {Treap|null}*/ T1=null, T2=null, T3=null;\n    let /**@type {TreapAux}*/ aux;\n    aux = {left:T1, right:T2}\n    this.split(a, aux);\n    ({left:T1, right:T2} = aux);\n    aux = {left:T2, right:T3}\n    T2?.split(b-a+1, aux);\n    ({left:T2, right:T3} = aux);\n    /**@type {number}*/\n    let mn = T2?.minimum||oo;\n    this.merge(T1, T2);\n    this.merge(this, T3);\n    return mn;\n  }\n\n  //In T3 is the tree with the values [a,b]\n  /**\n   * @param {number} a\n   * @param {number} b\n   */\n  reverse_query(a, b) {\n    let /**@type {Treap|null}*/ T1=null, T2=null, T3=null;\n    let /**@type {TreapAux}*/ aux;\n    aux = {left: T1, right:T2};\n    this.split (a, aux);\n    ({left:T1, right:T2} = aux);\n    aux = {left: T2, right:T3};\n    T2?.split(b-a+1, aux);\n    ({left:T2, right:T3} = aux);\n    if(T2!=null) T2.rvs = true;\n    this.merge(T1, T2);\n    this.merge(this, T3);\n  }\n\n}\n","//@ts-check\n\nconst compressed = [];\nexport const distPlugins = [\n  'core-menu',\n  'core-about',\n  'katex',\n  'codemirror',\n  'phonetics',\n  // 'fabric.lz.js',\n  // 'mathjax-svg',\n  // // 'gtag',\n  // 'document',\n  // 'slides',\n  // 'whiteboard',\n  // //'figure-editor',\n  // 'hyphenator',\n  // 'auto-scroll',\n].map(name=>({\n  key: `@${name}`,\n  dist: `@dist/components/${name}${compressed.includes(name)?'.lz':''}.js`,\n  src: `plugins/${name}/plugin-${name}.js`,\n}));\n\nexport const compressor = {\n  dist: '@dist/lzutf8.min.js',\n  src: 'libraries/lzutf8-0.6.3/lzutf8.min.js',\n};\n\n/**@param {any} compressor @param {string} text @returns {string}*/\nexport const compress = (compressor, text)=> compressor.compress(text, {outputEncoding: 'Base64'});\n\n/**@param {any} compressor @param {string} text @returns {string}*/\nexport const decompress = (compressor, text)=> compressor.decompress(text, {inputEncoding: 'Base64'});\n\n","//@ts-check\nimport { MyDocument, sleep, until } from \"./utils.js\";\nimport {compressor, decompress, distPlugins} from \"./build-constants.js\";\n\n\nconst plugins = Object.fromEntries(distPlugins.map(e => [e.key, e]));\n\nexport const scriptLoader = (()=>{\n\n  let dist = './dist';\n  for (const e of document.querySelectorAll('script')) {\n    const m = e.src.match(/^(.*)\\/caph-docs\\.(?:min\\.)?js$/)\n    if (m) dist = m[1];\n  }\n  //console.log(dist);\n\n  const div = document.getElementById('core-sources') || MyDocument.createElement('div', {\n    id: 'core-sources',\n    parent: document.head,\n    where: 'beforeend',\n  });\n\n\n  const _randomSessionSuffix = ('' + Math.random()).slice(2);\n  const parseKey = (/** @type {string} */ key)=>{\n    // key is like either 'userComponent', './userFileComponent', '@caphPlugin', '@dist/caphPlugin', 'full URL'\n    let url = key.replace(/^@dist\\/(.*)$/, (_, p)=>`${dist}/${p}`);\n    if(url.startsWith('./')) url += `?${_randomSessionSuffix}`;\n    url = new URL(url, document.baseURI).href;\n    /** @type {string|null} */\n    let proxyKey = null;\n    if(plugins[key]) ({dist:proxyKey} = plugins[key]);\n    return {url, proxyKey};\n  }\n\n  /**\n   * @param {string} ref \n   * @param {{\n   * parent?: HTMLElement|null,\n   * where?: 'beforebegin' | 'afterbegin' | 'beforeend' | 'afterend',\n   * attrs?: {[key:string]:string},\n   * autoAttrs?: boolean,\n   * isCompressed?: boolean|null,\n   * msTimeout?: number,\n   * }} options\n   */\n  const load = (ref, { attrs={}, parent=null, where='beforeend', autoAttrs=true} = {})=>{\n    ({url:ref} = parseKey(ref)); // especially for plugin loading libraries\n    const refBase = ref.split('#')[0].split('?')[0]\n    if (parent == null) parent = div;\n    const ext = refBase.split('.').pop();\n    let tag = ext == 'js' ? 'script' : ext == 'css' ? 'link' : null;\n    if (tag == null) throw new Error('Only .js and .css files can be _sources. Got: ' + ext + ' ' + ref);\n    let /** @type {{[key:string]:string}}*/ defaults = {};\n    if (autoAttrs && tag == 'link') defaults = { rel: 'stylesheet', type: 'text/css' };\n    Object.keys(attrs).forEach(k => defaults[k] = attrs[k]);\n    attrs = defaults;\n    if (tag == 'script') attrs.src = ref;\n    if (tag == 'link') attrs.href = ref;\n    _load_elem(ref, tag, attrs, parent, where);\n  }\n\n  // const loadFont = async(/** @type {string}*/name)=>{\n  //   return await load(`${dist}/font-${name}.css`);\n  // }\n  // async loadPlugin(name) {\n  //   return await this.load(`${dist}/plugin-${name}.js`);\n  // }\n\n  const status = {};\n\n  const _load_elem = (ref, tag, attrs, parent, where) => new Promise((_ok, _err) => {\n    if (status[ref]) return _ok(null); \n    status[ref] = true;\n    let e = document.createElement(tag);\n    for(let key in attrs) e.setAttribute(key, attrs[key]);\n    let done = false;\n    e.onload = () => { if (!done) { done = true; _ok(null); } };\n    e.onerror = (err) => { if (!done) { done = true; _err(err); } }; // HTTP errors only\n    parent.insertAdjacentElement(where, e);\n  });\n\n  const injectStyle = (/** @type {string} */ styleStr)=>{\n    MyDocument.createElement('style', { parent: div, where: 'beforeend', text: styleStr });\n  }\n  return {injectStyle, load, div, dist, parseKey};\n})();\n\nexport const parseKey = scriptLoader.parseKey;\nexport const injectStyle = scriptLoader.injectStyle;\nexport const load = scriptLoader.load;\n","var n,l,u,i,t,o,r,f={},e=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function s(n,l){for(var u in l)n[u]=l[u];return n}function a(n){var l=n.parentNode;l&&l.removeChild(n)}function h(l,u,i){var t,o,r,f={};for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return v(l,f,t,o,null)}function v(n,i,t,o,r){var f={type:n,props:i,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++u:r};return null==r&&null!=l.vnode&&l.vnode(f),f}function y(){return{current:null}}function p(n){return n.children}function d(n,l){this.props=n,this.context=l}function _(n,l){if(null==l)return n.__?_(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?_(n):null}function k(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k(n)}}function b(n){(!n.__d&&(n.__d=!0)&&t.push(n)&&!g.__r++||o!==l.debounceRendering)&&((o=l.debounceRendering)||setTimeout)(g)}function g(){for(var n;g.__r=t.length;)n=t.sort(function(n,l){return n.__v.__b-l.__v.__b}),t=[],n.some(function(n){var l,u,i,t,o,r;n.__d&&(o=(t=(l=n).__v).__e,(r=l.__P)&&(u=[],(i=s({},t)).__v=t.__v+1,j(r,t,i,l.__n,void 0!==r.ownerSVGElement,null!=t.__h?[o]:null,u,null==o?_(t):o,t.__h),z(u,t),t.__e!=o&&k(t)))})}function w(n,l,u,i,t,o,r,c,s,a){var h,y,d,k,b,g,w,x=i&&i.__k||e,C=x.length;for(u.__k=[],h=0;h<l.length;h++)if(null!=(k=u.__k[h]=null==(k=l[h])||\"boolean\"==typeof k?null:\"string\"==typeof k||\"number\"==typeof k||\"bigint\"==typeof k?v(null,k,null,null,k):Array.isArray(k)?v(p,{children:k},null,null,null):k.__b>0?v(k.type,k.props,k.key,null,k.__v):k)){if(k.__=u,k.__b=u.__b+1,null===(d=x[h])||d&&k.key==d.key&&k.type===d.type)x[h]=void 0;else for(y=0;y<C;y++){if((d=x[y])&&k.key==d.key&&k.type===d.type){x[y]=void 0;break}d=null}j(n,k,d=d||f,t,o,r,c,s,a),b=k.__e,(y=k.ref)&&d.ref!=y&&(w||(w=[]),d.ref&&w.push(d.ref,null,k),w.push(y,k.__c||b,k)),null!=b?(null==g&&(g=b),\"function\"==typeof k.type&&k.__k===d.__k?k.__d=s=m(k,s,n):s=A(n,k,d,x,b,s),\"function\"==typeof u.type&&(u.__d=s)):s&&d.__e==s&&s.parentNode!=n&&(s=_(d))}for(u.__e=g,h=C;h--;)null!=x[h]&&(\"function\"==typeof u.type&&null!=x[h].__e&&x[h].__e==u.__d&&(u.__d=_(i,h+1)),N(x[h],x[h]));if(w)for(h=0;h<w.length;h++)M(w[h],w[++h],w[++h])}function m(n,l,u){for(var i,t=n.__k,o=0;t&&o<t.length;o++)(i=t[o])&&(i.__=n,l=\"function\"==typeof i.type?m(i,l,u):A(u,i,i,t,i.__e,l));return l}function x(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(Array.isArray(n)?n.some(function(n){x(n,l)}):l.push(n)),l}function A(n,l,u,i,t,o){var r,f,e;if(void 0!==l.__d)r=l.__d,l.__d=void 0;else if(null==u||t!=o||null==t.parentNode)n:if(null==o||o.parentNode!==n)n.appendChild(t),r=null;else{for(f=o,e=0;(f=f.nextSibling)&&e<i.length;e+=2)if(f==t)break n;n.insertBefore(t,o),r=o}return void 0!==r?r:t.nextSibling}function C(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||H(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||H(n,o,l[o],u[o],i)}function $(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=null==u?\"\":\"number\"!=typeof u||c.test(l)?u:u+\"px\"}function H(n,l,u,i,t){var o;n:if(\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof i&&(n.style.cssText=i=\"\"),i)for(l in i)u&&l in u||$(n.style,l,\"\");if(u)for(l in u)i&&u[l]===i[l]||$(n.style,l,u[l])}else if(\"o\"===l[0]&&\"n\"===l[1])o=l!==(l=l.replace(/Capture$/,\"\")),l=l.toLowerCase()in n?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?i||n.addEventListener(l,o?T:I,o):n.removeEventListener(l,o?T:I,o);else if(\"dangerouslySetInnerHTML\"!==l){if(t)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"href\"!==l&&\"list\"!==l&&\"form\"!==l&&\"tabIndex\"!==l&&\"download\"!==l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null!=u&&(!1!==u||\"a\"===l[0]&&\"r\"===l[1])?n.setAttribute(l,u):n.removeAttribute(l))}}function I(n){this.l[n.type+!1](l.event?l.event(n):n)}function T(n){this.l[n.type+!0](l.event?l.event(n):n)}function j(n,u,i,t,o,r,f,e,c){var a,h,v,y,_,k,b,g,m,x,A,C,$,H=u.type;if(void 0!==u.constructor)return null;null!=i.__h&&(c=i.__h,e=u.__e=i.__e,u.__h=null,r=[e]),(a=l.__b)&&a(u);try{n:if(\"function\"==typeof H){if(g=u.props,m=(a=H.contextType)&&t[a.__c],x=a?m?m.props.value:a.__:t,i.__c?b=(h=u.__c=i.__c).__=h.__E:(\"prototype\"in H&&H.prototype.render?u.__c=h=new H(g,x):(u.__c=h=new d(g,x),h.constructor=H,h.render=O),m&&m.sub(h),h.props=g,h.state||(h.state={}),h.context=x,h.__n=t,v=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=H.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=s({},h.__s)),s(h.__s,H.getDerivedStateFromProps(g,h.__s))),y=h.props,_=h.state,v)null==H.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==H.getDerivedStateFromProps&&g!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(g,x),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(g,h.__s,x)||u.__v===i.__v){h.props=g,h.state=h.__s,u.__v!==i.__v&&(h.__d=!1),h.__v=u,u.__e=i.__e,u.__k=i.__k,u.__k.forEach(function(n){n&&(n.__=u)}),h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(g,h.__s,x),null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,_,k)})}if(h.context=x,h.props=g,h.__v=u,h.__P=n,A=l.__r,C=0,\"prototype\"in H&&H.prototype.render)h.state=h.__s,h.__d=!1,A&&A(u),a=h.render(h.props,h.state,h.context);else do{h.__d=!1,A&&A(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++C<25);h.state=h.__s,null!=h.getChildContext&&(t=s(s({},t),h.getChildContext())),v||null==h.getSnapshotBeforeUpdate||(k=h.getSnapshotBeforeUpdate(y,_)),$=null!=a&&a.type===p&&null==a.key?a.props.children:a,w(n,Array.isArray($)?$:[$],u,i,t,o,r,f,e,c),h.base=u.__e,u.__h=null,h.__h.length&&f.push(h),b&&(h.__E=h.__=null),h.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=L(i.__e,u,i,t,o,r,f,c);(a=l.diffed)&&a(u)}catch(n){u.__v=null,(c||null!=r)&&(u.__e=e,u.__h=!!c,r[r.indexOf(e)]=null),l.__e(n,u,i)}}function z(n,u){l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function L(l,u,i,t,o,r,e,c){var s,h,v,y=i.props,p=u.props,d=u.type,k=0;if(\"svg\"===d&&(o=!0),null!=r)for(;k<r.length;k++)if((s=r[k])&&\"setAttribute\"in s==!!d&&(d?s.localName===d:3===s.nodeType)){l=s,r[k]=null;break}if(null==l){if(null===d)return document.createTextNode(p);l=o?document.createElementNS(\"http://www.w3.org/2000/svg\",d):document.createElement(d,p.is&&p),r=null,c=!1}if(null===d)y===p||c&&l.data===p||(l.data=p);else{if(r=r&&n.call(l.childNodes),h=(y=i.props||f).dangerouslySetInnerHTML,v=p.dangerouslySetInnerHTML,!c){if(null!=r)for(y={},k=0;k<l.attributes.length;k++)y[l.attributes[k].name]=l.attributes[k].value;(v||h)&&(v&&(h&&v.__html==h.__html||v.__html===l.innerHTML)||(l.innerHTML=v&&v.__html||\"\"))}if(C(l,p,y,o,c),v)u.__k=[];else if(k=u.props.children,w(l,Array.isArray(k)?k:[k],u,i,t,o&&\"foreignObject\"!==d,r,e,r?r[0]:i.__k&&_(i,0),c),null!=r)for(k=r.length;k--;)null!=r[k]&&a(r[k]);c||(\"value\"in p&&void 0!==(k=p.value)&&(k!==l.value||\"progress\"===d&&!k||\"option\"===d&&k!==y.value)&&H(l,\"value\",k,y.value,!1),\"checked\"in p&&void 0!==(k=p.checked)&&k!==l.checked&&H(l,\"checked\",k,y.checked,!1))}return l}function M(n,u,i){try{\"function\"==typeof n?n(u):n.current=u}catch(n){l.__e(n,i)}}function N(n,u,i){var t,o;if(l.unmount&&l.unmount(n),(t=n.ref)&&(t.current&&t.current!==n.__e||M(t,null,u)),null!=(t=n.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(n){l.__e(n,u)}t.base=t.__P=null}if(t=n.__k)for(o=0;o<t.length;o++)t[o]&&N(t[o],u,\"function\"!=typeof n.type);i||null==n.__e||a(n.__e),n.__e=n.__d=void 0}function O(n,l,u){return this.constructor(n,u)}function P(u,i,t){var o,r,e;l.__&&l.__(u,i),r=(o=\"function\"==typeof t)?null:t&&t.__k||i.__k,e=[],j(i,u=(!o&&t||i).__k=h(p,null,[u]),r||f,f,void 0!==i.ownerSVGElement,!o&&t?[t]:r?null:i.firstChild?n.call(i.childNodes):null,e,!o&&t?t:r?r.__e:i.firstChild,o),z(e,u)}function S(n,l){P(n,l,S)}function q(l,u,i){var t,o,r,f=s({},l.props);for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),v(l.type,f,t||l.key,o||l.ref,null)}function B(n,l){var u={__c:l=\"__cC\"+r++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var u,i;return this.getChildContext||(u=[],(i={})[l]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(b)},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n=e.slice,l={__e:function(n,l,u,i){for(var t,o,r;l=l.__;)if((t=l.__c)&&!t.__)try{if((o=t.constructor)&&null!=o.getDerivedStateFromError&&(t.setState(o.getDerivedStateFromError(n)),r=t.__d),null!=t.componentDidCatch&&(t.componentDidCatch(n,i||{}),r=t.__d),r)return t.__E=t}catch(l){n=l}throw n}},u=0,i=function(n){return null!=n&&void 0===n.constructor},d.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=s({},this.state),\"function\"==typeof n&&(n=n(s({},u),this.props)),n&&s(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),b(this))},d.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),b(this))},d.prototype.render=p,t=[],g.__r=0,r=0;export{P as render,S as hydrate,h as createElement,h,p as Fragment,y as createRef,i as isValidElement,d as Component,q as cloneElement,B as createContext,x as toChildArray,l as options};\n//# sourceMappingURL=preact.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,c=[],f=[],e=n.__b,a=n.__r,v=n.diffed,l=n.__c,m=n.unmount;function d(t,u){n.__h&&n.__h(r,t,o||u),o=0;var i=r.__H||(r.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({__V:f}),i.__[t]}function p(n){return o=1,y(z,n)}function y(n,u,i){var o=d(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):z(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.u)){r.u=!0;var c=r.shouldComponentUpdate;r.shouldComponentUpdate=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=!1;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),!!i&&(!c||c.call(this,n,t,r))}}return o.__N||o.__}function h(u,i){var o=d(t++,3);!n.__s&&w(o.__H,i)&&(o.__=u,o.i=i,r.__H.__h.push(o))}function s(u,i){var o=d(t++,4);!n.__s&&w(o.__H,i)&&(o.__=u,o.i=i,r.__h.push(o))}function _(n){return o=5,F(function(){return{current:n}},[])}function A(n,t,r){o=6,s(function(){return\"function\"==typeof n?(n(t()),function(){return n(null)}):n?(n.current=t(),function(){return n.current=null}):void 0},null==r?r:r.concat(n))}function F(n,r){var u=d(t++,7);return w(u.__H,r)?(u.__V=n(),u.i=r,u.__h=n,u.__V):u.__}function T(n,t){return o=8,F(function(){return n},t)}function q(n){var u=r.context[n.__c],i=d(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function x(t,r){n.useDebugValue&&n.useDebugValue(r?r(t):t)}function V(n){var u=d(t++,10),i=p();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n){u.__&&u.__(n),i[1](n)}),[i[0],function(){i[1](void 0)}]}function b(){for(var t;t=c.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(j),t.__H.__h.forEach(k),t.__H.__h=[]}catch(r){t.__H.__h=[],n.__e(r,t.__v)}}n.__b=function(n){r=null,e&&e(n)},n.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=f,n.__N=n.i=void 0})):(i.__h.forEach(j),i.__h.forEach(k),i.__h=[])),u=r},n.diffed=function(t){v&&v(t);var o=t.__c;o&&o.__H&&(o.__H.__h.length&&(1!==c.push(o)&&i===n.requestAnimationFrame||((i=n.requestAnimationFrame)||function(n){var t,r=function(){clearTimeout(u),g&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);g&&(t=requestAnimationFrame(r))})(b)),o.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==f&&(n.__=n.__V),n.i=void 0,n.__V=f})),u=r=null},n.__c=function(t,r){r.some(function(t){try{t.__h.forEach(j),t.__h=t.__h.filter(function(n){return!n.__||k(n)})}catch(u){r.some(function(n){n.__h&&(n.__h=[])}),r=[],n.__e(u,t.__v)}}),l&&l(t,r)},n.unmount=function(t){m&&m(t);var r,u=t.__c;u&&u.__H&&(u.__H.__.forEach(function(n){try{j(n)}catch(n){r=n}}),r&&n.__e(r,u.__v))};var g=\"function\"==typeof requestAnimationFrame;function j(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function k(n){var t=r;n.__c=n.__(),r=t}function w(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function z(n,t){return\"function\"==typeof t?t(n):t}export{p as useState,y as useReducer,h as useEffect,s as useLayoutEffect,_ as useRef,A as useImperativeHandle,F as useMemo,T as useCallback,q as useContext,x as useDebugValue,V as useErrorBoundary};\n//# sourceMappingURL=hooks.module.js.map\n","//@ts-check\n/// <reference path=\"types.js\" />\nimport { assertNonNull, assert, until, sleep } from './utils.js';\nimport { createParser } from './parser.js';\nimport { load, parseKey, injectStyle } from './script-loader.js';\nimport * as preact from 'preact';\nimport { useMemo, useCallback, useState, useEffect} from 'preact/hooks';\n\n/** @typedef {(props:Object)=>Elem} Component */\n\n\nexport const createPreactParser = ()=>{\n  const parser = createParser();\n  parser.settings.FragmentComponent = preact.Fragment;\n  parser.settings.createElement = (type, props, ...children)=> {\n    if (props && props.hasOwnProperty('(component)')) {\n      let pluginKey = props['(component)'];\n      type = plugin(pluginKey);\n      // if (pluginKey) type = plugin(pluginKey);\n      // else console.warn('caph tag without plugin attribute');\n    }\n    const vDom = preact.createElement(type, props, ...children);\n    return vDom;\n  }\n  return parser;\n}\n\nexport const parser = createPreactParser();\n\n/** @type {{[key:string]: Component|Promise<Component>}} */\nexport const pluginDefs = {}\n\n\n/** @type {{[key:string]: Component}} */\nconst pluginComponents = {}\nexport const plugin = (/** @type {string} */ key)=>{ // key is either a tag or a url\n  const cache = pluginComponents;\n  return cache[key] || (cache[key] = componentWrapper(key));\n}\n\n/** @type {{[key:string]: Component}} */\nconst componentWrappers = {};\nconst componentWrapper = (/** @type {string} */ key)=>{\n  const cache = componentWrappers;\n  return cache[key] || (cache[key] = newPluginLoader(key));\n}\n\n/** @returns {Component} */\nconst newPluginLoader = (/** @type {string}*/ key)=>{\n  //scriptLoader.load('caph-docs/core/plugin-loader.css');\n\n  const loadStatus = {\n    Component: /** @type {null|Component}*/(null),\n    error: null,\n    renderReady: false,\n  }\n\n  function FinalComponent({ children, ...props }) {\n    try {\n      const Component = assertNonNull(loadStatus.Component);\n      const out = Component({ children, ...props });\n      assert(!out.then, `Your component can not be a promise itself (${key}).\n      Maybe you defined pluginDefs[...] = (async ()=>{...}) instead of pluginDefs[...] = (async ()=>{...})()?\n      Please follow the IIFE pattern for async promises.`);\n      return out;\n    } catch (err) {\n      console.error(`Rendering error in plugin ${key}:`, err);\n      return parser.parse`<code class=\"caph-flashing\">${children || '...error...'}</code>`;\n    }\n  }\n\n  function LoadingComponent({ children }) {\n    return parser.parse`\n    <code class=\"caph-flashing\" title=${`${key} is loading...`}>${children || '...'}</code>`;\n  }\n\n  function LoadErrorComponent({}) {\n    return parser.parse`<${plugin('core-error')} tooltip=${loadStatus.error}/>`;\n  }\n\n  const {url, proxyKey} = parseKey(key);\n  const main = async ()=>{\n    // 1. Put the plugin script in the document head and wait for the browser to load the script\n    try{\n      if (pluginDefs.hasOwnProperty(key)){} // already loaded\n      else if (proxyKey) {\n        pluginDefs[key] = componentWrapper(proxyKey);\n      } else if(url) {\n        load(url);\n        await until(() => pluginDefs[url], { timeout: 3800});\n        // assert(pluginDefs[url], `Plugin ${key} not declared in file ${url}`);\n        pluginDefs[key] = pluginDefs[url];\n        if (key != url) delete pluginDefs[url];\n      } else {\n        await until(() => pluginDefs[key], {timeout: 3800});\n      } // User plugin\n    } catch(err){\n      loadStatus.error = err || true;\n      console.error(`Could not load plugin ${key}`, err);\n      return;\n    }\n    // 3. Start the plugin promise but don't wait for it\n    (async()=>{\n      try {\n        loadStatus.Component = await pluginDefs[key];\n        loadStatus.renderReady = true;\n      } catch (err) {\n        loadStatus.error = err || true;\n        console.log(pluginDefs[key])\n        console.error(`Error while awaiting pluginDefs[\"${key}\"]`, err);\n      }\n    })();\n  }\n  main();\n  return ({ children, ...props })=>{\n    const [trigger, setTrigger] = useState(0);\n\n    const asyncLoad = useCallback(async () => {\n      await until(() => loadStatus.renderReady || loadStatus.error);\n      setTrigger(Math.random() * 1e12); // refresh this component\n    }, []);\n    useEffect(()=>{asyncLoad()}, []);\n    \n    const Component = useMemo(()=>{\n      if (loadStatus.renderReady) return FinalComponent;\n      else if (loadStatus.error) return LoadErrorComponent;\n      else return LoadingComponent;\n    }, [trigger]);\n    \n    return Component({ children, ...props })\n  };\n}\n\n\n\n\npluginDefs['core-error'] = (async () => ({ children, tooltip }) => {\n  const help = useCallback(() => {\n    const win = window.open('', '_blank');\n    if (!win) throw new Error('Popup blocked');\n    win.document.write(`\n      <div>\n        1. In tex, use \\\\lt and \\\\gt instead of &lt; and &gt;.\n        <br/>\n        2. In html, use \\\\$ instead of $.\n        <br/>\n        This prevents any parsing misunderstanding.\n      </div>\n    `);\n  }, []);\n  return parser.parse`\n    <a href=\"./error-help\" onclick=${(e) => {\n    e.preventDefault();\n      help();\n    }}>(help?)</a> \n    <code class=\"caph-flashing caph-error\" title=${tooltip}>${children || tooltip || 'Error'}</code>\n  `;\n})();\n\n// pluginDefs['@paragraphs'] = (async () =>({ children }) => useMemo(\n//     ()=>this._evalAst([null, null, parser.spacingRulesParagraphs(preact.toChildArray(children))]),\n//     [children],\n// ))();\n\n// pluginDefs['code'] = (async () => ({ children, progLang }) => useMemo(\n//   ()=>parser..parse`<code>${children}</code>`,\n//   [children],\n// ))(),\n\n\nparser.settings.parsingRules = [\n  {component: '@mathInline', start: /(?<!\\\\)\\$(?!\\$)/y, capture: /(.*?)(?<!\\\\)\\$/ys, },\n  {component: '@mathDisplay', start: /(?<!\\\\)\\$\\$/y, capture: /(.*?)(?<!\\\\)\\$\\$/ys, },\n  {component: '@codeInline', start: /(?<!\\\\)`(?!``)/y, capture: /(.*?)(?<!\\\\)`/ys, },\n  {component: '@codeDisplay', start: /(?<!\\\\)```/y, capture: /(.*?)(?<!\\\\)```/ys, },\n]\npluginDefs['@mathInline'] = ({ children}) => parser.parse`\n  <div (component)=\"@katex\" displayMode=${false}>${children}</div>\n`;\npluginDefs['@mathDisplay'] = ({ children}) => parser.parse`\n  <div (component)=\"@katex\" displayMode=${true}>${children}</div>\n`;\npluginDefs['@codeInline'] = ({ children}) => parser.parse`\n  <code>${children}</code>\n`;\npluginDefs['@codeDisplay'] = ({ children}) => parser.parse`\n  <div><code>${children}</code></div>\n`;\n\n\ninjectStyle(`\n.caph-error{\n  color: #ce1111;\n}\n.caph-flashing{\n  -webkit-animation: caphFlashingAnimation 1s linear infinite;\n  animation: caphFlashingAnimation 1s linear infinite;\n}\n@keyframes caphFlashingAnimation {\n  0% { opacity: 0.3; }\n  100% { opacity: 1; }\n}\n\n.caph-hidden{\n  display: none;\n}\n\n.caph-box-shadow{\n  box-shadow: 0px 0px 0.3rem 0.05rem var(--box-shadow);\n}\n.caph-box-shadow:hover{\n  box-shadow: 0px 0px 0.3rem 0.2rem var(--box-shadow);\n}\n.caph-fullscreen-layer{\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 100;\n}\n.caph-hbox{ display: flex; }\n.caph-vbox{ display: flex; flex-direction: column; }\n.caph-boxcenter{ justify-content: center; }\n.caph-space-around{ justify-content: space-around; }\n.caph-space-between{ justify-content: space-between; }\n.caph-flex{ flex: 1; }\n.caph-hidden{ display:none; }\n.caph-plugin-hidden{ display:none; }\n.caph-border{\n  border: solid 2px var(--text-strong);\n}`)\n","//@ts-check\nimport { MyPromise } from \"./utils.js\";\nimport { parser, plugin } from \"./preact-parser.js\";\nimport { createContext, render } from \"preact\";\nimport {useMemo, useCallback, useState, useEffect} from 'preact/hooks';\n\nexport const contexts = {};\ncontexts['core-menu'] = createContext(null);\n\nexport const _globals = {};\nexport function dispatchGlobal(eventName, value) {\n  //console.log('Dispatch', eventName, value);\n  _globals[eventName] = value;\n  let event = new CustomEvent(eventName, {detail:value});\n  window.dispatchEvent(event);\n  return;\n}\nexport async function untilGlobal(eventName) {\n  await MyPromise.until(() => _globals[eventName]);\n  await MyPromise.sleep(500);\n}\nexport function listenToGlobal(eventName) {\n  const initial = useMemo(()=>_globals[eventName], [eventName]);\n  const [value, setValue] = useState(initial);\n  listenToEvent(eventName, setValue);\n  return value;\n}\n\nexport const menu = new class {\n  constructor() {\n    this.addOption('Default', { hold: true });\n    this.latest = this.option = 'Default';\n  }\n  options = [];\n  onEnter = {};\n  onExit = {};\n  hold = {};\n\n  /**\n   * @param {string} option\n   * @param {{onEnter?:()=>void, onExit?:()=>void, hold?:boolean}} options\n  */\n  addOption(option, { onEnter, onExit, hold } = {}) {\n    this.onEnter[option] = onEnter;\n    this.onExit[option] = onExit;\n    this.hold[option] = hold;\n    if (this.options[option]) return;\n    this.options.push(option);\n    this.options[option] = 1;\n    dispatchGlobal('caph-menu-options', Math.random());\n  }\n  setOption(option) {\n    dispatchGlobal('caph-menu-option', Math.random());\n    if (this.hold[option]) {\n      this.onExit[this.latest] && this.onExit[this.latest]();\n      this.latest = this.option;\n      this.option = option;\n    }\n    this.onEnter[option] && this.onEnter[option]();\n  }\n};\n\nexport async function inject(vDom) {\n  // const node = MyDocument.createElement('div', {\n  //   parent: document.body,\n  //   where: 'afterbegin',\n  //   id: 'core-body',\n  // })\n  const node = document.body;\n  render(vDom, node);\n}\n\nMyPromise.until(() => document.body).then(()=>{\n  inject(parser.parse`\n    <${plugin('@core-menu')}/>\n    <${plugin('@core-about')}/>\n  `);\n});\n\n/**\n * @param {string} eventName \n * @param {(data:any)=>void} callback \n */\nexport function listenToEvent(eventName, callback) {\n  useEffect(() => {\n    const actualCallback = (/** @type {Event|CustomEvent}*/ e) => {\n      //@ts-ignore: event.detail is not defined for non-custom events\n      try{callback(e.detail);}\n      catch(err){}\n    }\n    window.addEventListener(eventName, actualCallback);\n    return () => {\n      window.removeEventListener(eventName, actualCallback);\n    }\n  }, [eventName, callback]);\n}\n\n","//@ts-check\nimport { MyPromise, sleep, assert, assertNonNull } from \"./utils.js\";\nimport * as collections from \"./collections.js\";\nimport { createParser as createAstParser } from \"./parser.js\";\nimport { parser, pluginDefs, plugin, createPreactParser } from \"./preact-parser.js\";\nimport { contexts, menu, listenToEvent, listenToGlobal } from \"./preact-globals.js\";\nimport { toChildArray } from \"preact\";\nimport { useMemo, useState } from \"preact/hooks\";\nimport { load, injectStyle } from \"./script-loader.js\";\nimport * as scriptLoader from \"./script-loader.js\";\nimport * as preactBase from \"preact\";\nimport * as preactHooks from \"preact/hooks\";\nimport { compressor, decompress } from \"./build-constants.js\";\n/** @typedef {import(\"./preact-parser\").Component} Component */ \n\n\nexport const preact = {...preactBase, ...preactHooks};\nwindow[\"preact\"] = preact;\n\nexport const libraries = {};\nlibraries.preact = preact;\n(async()=>{ libraries.lzutf8=await MyPromise.until(()=>window['LZUTF8']); })();\n\nexport { scriptLoader, load, injectStyle, createAstParser };\nexport {parser, pluginDefs, plugin, createPreactParser};\nexport const {parse, parseAst, parseAstHtml, parseHtml} = parser;\n\nconst noRulesParser = createPreactParser();\nnoRulesParser.settings.customRules = [];\nexport const {parse: parseNoMarkup} = noRulesParser;\n\n\nexport const parseElem = (/** @type {HTMLElement}*/elem, /** @type {('clear'|'hide'|'remove')?}*/action) => {\n  const html = elem.innerHTML;\n  if(!action){} // Do nothing\n  else if(action=='clear') elem.innerHTML = '';\n  else if(action=='remove') elem.remove();\n  else if (action=='hide') elem.classList.add('caph-hidden');\n  return parseHtml(html);\n}\n\nexport const until = MyPromise.until;\nexport {assert, sleep};\nexport { collections };\nexport {contexts, menu, listenToEvent, listenToGlobal};\n\n\n/** @param {Component | Promise<Component>} definition */ \nexport const defineFileComponent = (definition)=>{\n  const elem = assertNonNull(document?.currentScript);\n  /** @type {string}*/\n  const src = elem.getAttribute('data-original-src')||elem['src'];\n  pluginDefs[src] = definition;\n}\n\n/** @param {string} dist @param {string} compressedSequence */ \nexport const injectCompressedScript = async (dist, compressedSequence)=>{\n  /* Used in all compressed plugins. See build-plugins.js */  \n  await load(compressor.dist);\n  await until(()=>window['LZUTF8']);\n  const jsCode = decompress(window[\"LZUTF8\"], compressedSequence);\n  const e = document.createElement('script');\n  const {url} = scriptLoader.parseKey(dist);\n  e.setAttribute('data-original-src', url);\n  e.innerHTML = jsCode;\n  document.getElementById('core-sources')?.insertAdjacentElement('beforeend', e);\n}\n\nexport const settings = {\n  get mathParser(){ return parser.mathParser; },\n  mathMacros: {},\n  set mathParser(/** @type {'@katex'|'@mathjax'} */value) {\n    parser.mathParser = value;\n  }\n};\n\ninjectStyle(`\ndiv.caph-paragraph + div.caph-paragraph { margin-top: 1em; }\n.caph-paragraph h1,h2,h3,h4,h5,h6,ul,ol{ margin:0; }\ncode {\n  padding: 0em 0.2em;\n  background-color: #f8f9fa;\n  color: #000;\n  border: 1px solid #eaecf0;\n  border-radius: 2px;\n}\n`);\n\n// tab effects: https://alvarotrigo.com/blog/html-css-tabs/\ninjectStyle(`\n.tabs-header>label>input { display: none; }\n.tabs-parent { width: 100%; }\n.tabs-header {\n  margin-top: 0.1em;\n  border-bottom: 1px solid;\n}\n.tab-label:hover {\n  top: -0.25rem;\n  transition: top 0.25s;\n}\n.tabs{\n  border: solid 1px;\n  border-top: none;\n}\n.tab-label {\n  padding-left: 1em;\n  padding-right: 1em;\n  border-radius: 0.3em 0.3em 0 0;\n  background: unset;\n  border: solid 1px;\n  white-space:nowrap;\n}\n/* https://stackoverflow.com/a/10148189/3671939 */\n.tab-label { white-space:nowrap; }\n.tab-label > span{ white-space: normal; }\n\n.tab-label-true {\n  font-weight: bold;\n  border-bottom: solid 2px white;\n}\n.tab-content-false { display:none; }\n.tab-content-true {\n  display: true;\n  opacity: 1;\n\tanimation-name: fadeInOpacity;\n\tanimation-iteration-count: 1;\n\tanimation-timing-function: ease-in;\n\tanimation-duration: 0.15s;\n}\n@keyframes fadeInOpacity {\n\t0% { opacity: 0; }\n\t100% { opacity: 1;}\n}\n.tab-content-true { padding: 1vw; }\n`);\npluginDefs['@tabs'] = ({/** @type {string[]} */ labels, defaultLabel, children})=>{\n  const zipped = useMemo(()=>toChildArray(children).map(\n    (child,i) => ({label:labels[i]||`Tab ${i+1}`, child})\n  ), [labels, children]);\n  const [option, setOption] = useState(defaultLabel || zipped[0]?.label);\n  return parse`\n  <div class=\"tabs-parent\">\n    <div class=\"tabs-header\">\n      ${labels.map((label)=>parse`\n        <label class=\"tab-label\" class=${'tab-label-'+(option==label)}>\n          <input type=\"radio\" checked=${option==label} onClick=${()=>setOption(label)}/>\n          <span>${label}</>\n        </label>`\n      )}\n    </div>\n    <div class=\"tabs\">\n      ${zipped.map(({label, child})=>parse`\n        <div class=${'tab-content-'+(option==label)}>${child}</>`\n      )}\n    </div>\n  </>`;\n}\n","import * as caph from './main.js';\n\nexport default caph;"],"names":["htmlSafe","str","Option","innerHTML","htmlSafeUndo","l","content","match","DOMParser","parseFromString","documentElement","textContent","AstParser","ESC","SPEC","DEBUG","values","pos","parsingRules","static","raw","strings","this","root","warn","args","console","error","constructor","debug","cls","join","escaped","regEscaped","RegExp","replace","index","valueIndex","errorStop","log","optionalClose","bind","REG_EXP_TEXT","map","start","source","parent","parseRoot","evalTree","createElement","FragmentComponent","Array","isArray","tag","props","children","child","parseChildrenAndParentClose","name","length","parentTag","parentProps","childlessTags","br","area","base","col","command","embed","hr","img","input","keygen","link","meta","param","track","wbr","_optionalClose","run","regExp","lastIndex","exec","throw","tryRun","e","tryRunUndo","debugPosition","delta","at","Math","max","slice","spacing","text","push","value","startsWith","consumeComment","endReached","parsedRule","capture","component","textStart","_","replaceText","result","_tag","newParent","grandParent","parseParent","pop","spacingRulesParagraphs","spacingRulesJsx","reg","undefined","admitsChildren","toLowerCase","key","_value","endsWith","eval","prevValue","includes","m","code","stack","filter","x","reverse","newChildren","split","forEach","i","middle","r","trimText","first","elems","reason","Error","regComment","posOfText","original","exampleCreateElement","type","exampleFragmentComponent","exampleParsingRules","createParser","settings","parseAst","templateString","astUndoHtml","parseAstHtml","ast","parse","parseHtml","assertNonNull","range","n","fill","isString","obj","Object","prototype","toString","call","assert","condition","messages","sleep","ms","Promise","ok","err","setTimeout","MyPromise","promises","any_error","cnt","outs","p","all","async","finish_all","func","timeout","t0","Date","getTime","Timeout","promise","finished","resp","then","until","MyDocument","style","id","classList","html","eventListeners","where","attrs","document","setAttribute","s","add","innerText","MyObject","addEventListener","body","insertAdjacentElement","element","focus","window","CustomEvent","dispatchEvent","createEvent","ev","initEvent","fireEvent","arr","M","_object_op","op","src","dest","keys","_func","dotted","v","k","indexOf","no_dots","end","reduce_dots","objs","o","deep_assign","deep_copy","default_obj","filter_func","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","defineProperty","enumerable","get","prop","hasOwnProperty","Symbol","toStringTag","BruteForceQueue","items","iterator","pushRight","pushLeft","unshift","popRight","popLeft","shift","Queue","iterI","_resize","BruteForceSuffixArray","seq","charCodeAt","suffixArray","sort","j","SuffixArray","rank","quickStop","ranked","sortedUnique","Set","a","b","ranks","fromEntries","pr","substring","JSON","stringify","oo","Treap","minimum","priority","rvs","left","right","random","updateCnt","updateMinimum","min","tmp","merge","T1","T2","newRoot","aux","newAux","insert","idx","newNode","erase","preorder","out","minimum_query","T3","mn","reverse_query","compressed","distPlugins","dist","plugins","scriptLoader","querySelectorAll","div","getElementById","head","_randomSessionSuffix","parseKey","url","URL","baseURI","href","proxyKey","status","injectStyle","styleStr","load","ref","autoAttrs","refBase","ext","defaults","rel","_ok","_err","done","onload","onerror","_load_elem","u","t","f","c","parentNode","removeChild","h","arguments","defaultProps","__k","__","__b","__e","__d","__c","__h","__v","vnode","y","current","context","g","__r","debounceRendering","some","__P","__n","ownerSVGElement","z","w","C","A","N","appendChild","nextSibling","insertBefore","$","setProperty","test","H","cssText","T","I","removeEventListener","removeAttribute","event","contextType","__E","render","O","sub","state","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","L","diffed","localName","nodeType","createTextNode","createElementNS","is","data","childNodes","dangerouslySetInnerHTML","attributes","__html","checked","unmount","componentWillUnmount","P","firstChild","S","q","B","Consumer","Provider","splice","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","__H","__V","__N","every","F","concat","V","clearTimeout","cancelAnimationFrame","requestAnimationFrame","createPreactParser","parser","pluginKey","pluginDefs","pluginComponents","cache","componentWrapper","componentWrappers","newPluginLoader","loadStatus","Component","renderReady","FinalComponent","LoadingComponent","LoadErrorComponent","main","trigger","setTrigger","asyncLoad","tooltip","help","win","open","write","preventDefault","contexts","_globals","dispatchGlobal","eventName","detail","listenToGlobal","initial","setValue","listenToEvent","menu","addOption","hold","latest","option","options","onEnter","onExit","setOption","callback","actualCallback","vDom","inject","preact","libraries","lzutf8","noRulesParser","customRules","parseNoMarkup","parseElem","elem","action","remove","defineFileComponent","currentScript","getAttribute","injectCompressedScript","compressedSequence","jsCode","compressor","decompress","inputEncoding","mathParser","mathMacros","labels","defaultLabel","zipped","label"],"sourceRoot":""}