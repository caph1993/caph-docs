{"version":3,"file":"caph-docs.min.js","mappings":"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","sources":["webpack://caph/./src/parser.js","webpack://caph/./src/utils.js","webpack://caph/webpack/bootstrap","webpack://caph/webpack/runtime/define property getters","webpack://caph/webpack/runtime/hasOwnProperty shorthand","webpack://caph/webpack/runtime/make namespace object","webpack://caph/./src/build-constants.js","webpack://caph/./src/script-loader.js","webpack://caph/./node_modules/.pnpm/preact@10.10.6/node_modules/preact/dist/preact.module.js","webpack://caph/./node_modules/.pnpm/preact@10.10.6/node_modules/preact/hooks/dist/hooks.module.js","webpack://caph/./src/preact-parser.js","webpack://caph/./src/preact-globals.js","webpack://caph/./src/main.js","webpack://caph/./src/index.js"],"sourcesContent":["//@ts-check\n/// <reference path=\"types.js\" />\nimport { isString, assert, assertNonNull } from \"./utils\";\n\n/** @typedef {({children, ...props})=>any} ComponentType*/\n/** @typedef {Object} AttributesType*/\n/** @typedef {string|ComponentType|null} TagType*/\n/**\n * @typedef {(type:any, props:any, ...children)=>(any extends Array? never: any)} CreateElementType\n*/\n/** @typedef {(text:string) => AstNode} RuleParser*/\n/** @typedef {{regStart:string, regEnd:string, parser:RuleParser}} CustomRule*/\n\n/**\n * @typedef {[null, null, AstNodeArray]|[string|ComponentType, AttributesType|null, AstNodeArray]} AstParent\n */\n/**\n * @typedef {string|AstParent} AstNode\n*/\n/** @typedef {AstNode[]} AstNodeArray*/\n\n\nconst ConsoleProxy = class{\n  log(...args){ console.log(...args);}\n  warn(...args){ this.warn(...args);}\n  error(...args){ this.error(...args);}\n}\n\n\n//https://stackoverflow.com/a/70329711\n\nexport const BaseParser = (class {\n\n  ESC = '\\ue000';\n  SPEC = `https://html.spec.whatwg.org/multipage/syntax.html`;\n  DEBUG = false;\n\n\n  static parseAst(/** @type {TemplateStringsArray} */{raw:strings}, ...values){\n    const cls = this;\n    return new cls(strings, values).root\n  }\n\n  /** @type {CustomRule[]} */\n  static customRules = [];\n\n  warn(...args){console.warn(...args)}; // Overriden during tests\n  error(...args){console.error(...args)}; // Overriden during tests\n\n\n  /**\n   * @param {readonly string[]} strings\n   * @param {0|1|2} debug\n  */\n  constructor(strings, values, debug=0){\n    /** @type {typeof BaseParser} */ //@ts-ignore\n    this.cls = this.constructor;\n    let str = strings.join(this.ESC);\n    let escaped = {};\n    let regEscaped = new RegExp(`${this.ESC}|\\\\\\\\\"|\\\\\\\\'|\\\\\\\\$\\\\\\\\$|\\\\\\\\$(?=[^\\\\\\\\$])`, 'g');\n    str = str.replace(regEscaped, (match, index)=>{\n      //console.log(`Escaping ${match} at ${index}`);\n      escaped[index] = match;\n      return this.ESC;\n    });\n    this.pos = 0;\n    this.str = str;\n    this.values = values;\n    this.valueIndex = 0;\n    this.escaped = escaped;\n    this.errorStop = false;\n    debug && console.log('PARSING', this.str);\n    this.DEBUG = debug==2;\n\n    /** @type {CustomRule[]} */\n    this.customRules = this.cls.customRules;\n    /** @type {(tag:TagType)=>(null|string[])} */\n    this.optionalClose = this.cls.optionalClose.bind(this.cls);\n\n    this.REG_EXP_TEXT = new RegExp(`.*?(?=${[\n      '$', '<', this.ESC,\n      ...this.customRules.map(({regStart})=>regStart),\n    ].join('|')})`, 'ys');\n\n    /**@type {AstParent} */\n    this.parent = [null, null, []];\n    /**@type {AstNode} */\n    this.root = this.parent;\n    this.parseRoot();\n  }\n  \n  parseRoot(){\n    try{\n      this.parseChildrenAndParentClose();\n      assert(this.parent===this.root);\n    } catch (error){\n      console.log(error);\n      if(error.name !== 'caph-parser-error') throw error;\n      if(this.pos==this.str.length && this.parent===this.root){\n        // Pass. Safe error: expected </> at end because we simulate a fragment root\n      } else{ this.error(error)}\n    }\n    if(this.parent===this.root && this.root[2].length == 1) this.root = this.root[2][0];\n  }\n\n  get parentTag(){ return this.parent[0]; }\n  get parentProps(){ return this.parent[1]; }\n  get children(){ return this.parent[2]; }\n\n\n  childlessTags = {\n    br:true, '!doctype': true, area: true, base: true, col: true, command: true, embed: true, hr: true,img: true, input: true,keygen: true, link: true, meta: true, param: true, source: true, track: true, wbr: true\n  };\n\n  // spacePreservingTags = {\n  //   pre: true, span: true, code: true, p: true, b: true, i: true,\n  //   a: true, li: true,\n  // };\n\n\n  // https://html.spec.whatwg.org/multipage/syntax.html#optional-tags\n  /** @type {{[key:string]:string[]}}*/\n  static _optionalClose = {\n    'li': ['li'],\n    'dt': ['dt', 'dd'],\n    'dd': ['dd', 'dt'],\n    'p': ['p', 'address', 'article', 'aside', 'blockquote', 'details', 'div', 'dl', 'fieldset', 'figcaption', 'figure', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'header', 'hgroup', 'hr', 'main', 'menu', 'nav', 'ol', 'pre', 'section', 'table'],\n    'rt': ['rt', 'rp'],\n    'rp': ['rp', 'rt'],\n    'optgroup': ['optgroup'],\n    'option': ['option', 'optgroup'],\n    //'caption': [], // Disabled rule\n    //'colgroup': [], // Disabled rule\n    'thead': ['tbody','tfoot'],\n    'tbody': ['tbody', 'tfoot'],\n    'tfoot': [],\n    'tr': ['tr'],\n    'td': ['td', 'th'],\n    'th': ['th', 'td'],\n  };\n\n  static optionalClose(/** @type {TagType}*/ tag){\n    if(!tag || !isString(tag)) return null;\n    return this._optionalClose[/** @type {string} tag */(tag)];\n  }\n\n  run(/** @type {RegExp}*/regExp){\n    // Execute the regular expression on str at pos, and move forward\n    const {pos, str} = this;\n    regExp.lastIndex = pos;\n    const match = regExp.exec(str);\n    if(!match) this.throw(`No match for ${regExp}`);\n    if(match.index<pos) throw `Regexp must use 'ys' flag. Match for at ${match.index} is before previous match at ${pos}`;\n    this.pos += match[0].length;\n    return match;\n  }\n\n  tryRun(/** @type {RegExp}*/regExp){\n    try{ return this.run(regExp); }\n    catch(e){ return null; }\n  }\n  tryRunUndo(/** @type {RegExp}*/regExp){\n    const pos = this.pos;\n    try{ return this.run(regExp); }\n    catch(e){ return null; }\n    finally{ this.pos = pos; }\n  }\n\n  debugPosition(delta=0, length=50){ // Just for printing debug info\n    const {pos, str} = this;\n    const at = Math.max(0, pos+delta);\n    const short = str.slice(at, at+length).replace('\\n', '(\\\\n)');\n    return `${at}...${short}...${at+length}`;\n  }\n\n  parseChildrenAndParentClose(){\n    /*\n      Parses the children of a parent tag or fragment.\n      Called (i) from the root level,\n      or (ii) after a parent \"head\" (`<div ...>`) has been consumed,\n      or (iii) after a sibling has been consumed entirely.\n     */\n    while(true){ // capture children until parent close tag is found or end is reached\n      this.DEBUG && console.log('parseSibling', this.parent, this.debugPosition());\n      // Parse text preceeding the first sibling\n      let [text] = this.run(this.REG_EXP_TEXT);\n      if(text.length) this.children.push(text);\n  \n      if(this.tryRun(new RegExp(`${this.ESC}`, 'ys'))){\n        let value = this.values[this.valueIndex++];\n        for(value of Array.isArray(value)?value:[value]){\n          if(value) this.children.push(['@injected', null, [value]]);\n        }\n        continue;\n      }\n\n      // Comment, DOCTYPE, or CDATA\n      if(this.str.startsWith('<!', this.pos)){\n        this.consumeComment();\n        continue;\n      }\n\n      let endReached = this.pos==this.str.length;\n      if(endReached && this.parentTag && !this.optionalClose(this.parentTag))\n          this.throw(`Expected closing tag </${this.parentTag}> or </>`);\n      if(endReached) break;\n      \n      if(this.customRules.length){\n        const parsedRule = (()=>{\n          for(let {regStart, regEnd, parser} of this.customRules){\n            let m = this.tryRun(new RegExp(`${regStart}(.*?)(${regEnd})`, 'ys'));\n            if(m) return parser(this.replaceText(m[1], this.pos-m[2].length-m[1].length));\n          }\n          return null;\n        })();\n        if(parsedRule){\n          this.children.push(parsedRule);\n          continue;\n        }\n      }\n\n      // Parent close\n      let /** @type {TagType} */ tag;\n      if(this.tryRun(/<\\/\\s*>/ys)) break;\n      if(this.tryRun(/<\\//ys)){\n        let result = this.tryRun(new RegExp(`([^>\\\\s]+)\\\\s*>`, 'ys'));\n        if(!result) this.throw(`Expected close tag for parent ${this.parentTag||'fragment'}`);\n        let _tag = result[1];\n        if (_tag==this.ESC) tag = this.values[this.valueIndex++];\n        else tag = _tag;\n        if(tag!==this.parentTag) this.throw(`Unmatched close tag ${tag}!=${this.parentTag}`);\n        break;\n      }\n\n      const optionalClose = this.optionalClose(this.parentTag);\n      if(optionalClose){\n        if((()=>{\n          for(let tag of optionalClose){\n            if(this.tryRunUndo(new RegExp(`<${tag}(>|\\\\s)`, 'ys'),)){\n              return true;\n            }\n          }\n        })()) break;\n      }\n\n      const /** @type {AstParent} */ newParent = [null, null, []];\n      this.children.push(newParent);\n\n      const grandParent = this.parent;\n      this.parent = newParent; // change parent temporarily\n      this.parseParent(grandParent); // this restores parent\n      \n      if(newParent[0] == null){ // shortcut fragment nieces as siblings\n        assert(this.children.pop() === newParent);\n        this.children.push(...newParent[2]);\n      }\n    }\n  }\n\n  parseParent(grandParent){\n    /*\n      Parses an element from the \"head\" opening (`<div ...>`)\n      until the \"tail\" close  (`</div>` or `</>`). \n      Called just at the beginning of the head opening.\n    */\n    this.DEBUG && console.log('parseParent ', this.parent, this.debugPosition());\n\n    let reg = new RegExp(`<([^\\\\s>\\\\/\\\\.]*)`, 'ys');\n    let _tag = this.run(reg)[1];\n    let /** @type {TagType} */ tag;\n    if (_tag==this.ESC){\n      tag = this.values[this.valueIndex++];\n      if(isString(tag)) this.throw(`Tag must be a component, not a string.`);\n    }\n    else if(!_tag.length) tag = null; //null means fragment\n    else if(_tag.match(/[^a-z0-9._-]/i)) this.throw(`Error with tag ${_tag}`);\n    else tag = _tag;\n    if (tag === undefined) this.throw(`Undefined component`);\n    \n    this.parent[0] = tag;\n    let admitsChildren = !this.childlessTags[(''+tag)?.toLowerCase()];\n    let /** @type {'jsx'|'tex'|'raw'|'pre'|null}*/ spacing=null;\n    \n    while(true){ // While attributes\n\n      this.run(/\\s*/ys); // Consume whitespace after `<div` or after attribute value\n      const endReached = this.pos==this.str.length;\n      if(endReached) this.throw(`Expected closing end ...> or .../> for tag ${tag}`);\n      \n      // Handle head close\n      if(this.tryRun(/\\/>/ys)){ admitsChildren = false; break; }\n      else if(this.tryRun(/>/ys)) break;\n\n      // Read next attribute\n      if(!this.parentProps) this.parent[1] = {};\n      if(this.tryRun(new RegExp(`\\\\.\\\\.\\\\.${this.ESC}`, 'ys'))){\n        this.parent[1] = {...this.parentProps, ...this.values[this.valueIndex++]};\n      }\n      else{\n        let [key] = this.run(/.*?(?=\\s|>|=)/ys);\n        let _value = this.tryRun(/=/ys) && this.run(new RegExp(`\\\\\".*?\\\\\"|\\\\'.*?\\\\'|${this.ESC}`, 'ys'))[0];\n        let value;\n        // .innerHTML may transform `<div attr >` into `< attr=\"\" >`\n        if(!_value || _value==\"''\"||_value=='\"\"') value = true; \n        else if(_value==this.ESC) value = this.values[this.valueIndex++];\n        else value = this.replaceText(_value.slice(1,-1), this.pos-_value.length+1); // slice for quotes\n        if(key.endsWith('-eval')){\n          key = key.slice(0,-5);\n          value = eval(value);\n        }\n        const prevValue = this.parentProps[key];\n        if(key=='class') value = !prevValue?value:prevValue+' '+value;\n        else if(key=='style') value = !prevValue?value:prevValue+' '+value;\n        else if(prevValue!==undefined) this.warn(`Replacing attribute ${key}.\\nPrevious and new values:`, prevValue, value);\n        \n        if(key.startsWith('(')){\n          if(key=='(component)') key = 'data-caph'; // ?? temporary code\n          else if(key=='(spacing)'){\n            if(!['jsx', 'pre', 'tex', 'raw'].includes(value)) this.throw(`Invalid spacing mode: ${value}`);\n            spacing = value;\n            continue;\n          } else this.throw(`Invalid attribute: ${key}`);\n        }\n        this.parentProps[key] = value;\n      }\n    }\n\n    if(admitsChildren){\n      if(tag=='style'){ // Style is closed differently\n        let m = this.tryRun(/(.*?)<\\/style\\s*>/ys);\n        if(!m) this.throw(`Style tag not closed properly.`);\n        this.parent[2] = [m[1]];\n      } else if(tag=='script'){ // Script is closed differently\n        let m = this.tryRun(/(.*?)<\\/script\\s*>/ys);\n        if(!m) this.throw(`Script tag not closed properly.`);\n        let code = m[1];\n        if(code.match(/^\\s*(String\\.raw)?\\`(.*)\\`\\s*$/ys)){\n          code = eval(code);\n          code = this.cls.htmlSafe(code);\n          this.parent[0] = 'div';\n          this.parent[1] = {'data-caph':'@code', ...this.parentProps};\n          this.parent[2] = [code];\n        } else{\n          this.parent[2] = [code];\n        }\n      } else{\n        this.parseChildrenAndParentClose(); // (Huge step)\n        if(!spacing){\n          if(!isString(tag)) spacing = 'jsx';\n          else if(tag=='pre' || tag=='textarea') spacing = 'pre';\n          else spacing = 'jsx';\n        }\n        if(spacing=='jsx') this.parent[2] = this.cls.spacingRulesJsx(this.children);\n        else if(spacing=='tex') this.parent[2] = this.cls.spacingRulesParagraphs(this.children);\n      }\n    }\n    this.parent = grandParent;\n  }\n\n  static spacingRulesJsx(children){ // JSX spacing\n    // https://reactjs.org/blog/2014/02/20/react-v0.9.html#jsx-whitespace\n    // https://www.w3.org/TR/REC-html40/struct/text.html#h-9.1\n    // https://stackoverflow.com/q/433493\n    \n    function trimText(text){\n      // End spaces are preserved only if they are inline\n      return text.replace(/^(\\s*)(.*?)(\\s*)$/s, (_, l, middle, r)=>{\n        if(l.includes('\\n')) l='';\n        if(r.includes('\\n')) r='';\n        return `${l}${middle}${r}`\n      });\n    }\n    const ESC = '\\ue000';\n    const stack = children.filter(x=>!isString(x)).reverse();\n    const text = children.map(x=>isString(x)?x:ESC).join('');\n    const newChildren = [];\n    text.split(ESC).forEach((str, i)=>{\n      if(i) newChildren.push(stack.pop());\n      if(str.length) str = trimText(str);\n      if(str.length) newChildren.push(str);\n    })\n    assert(stack.length==0);\n    return newChildren;\n  }\n\n  // https://html.spec.whatwg.org/multipage/syntax.html#element-restrictions\n  static spacingRulesPre(children){\n    const first = children[0];\n    if(isString(first) && first.startsWith('\\n')) children[0] = children[0].slice(1);\n    return children;\n  }\n\n  static spacingRulesParagraphs(children){\n    const ESC = '\\ue000';\n    const stack = children.filter(x=>!isString(x)).reverse();\n    const text = children.map(x=>isString(x)?x:ESC).join('');\n    /** @type {AstNode[]}*/\n    const newChildren = text.split(/\\s*?\\n\\s*?\\n\\s*/s).map(text=>{\n      const elems = [];\n      text.split(ESC).forEach((str, i)=>{\n        if(i) elems.push(stack.pop());\n        if(str.length) elems.push(str);\n      })\n      return ['div', {'class':\"caph-paragraph\"}, elems];\n    });\n    assert(stack.length==0);\n    return newChildren;\n  }\n\n  /** @type {(reason:string)=>never}*/\n  throw(reason){\n    const error = new Error(`${reason}\n      Ignoring what follows.\n      Error occurred here:\n      ${this.debugPosition(-5)}\n    `);\n    error.name = 'caph-parser-error';\n    throw error;\n  }\n\n  consumeComment(){\n    const regComment = new RegExp(\n      [`<!--.*?-->`, `<!\\\\[CDATA\\\\[.*?\\\\]\\\\]>`, `<!DOCTYPE\\\\s*.*?>`,].join('|'),\n      'iys',\n    );\n    let result = this.tryRun(regComment);\n    if(!result) this.throw(`Unexpected <!`);\n    let [text] = result;\n    if(text.endsWith('/>')) this.warn(`Non compliant tag found.\\n${this.SPEC}`);\n    this.replaceText(text, this.pos-text.length); // Consume the fields inside, if any\n  }\n\n  /**\n   * @param {string} text\n   * @param {number} posOfText\n   * @returns {string}*/\n  replaceText(text, posOfText){\n    return text.replace(new RegExp(this.ESC, 'g'), (_, index)=>{\n      assert(this.str[posOfText+index] === this.ESC);\n      const original = this.escaped[posOfText+index];\n      if (original != this.ESC) return original;\n      return this.values[this.valueIndex++];\n    });\n  }\n\n\n  static htmlSafe(str) {\n    // e.g. converts < into &lt;\n    return new Option(str).innerHTML;\n  }\n\n  static htmlSafeUndo = (str)=>{\n    // e.g. converts &lt; into <, etc. Prevents left trim caused by DOMParser\n    const [, l, content] = assertNonNull(str.match(/^(\\s*)(.*)$/s));\n    const doc = new DOMParser().parseFromString(content, \"text/html\");\n    const text = l+(doc.documentElement.textContent || '');\n    // if(str!=text) console.log(`Converted ${str} into ${text}`)\n    return text;\n  }\n  static parseAstHtml(/** @type {string}*/str){\n    const astUndoHtml = (/** @type {AstNode}*/ root) => {\n      if (isString(root)) return this.htmlSafeUndo(root);\n      if (!Array.isArray(root)) return root;\n      //@ts-ignore\n      root[2] = root[2].map(child => astUndoHtml(child));\n      return root;\n    }\n    // Parse html, undoing html safe conversions, and then create element\n    /** @type {TemplateStringsArray}*/ //@ts-ignore\n    let tmp = {raw:[str]};\n    let root = this.parseAst(tmp);\n    return astUndoHtml(root);\n  }\n\n  /**\n   * @param {null|{createElement:CreateElementType, FragmentComponent:ComponentType}} post\n  */\n  static evalAstFactory(post=null){\n    const {createElement, FragmentComponent} = post||{\n      createElement: (type, props, ...children)=> (!type||isString(type))?\n        {tag:type, props, children} : type({children, ...props}),\n      FragmentComponent: ({children})=>({tag:null, props:null, children}),\n    };\n\n    const createTree = (/** @type {AstNode}*/ root) => {\n      if (!Array.isArray(root)) return root;\n      let [tag, props, children] = root;\n      if(tag=='@injected') return root[2][0];\n      assert(Array.isArray(children));\n      children = children.map(child =>createTree(child));\n      if(tag==null){\n        assert(props==null);\n        tag = FragmentComponent;\n      }\n      return createElement(tag, props, ...children);\n    }\n    return createTree;\n  }\n\n  static parserFactory(evalAst){\n    const cls = this;\n    return (/** @type {TemplateStringsArray} */ strings, ...values)=>(\n      evalAst(cls.parseAst(strings, ...values))\n    );\n  }\n\n  /**\n   * @param {null|{createElement:CreateElementType, FragmentComponent:ComponentType}} post\n  */\n  static debugParserFactory(post=null){\n    const cls = this;\n    const evalAst = cls.evalAstFactory(post);\n    const parse = cls.parserFactory(evalAst);\n    const parse1 = ({raw:strings}, ...values)=>evalAst(new cls(strings, values, 1).root);\n    const parse2 = ({raw:strings}, ...values)=>evalAst(new cls(strings, values, 2).root);\n    const parseAst1 = ({raw:strings}, ...values)=> new cls(strings, values, 1).root;\n    const parseAst2 = ({raw:strings}, ...values)=> new cls(strings, values, 2).root;\n    return {parse, parse1, parse2, parseAst1, parseAst2, evalAst};\n  }\n\n\n  // asString(obj) {\n  //   let out = `${obj}`;\n  //   if (out == \"[object Object]\") {\n  //     // let seen = [];\n  //     // out = JSON.stringify(obj, function (key, val) {\n  //     //   if (val != null && typeof val == \"object\") {\n  //     //     if (seen.indexOf(val) >= 0) return;\n  //     //     seen.push(val);\n  //     //   }\n  //     //   return val; // https://stackoverflow.com/q/9382167\n  //     // });\n  //     out = obj; //PROBLEM\n  //   }\n  //   return out;\n  // }\n\n});\n\nexport const NewParser = class extends BaseParser {\n\n  static customRules = [\n    ...super.customRules,\n    {\n      regStart: `(?<!\\\\\\\\)\\\\$\\\\$`,\n      regEnd: `(?<!\\\\\\\\)\\\\$\\\\$`,\n      parser: /**@type {RuleParser}*/ ((text)=>['div', {'data-caph': '@math', displayMode:true}, [text]]),\n    },\n    {\n      regStart: `(?<!\\\\\\\\)\\\\$`,\n      regEnd: `(?<!\\\\\\\\)\\\\$`,\n      parser: /**@type {RuleParser}*/ ((text)=>['div', {'data-caph': '@math', displayMode:false}, [text]]),\n      inline: true,\n    },\n    {\n      regStart: `(?<!\\\\\\\\)\\`\\`\\``,\n      regEnd: `(?<!\\\\\\\\)\\`\\`\\``,\n      parser: /**@type {RuleParser}*/ ((text)=>{\n        text = text.replace(/\\\\\\`\\`\\`/g, '```');\n        let progLang = assertNonNull(text.match(/^[^\\n]*/));\n        return ['div', {'data-caph': '@code', ...(!progLang.length?{}:{progLang})}, [text]];\n      }),\n    },\n    {\n      regStart: `(?<!\\\\\\\\)\\``,\n      regEnd: `(?<!\\\\\\\\)\\``,\n      parser: /**@type {RuleParser}*/ ((text)=>{\n        text = text.replace(/\\\\\\`/g, '`');\n        return ['div', {'data-caph': '@code'}, [text]]\n      }),\n      inline: true,\n    },\n  ];\n\n}\n","//@ts-check\n\n/** https://github.com/Microsoft/TypeScript/issues/23405#issuecomment-873331031 */\n/** @template T  @param {T} value @param {string} [valueName] @returns {T extends undefined ? never : T} */\nexport function assertDefined(value, valueName) {\n  if (value === undefined) {\n    throw new Error(`Encountered unexpected undefined value${valueName? ` for '${valueName}'` : \"\"}`);\n  }\n  return /** @type {*} */ (value);\n}\n\n/** @template T @param {T} value @returns {T extends null ? never : T} */\nexport function assertNonNull(value) {\n  if (!value && (value===null||value === undefined)) throw new Error(`Encountered unexpected undefined value`);\n  //@ts-ignore\n  return value;\n}\n\n\n/** @type {(obj: any) => obj is String} */\nexport function isString(obj) {\n  return Object.prototype.toString.call(obj) === \"[object String]\";\n}\n\n// utils = {\n//   unindent: (text) => {\n//     let lines = text.split('\\n');\n//     let n = lines.filter(l => l.trim().length)\n//       .map(l => l.length - l.trimStart().length)\n//       .reduce((p, c) => Math.min(c, p), 1000);\n//     return lines.map(l => l.slice(n)).join('\\n');\n//   }\n// };\n// _URL_resolve(url) {\n//   return new URL(url, document.baseURI).href;\n// }\n// // _URL_is_absolute(url) {\n// //   //https://stackoverflow.com/q/10687099\n// //   return new URL(document.baseURI).origin !== new URL(url, document.baseURI).origin;\n// // }\n\n// _html_safe(str) {\n//   // e.g. converts < into &lt;\n//   return new Option(str).innerHTML;\n// }\n// _html_safe_undo(str) {\n//   // e.g. converts &lt; into <\n//   const doc = new DOMParser().parseFromString(str, \"text/html\");\n//   const text = doc.documentElement.textContent;\n//   return text;\n// }\n\n\nexport function assert(/** @type {boolean|any}*/condition, ...messages) {\n  if (condition) return;\n  throw new Error(...messages);\n}\n\nexport function sleep(/** @type {number}*/ms) {\n  return new Promise((ok, err) => setTimeout(ok, ms));\n}\n\nclass MyBoolean {\n  static assert(condition, ...messages) {\n    if (condition) return;\n    throw new Error(...messages);\n  }\n  static all(arr) {\n    for (let x of arr) if (!x) return false;\n    return true;\n  }\n  static any(arr) {\n    for (let x of arr) if (x) return true;\n    return false;\n  }\n  static assert_all(arr, ...messages) { assert(this.all(arr), ...messages); }\n  static assert_any(arr, ...messages) { assert(this.any(arr), ...messages); }\n}\n\n\nclass MyArray {\n  static any(arr) {\n    for (let x of arr) if (x) return true;\n    return false;\n  }\n  static all(arr) {\n    for (let x of arr) if (!x) return false;\n    return true;\n  }\n  static sum(arr) {\n    return arr.reduce((p, c) => p + c, 0);\n  }\n  static max(arr, initialValue) {\n    initialValue = initialValue || 0;\n    return arr.reduce((p, c) => Math.max(p, c), initialValue);\n  }\n  static min(arr, initialValue) {\n    initialValue = initialValue || 1e10;\n    return arr.reduce((p, c) => Math.min(p, c), initialValue);\n  }\n  static zeros(n) {\n    const l = [];\n    for (let i = 0; i < n; i++)l.push(0);\n    return l;\n  }\n  static arange(n) {\n    return MyArray.zeros(n).map((z, i) => i);\n  }\n  static sEquality(a, b) {\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length !== b.length) return false;\n    for (let i = 0; i < a.length; ++i) if (a[i] != b[i]) return false;\n    return true;\n  }\n  static hEquality(a, b) {\n    if (a === b) return true;\n    if (a == null || b == null) return false;\n    if (a.length !== b.length) return false;\n    for (let i = 0; i < a.length; ++i) if (a[i] !== b[i]) return false;\n    return true;\n  }\n}\n\nexport class MyPromise {\n  static async sleep(ms) {\n    await new Promise((ok, err) => setTimeout(ok, ms));\n  }\n  static async finish_all(promises, { debug = false } = {}) {\n    // Ensures completion of all promises even if some throw exceptions\n    return await new Promise((ok, err) => {\n      if (promises.length == 0) return ok([]);\n      let any_error = false;\n      let cnt = 0;\n      let outs = promises.map((p) => null);\n      Promise.all(promises.map(async (p, i) => {\n        try { outs[i] = await p; }\n        catch (e) {\n          any_error = true; outs[i] = e;\n          if (debug) console.error(...e);\n        }\n        cnt++;\n        if (cnt == promises.length) {\n          if (any_error) err(outs);\n          else ok(outs);\n        }\n      }));\n    });\n  }\n  static async finish_all_log(promises) {\n    try { var outs = await MyPromise.finish_all(promises); }\n    catch (err) {\n      var outs = err; console.error(...err);\n      err.forEach(e => console.warn(...e));\n    }\n    return outs;\n  }\n\n  static async until(/** @type {()=>any}*/ func, { ms = 200, timeout = 0 } = {}) {\n    if (timeout && ms > timeout) ms = timeout / 10;\n    let t0 = (new Date()).getTime();\n    let value;\n    while (!(value = await func())) {\n      if (timeout && (new Date()).getTime()-t0 > timeout)\n        throw MyPromise.Timeout;\n      await sleep(ms);\n    }\n    return value;\n  }\n  static Timeout = new Error('Timeout');\n  static async timeout(promise, ms) {\n    let finished = false;\n    let [resp, _] = await Promise.all([\n      promise.then(e => { finished = true; return e; }),\n      MyPromise.until(() => finished, { timeout: ms })\n    ]);\n    return resp;\n  }\n}\nexport const until=MyPromise.until;\n\n\nexport class MyDocument {\n\n  /**\n   * @param {string} tag \n   * @param {{\n   *  style?: {[key: string]: string},\n   *  id?: string,\n   * classList?: string[],\n   * text?: string,\n   * html?: string,\n   * eventListeners?: {[key: string]: (e: Event) => void},\n   * parent?: HTMLElement,\n   * where?: 'beforebegin' | 'afterbegin' | 'beforeend' | 'afterend',\n   * }} options\n   * @returns {HTMLElement}\n   */\n  static createElement(tag, {\n    style = {}, id, classList = [], text, html,\n    eventListeners = {}, parent, where, ...attrs } = {}) {\n    let e = document.createElement(tag);\n    if(id!==undefined) e.setAttribute(\"id\", id);\n    classList.forEach(s => e.classList.add(s));\n    if (text !==undefined) e.innerText = text;\n    if (html !==undefined) e.innerHTML = html;\n    if (id !==undefined) e.id = id;\n    MyObject.forEach(attrs, (value, key) => e.setAttribute(key, value));\n    MyObject.forEach(style, (value, key) => e.style[key] = value);\n    MyObject.forEach(eventListeners, (value, key) =>\n      e.addEventListener(key, value));\n    if (parent || where) {\n      parent = parent || document.body;\n      where = where || 'beforeend';\n      parent.insertAdjacentElement(where, e);\n    }\n    return e;\n  }\n  static right_click(element) {\n    element.focus();\n    if (window.CustomEvent) {\n      element.dispatchEvent(new CustomEvent('contextmenu'));\n    } else if (document.createEvent) {\n      var ev = document.createEvent('HTMLEvents');\n      ev.initEvent('contextmenu', true, false);\n      element.dispatchEvent(ev);\n    } else { // Internet Explorer\n      element.fireEvent('oncontextmenu');\n    }\n    // return;\n    // element.focus();\n    // let e = element.ownerDocument.createEvent('MouseEvents');\n    // e.initMouseEvent('contextmenu', true, true,\n    //   element.ownerDocument.defaultView, 1, 0, 0, 0, 0, false,\n    //   false, false, false, 2, null);\n    // return !element.dispatchEvent(e);\n  }\n}\n\nclass MyObject {\n\n  static indexBy(arr, key) {\n    let M = {};\n    arr.forEach((obj) => {\n      let value = obj[key];\n      M[value] = obj;\n    });\n    return M;\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static map(obj, func) {\n    return MyObject._object_op('map', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(boolean|any))} func */\n  /** @returns {Object} */\n  static filter(obj, func) {\n    return MyObject._object_op('filter', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static apply(obj, func) {\n    return MyObject._object_op('apply', obj, func);\n  }\n\n  /** @param {Object} obj */\n  /** @param {((value:any, key?:any, obj?:any)=>(any))} func */\n  static forEach(obj, func) {\n    return MyObject._object_op('forEach', obj, func);\n  }\n\n  /** @param {Object} src */\n  /** @param {'apply'|'filter'|'forEach'|'map'} op*/\n  static _object_op(op, src, func) {\n    assert(1 <= func.length && func.length <= 3);\n    let dest = {};\n    for (let key of Object.keys(src)) {\n      let value = src[key]\n      let result = MyObject._func(func, value, key, src);\n      if (op == 'map') dest[key] = result;\n      else if (op == 'filter') { if (result) dest[key] = value; }\n      else if (op == 'apply') src[key] = result;\n      else if (op == 'forEach') 1 == 1;\n    }\n    return (op == 'map' || op == 'filter') ? dest : null;\n  }\n\n  static _func(func, value, key, src) {\n    return (\n      func.length == 1 ? func(value)\n        : func.length == 2 ? func(value, key)\n          : func(value, key, src)\n    );\n  }\n\n  static reduce_dots(obj) {\n    // converts {'a.b':1, 'a.c':2, b:3} into {a:{b:1,c:2}, 'b':3}. Returns copy (shallow or deep)\n    let dotted = MyObject.filter(obj, (v, k) => k.indexOf('.') >= 0);\n    let no_dots = MyObject.filter(obj, (v, k) => k.indexOf('.') == -1);\n    if (Object.keys(dotted).length == 0) return no_dots;\n    MyObject.forEach(dotted, (v, k) => {\n      let start = k.slice(0, k.indexOf('.'));\n      let end = k.slice(k.indexOf('.') + 1);\n      no_dots[start] = no_dots[start] || {};\n      no_dots[start][end] = v;\n    });\n    return MyObject.reduce_dots(no_dots);\n  }\n\n  static deep_assign(obj, ...objs) {\n    for (let o of objs) {\n      if (!o) continue;\n      for (let key of Object.keys(o)) {\n        if (obj[key] === undefined || typeof (o[key]) != \"object\") obj[key] = o[key];\n        else MyObject.deep_assign(obj[key], o[key]);\n      }\n    }\n    return obj;\n  }\n\n  static deep_copy(obj, ...objs) {\n    if (obj === undefined) return undefined;\n    if (obj === null) return null;\n    if (Array.isArray(obj))\n      return obj.map(x => MyObject.deep_copy(x));\n    if (typeof (obj) == \"object\")\n      return MyObject.map(obj, value => MyObject.deep_copy(value));\n    if (typeof (obj) == \"function\")\n      return obj; // DOES NOT CREATE COPY FOR FUNCTIONS\n    return MyObject.deep_assign(obj, ...objs);\n  }\n\n  static deep_default(default_obj, ...objs) {\n    let obj = MyObject.deep_copy(default_obj);\n    return MyObject.deep_assign(obj, ...objs);\n  }\n\n  /** @param {((value:any, key?:any, obj?:any)=>(boolean|any))} filter_func */\n  static find(obj, filter_func) {\n    for (let key in obj)\n      if (MyObject._func(filter_func, obj[key], key))\n        return key;\n    return null;\n  }\n  static toEntries(obj) {\n    return Object.keys(obj).map(k => [k, obj[k]]);\n  }\n}\n\n\nclass MyDecorators {\n  static once(fn) {\n    let returnValue, canRun = true;\n    return function runOnce() {\n      if (canRun) {\n        returnValue = fn.apply(this, arguments);\n        canRun = false;\n      }\n      return returnValue;\n    }\n  }\n}\n\n\nfunction get_property_handler(object, property) {\n  let access, proto = object;\n  object._hidden_modified = false;\n  while (!access) {\n    proto = Object.getPrototypeOf(proto);\n    access = Object.getOwnPropertyDescriptor(proto, property);\n  }\n  return access;\n}\n\nfunction update_property_handler(object, property, create_handler) {\n  let prev = get_property_handler(object, property);\n  Object.defineProperty(object, property, create_handler(prev));\n}\n\n\nexport const Queue = class {\n\n  constructor(arr) {\n    this.data = [...(arr || [])];\n    this.lr = [0, this.data.length];\n  }\n  get capacity() {\n    return this.data.length;\n  }\n  get length() {\n    const [i, j] = this.lr;\n    return j >= i ? j - i : this.capacity - i + j;\n  }\n  toArray() {\n    const [i, j] = this.lr;\n    if (j >= i) return this.data.slice(i, j);\n    else return this.data.slice(i).concat(this.data.slice(0, j));\n  }\n  [Symbol.iterator]() {\n    let index = -1;\n    // copy because I would need to update the pointer during resizing. Could be done.\n    let data = [...this.toArray()];\n    return {\n      next: () => ({\n        value: data[++index],\n        done: !(index in data)\n      })\n    };\n  };\n  resize(newLength) {\n    if (newLength === undefined) {\n      if (this.length + 1 >= this.capacity)\n        return this.resize(1 + 3 * this.length);\n      if (this.length <= this.capacity >> 2)\n        return this.resize(this.capacity >> 1);\n      return;\n    }\n    const arr = this.toArray()\n    this.data = [...arr, ...new Array(newLength - arr.length).fill(null)];\n    this.lr = [0, arr.length];\n  }\n  _mod_add(lrIndex, retK, afterK) {\n    const mod = this.capacity;\n    const add = (i, k) => ((i % mod) + k + mod) % mod;\n    const out = add(this.lr[lrIndex], retK);\n    this.lr[lrIndex] = add(this.lr[lrIndex], afterK);\n    return out;\n  }\n  pushRight(x) {\n    this.resize();\n    this.data[this._mod_add(1, 0, +1)] = x;\n  }\n  pushLeft(x) {\n    this.resize();\n    this.data[this._mod_add(0, -1, -1)] = x;\n  }\n  popRight() {\n    this.resize();\n    return this.data[this._mod_add(1, -1, -1)];\n  }\n  popLeft() {\n    this.resize();\n    return this.data[this._mod_add(0, 0, +1)];\n  }\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","//@ts-check\n\n\nconst compressed = [];\nexport const distPlugins = [\n  'core-menu',\n  'core-about',\n  'katex',\n  'codemirror',\n  // 'fabric.lz.js',\n  // 'mathjax-svg',\n  // // 'gtag',\n  // 'document',\n  // 'slides',\n  // 'whiteboard',\n  // //'figure-editor',\n  // 'hyphenator',\n  // 'auto-scroll',\n].map(name=>({\n  key:`@${name}`,\n  dist: `@dist/components/${name}${compressed.includes(name)?'.lz':''}.js`,\n  src: `plugins/${name}/plugin-${name}.js`,\n}));\n\nexport const compressor = {\n  dist: '@dist/lzutf8.min.js',\n  src: 'libraries/lzutf8-0.6.3/lzutf8.min.js',\n};\n\n/**@param {any} compressor @param {string} text @returns {string}*/\nexport const compress = (compressor, text)=> compressor.compress(text, {outputEncoding: 'Base64'});\n\n/**@param {any} compressor @param {string} text @returns {string}*/\nexport const decompress = (compressor, text)=> compressor.decompress(text, {inputEncoding: 'Base64'});\n\n","//@ts-check\nimport { MyDocument, sleep, until } from \"./utils\";\nimport {compressor, decompress, distPlugins} from \"./build-constants\";\n\n\nconst plugins = Object.fromEntries(distPlugins.map(e => [e.key, e]));\n\nexport const scriptLoader = (()=>{\n\n  let dist = './dist';\n  for (const e of document.querySelectorAll('script')) {\n    const m = e.src.match(/^(.*)\\/caph-docs\\.(?:min\\.)?js$/)\n    if (m) dist = m[1];\n  }\n  //console.log(dist);\n\n  const div = document.getElementById('core-sources') || MyDocument.createElement('div', {\n    id: 'core-sources',\n    parent: document.head,\n    where: 'beforeend',\n  });\n\n\n  const _randomSessionSuffix = ('' + Math.random()).slice(2);\n  const parseKey = (/** @type {string} */ key)=>{\n    // key is like either 'userComponent', './userFileComponent', '@caphPlugin', '@dist/caphPlugin', 'full URL'\n    let url = key.replace(/^@dist\\/(.*)$/, (_, p)=>`${dist}/${p}`);\n    if(url.startsWith('./')) url += `?${_randomSessionSuffix}`;\n    url = new URL(url, document.baseURI).href;\n    /** @type {string|null} */\n    let proxyKey = null;\n    if(plugins[key]) ({dist:proxyKey} = plugins[key]);\n    return {url, proxyKey};\n  }\n\n  /**\n   * @param {string} ref \n   * @param {{\n   * parent?: HTMLElement|null,\n   * where?: 'beforebegin' | 'afterbegin' | 'beforeend' | 'afterend',\n   * attrs?: {[key:string]:string},\n   * autoAttrs?: boolean,\n   * isCompressed?: boolean|null,\n   * msTimeout?: number,\n   * }} options\n   */\n  const load = (ref, { attrs={}, parent=null, where='beforeend', autoAttrs=true} = {})=>{\n    ({url:ref} = parseKey(ref)); // especially for plugin loading libraries\n    const refBase = ref.split('#')[0].split('?')[0]\n    if (parent == null) parent = div;\n    const ext = refBase.split('.').pop();\n    let tag = ext == 'js' ? 'script' : ext == 'css' ? 'link' : null;\n    if (tag == null) throw new Error('Only .js and .css files can be _sources. Got: ' + ext + ' ' + ref);\n    let /** @type {{[key:string]:string}}*/ defaults = {};\n    if (autoAttrs && tag == 'link') defaults = { rel: 'stylesheet', type: 'text/css' };\n    Object.keys(attrs).forEach(k => defaults[k] = attrs[k]);\n    attrs = defaults;\n    if (tag == 'script') attrs.src = ref;\n    if (tag == 'link') attrs.href = ref;\n    _load_elem(ref, tag, attrs, parent, where);\n  }\n\n  // const loadFont = async(/** @type {string}*/name)=>{\n  //   return await load(`${dist}/font-${name}.css`);\n  // }\n  // async loadPlugin(name) {\n  //   return await this.load(`${dist}/plugin-${name}.js`);\n  // }\n\n  const status = {};\n\n  const _load_elem = (ref, tag, attrs, parent, where) => new Promise((_ok, _err) => {\n    if (status[ref]) return _ok(null); \n    status[ref] = true;\n    let e = document.createElement(tag);\n    for(let key in attrs) e.setAttribute(key, attrs[key]);\n    let done = false;\n    e.onload = () => { if (!done) { done = true; _ok(null); } };\n    e.onerror = (err) => { if (!done) { done = true; _err(err); } }; // HTTP errors only\n    parent.insertAdjacentElement(where, e);\n  });\n\n  const injectStyle = (/** @type {string} */ styleStr)=>{\n    MyDocument.createElement('style', { parent: div, where: 'beforeend', text: styleStr });\n  }\n  return {injectStyle, load, div, dist, parseKey};\n})();\n\nexport const parseKey = scriptLoader.parseKey;\nexport const injectStyle = scriptLoader.injectStyle;\nexport const load = scriptLoader.load;\n","var n,l,u,i,t,o,r,f={},e=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function s(n,l){for(var u in l)n[u]=l[u];return n}function a(n){var l=n.parentNode;l&&l.removeChild(n)}function h(l,u,i){var t,o,r,f={};for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return v(l,f,t,o,null)}function v(n,i,t,o,r){var f={type:n,props:i,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++u:r};return null==r&&null!=l.vnode&&l.vnode(f),f}function y(){return{current:null}}function p(n){return n.children}function d(n,l){this.props=n,this.context=l}function _(n,l){if(null==l)return n.__?_(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?_(n):null}function k(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k(n)}}function b(n){(!n.__d&&(n.__d=!0)&&t.push(n)&&!g.__r++||o!==l.debounceRendering)&&((o=l.debounceRendering)||setTimeout)(g)}function g(){for(var n;g.__r=t.length;)n=t.sort(function(n,l){return n.__v.__b-l.__v.__b}),t=[],n.some(function(n){var l,u,i,t,o,r;n.__d&&(o=(t=(l=n).__v).__e,(r=l.__P)&&(u=[],(i=s({},t)).__v=t.__v+1,j(r,t,i,l.__n,void 0!==r.ownerSVGElement,null!=t.__h?[o]:null,u,null==o?_(t):o,t.__h),z(u,t),t.__e!=o&&k(t)))})}function w(n,l,u,i,t,o,r,c,s,a){var h,y,d,k,b,g,w,x=i&&i.__k||e,C=x.length;for(u.__k=[],h=0;h<l.length;h++)if(null!=(k=u.__k[h]=null==(k=l[h])||\"boolean\"==typeof k?null:\"string\"==typeof k||\"number\"==typeof k||\"bigint\"==typeof k?v(null,k,null,null,k):Array.isArray(k)?v(p,{children:k},null,null,null):k.__b>0?v(k.type,k.props,k.key,null,k.__v):k)){if(k.__=u,k.__b=u.__b+1,null===(d=x[h])||d&&k.key==d.key&&k.type===d.type)x[h]=void 0;else for(y=0;y<C;y++){if((d=x[y])&&k.key==d.key&&k.type===d.type){x[y]=void 0;break}d=null}j(n,k,d=d||f,t,o,r,c,s,a),b=k.__e,(y=k.ref)&&d.ref!=y&&(w||(w=[]),d.ref&&w.push(d.ref,null,k),w.push(y,k.__c||b,k)),null!=b?(null==g&&(g=b),\"function\"==typeof k.type&&k.__k===d.__k?k.__d=s=m(k,s,n):s=A(n,k,d,x,b,s),\"function\"==typeof u.type&&(u.__d=s)):s&&d.__e==s&&s.parentNode!=n&&(s=_(d))}for(u.__e=g,h=C;h--;)null!=x[h]&&(\"function\"==typeof u.type&&null!=x[h].__e&&x[h].__e==u.__d&&(u.__d=_(i,h+1)),N(x[h],x[h]));if(w)for(h=0;h<w.length;h++)M(w[h],w[++h],w[++h])}function m(n,l,u){for(var i,t=n.__k,o=0;t&&o<t.length;o++)(i=t[o])&&(i.__=n,l=\"function\"==typeof i.type?m(i,l,u):A(u,i,i,t,i.__e,l));return l}function x(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(Array.isArray(n)?n.some(function(n){x(n,l)}):l.push(n)),l}function A(n,l,u,i,t,o){var r,f,e;if(void 0!==l.__d)r=l.__d,l.__d=void 0;else if(null==u||t!=o||null==t.parentNode)n:if(null==o||o.parentNode!==n)n.appendChild(t),r=null;else{for(f=o,e=0;(f=f.nextSibling)&&e<i.length;e+=2)if(f==t)break n;n.insertBefore(t,o),r=o}return void 0!==r?r:t.nextSibling}function C(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||H(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||H(n,o,l[o],u[o],i)}function $(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=null==u?\"\":\"number\"!=typeof u||c.test(l)?u:u+\"px\"}function H(n,l,u,i,t){var o;n:if(\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof i&&(n.style.cssText=i=\"\"),i)for(l in i)u&&l in u||$(n.style,l,\"\");if(u)for(l in u)i&&u[l]===i[l]||$(n.style,l,u[l])}else if(\"o\"===l[0]&&\"n\"===l[1])o=l!==(l=l.replace(/Capture$/,\"\")),l=l.toLowerCase()in n?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?i||n.addEventListener(l,o?T:I,o):n.removeEventListener(l,o?T:I,o);else if(\"dangerouslySetInnerHTML\"!==l){if(t)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"href\"!==l&&\"list\"!==l&&\"form\"!==l&&\"tabIndex\"!==l&&\"download\"!==l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null!=u&&(!1!==u||\"a\"===l[0]&&\"r\"===l[1])?n.setAttribute(l,u):n.removeAttribute(l))}}function I(n){this.l[n.type+!1](l.event?l.event(n):n)}function T(n){this.l[n.type+!0](l.event?l.event(n):n)}function j(n,u,i,t,o,r,f,e,c){var a,h,v,y,_,k,b,g,m,x,A,C,$,H=u.type;if(void 0!==u.constructor)return null;null!=i.__h&&(c=i.__h,e=u.__e=i.__e,u.__h=null,r=[e]),(a=l.__b)&&a(u);try{n:if(\"function\"==typeof H){if(g=u.props,m=(a=H.contextType)&&t[a.__c],x=a?m?m.props.value:a.__:t,i.__c?b=(h=u.__c=i.__c).__=h.__E:(\"prototype\"in H&&H.prototype.render?u.__c=h=new H(g,x):(u.__c=h=new d(g,x),h.constructor=H,h.render=O),m&&m.sub(h),h.props=g,h.state||(h.state={}),h.context=x,h.__n=t,v=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=H.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=s({},h.__s)),s(h.__s,H.getDerivedStateFromProps(g,h.__s))),y=h.props,_=h.state,v)null==H.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==H.getDerivedStateFromProps&&g!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(g,x),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(g,h.__s,x)||u.__v===i.__v){h.props=g,h.state=h.__s,u.__v!==i.__v&&(h.__d=!1),h.__v=u,u.__e=i.__e,u.__k=i.__k,u.__k.forEach(function(n){n&&(n.__=u)}),h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(g,h.__s,x),null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,_,k)})}if(h.context=x,h.props=g,h.__v=u,h.__P=n,A=l.__r,C=0,\"prototype\"in H&&H.prototype.render)h.state=h.__s,h.__d=!1,A&&A(u),a=h.render(h.props,h.state,h.context);else do{h.__d=!1,A&&A(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++C<25);h.state=h.__s,null!=h.getChildContext&&(t=s(s({},t),h.getChildContext())),v||null==h.getSnapshotBeforeUpdate||(k=h.getSnapshotBeforeUpdate(y,_)),$=null!=a&&a.type===p&&null==a.key?a.props.children:a,w(n,Array.isArray($)?$:[$],u,i,t,o,r,f,e,c),h.base=u.__e,u.__h=null,h.__h.length&&f.push(h),b&&(h.__E=h.__=null),h.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=L(i.__e,u,i,t,o,r,f,c);(a=l.diffed)&&a(u)}catch(n){u.__v=null,(c||null!=r)&&(u.__e=e,u.__h=!!c,r[r.indexOf(e)]=null),l.__e(n,u,i)}}function z(n,u){l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function L(l,u,i,t,o,r,e,c){var s,h,v,y=i.props,p=u.props,d=u.type,k=0;if(\"svg\"===d&&(o=!0),null!=r)for(;k<r.length;k++)if((s=r[k])&&\"setAttribute\"in s==!!d&&(d?s.localName===d:3===s.nodeType)){l=s,r[k]=null;break}if(null==l){if(null===d)return document.createTextNode(p);l=o?document.createElementNS(\"http://www.w3.org/2000/svg\",d):document.createElement(d,p.is&&p),r=null,c=!1}if(null===d)y===p||c&&l.data===p||(l.data=p);else{if(r=r&&n.call(l.childNodes),h=(y=i.props||f).dangerouslySetInnerHTML,v=p.dangerouslySetInnerHTML,!c){if(null!=r)for(y={},k=0;k<l.attributes.length;k++)y[l.attributes[k].name]=l.attributes[k].value;(v||h)&&(v&&(h&&v.__html==h.__html||v.__html===l.innerHTML)||(l.innerHTML=v&&v.__html||\"\"))}if(C(l,p,y,o,c),v)u.__k=[];else if(k=u.props.children,w(l,Array.isArray(k)?k:[k],u,i,t,o&&\"foreignObject\"!==d,r,e,r?r[0]:i.__k&&_(i,0),c),null!=r)for(k=r.length;k--;)null!=r[k]&&a(r[k]);c||(\"value\"in p&&void 0!==(k=p.value)&&(k!==l.value||\"progress\"===d&&!k||\"option\"===d&&k!==y.value)&&H(l,\"value\",k,y.value,!1),\"checked\"in p&&void 0!==(k=p.checked)&&k!==l.checked&&H(l,\"checked\",k,y.checked,!1))}return l}function M(n,u,i){try{\"function\"==typeof n?n(u):n.current=u}catch(n){l.__e(n,i)}}function N(n,u,i){var t,o;if(l.unmount&&l.unmount(n),(t=n.ref)&&(t.current&&t.current!==n.__e||M(t,null,u)),null!=(t=n.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(n){l.__e(n,u)}t.base=t.__P=null}if(t=n.__k)for(o=0;o<t.length;o++)t[o]&&N(t[o],u,\"function\"!=typeof n.type);i||null==n.__e||a(n.__e),n.__e=n.__d=void 0}function O(n,l,u){return this.constructor(n,u)}function P(u,i,t){var o,r,e;l.__&&l.__(u,i),r=(o=\"function\"==typeof t)?null:t&&t.__k||i.__k,e=[],j(i,u=(!o&&t||i).__k=h(p,null,[u]),r||f,f,void 0!==i.ownerSVGElement,!o&&t?[t]:r?null:i.firstChild?n.call(i.childNodes):null,e,!o&&t?t:r?r.__e:i.firstChild,o),z(e,u)}function S(n,l){P(n,l,S)}function q(l,u,i){var t,o,r,f=s({},l.props);for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),v(l.type,f,t||l.key,o||l.ref,null)}function B(n,l){var u={__c:l=\"__cC\"+r++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var u,i;return this.getChildContext||(u=[],(i={})[l]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(b)},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n=e.slice,l={__e:function(n,l,u,i){for(var t,o,r;l=l.__;)if((t=l.__c)&&!t.__)try{if((o=t.constructor)&&null!=o.getDerivedStateFromError&&(t.setState(o.getDerivedStateFromError(n)),r=t.__d),null!=t.componentDidCatch&&(t.componentDidCatch(n,i||{}),r=t.__d),r)return t.__E=t}catch(l){n=l}throw n}},u=0,i=function(n){return null!=n&&void 0===n.constructor},d.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=s({},this.state),\"function\"==typeof n&&(n=n(s({},u),this.props)),n&&s(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),b(this))},d.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),b(this))},d.prototype.render=p,t=[],g.__r=0,r=0;export{P as render,S as hydrate,h as createElement,h,p as Fragment,y as createRef,i as isValidElement,d as Component,q as cloneElement,B as createContext,x as toChildArray,l as options};\n//# sourceMappingURL=preact.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,c=[],f=[],e=n.__b,a=n.__r,v=n.diffed,l=n.__c,m=n.unmount;function d(t,u){n.__h&&n.__h(r,t,o||u),o=0;var i=r.__H||(r.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({__V:f}),i.__[t]}function p(n){return o=1,y(z,n)}function y(n,u,i){var o=d(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):z(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.u)){r.u=!0;var c=r.shouldComponentUpdate;r.shouldComponentUpdate=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=!1;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),!!i&&(!c||c.call(this,n,t,r))}}return o.__N||o.__}function h(u,i){var o=d(t++,3);!n.__s&&w(o.__H,i)&&(o.__=u,o.i=i,r.__H.__h.push(o))}function s(u,i){var o=d(t++,4);!n.__s&&w(o.__H,i)&&(o.__=u,o.i=i,r.__h.push(o))}function _(n){return o=5,F(function(){return{current:n}},[])}function A(n,t,r){o=6,s(function(){return\"function\"==typeof n?(n(t()),function(){return n(null)}):n?(n.current=t(),function(){return n.current=null}):void 0},null==r?r:r.concat(n))}function F(n,r){var u=d(t++,7);return w(u.__H,r)?(u.__V=n(),u.i=r,u.__h=n,u.__V):u.__}function T(n,t){return o=8,F(function(){return n},t)}function q(n){var u=r.context[n.__c],i=d(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function x(t,r){n.useDebugValue&&n.useDebugValue(r?r(t):t)}function V(n){var u=d(t++,10),i=p();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n){u.__&&u.__(n),i[1](n)}),[i[0],function(){i[1](void 0)}]}function b(){for(var t;t=c.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(j),t.__H.__h.forEach(k),t.__H.__h=[]}catch(r){t.__H.__h=[],n.__e(r,t.__v)}}n.__b=function(n){r=null,e&&e(n)},n.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=f,n.__N=n.i=void 0})):(i.__h.forEach(j),i.__h.forEach(k),i.__h=[])),u=r},n.diffed=function(t){v&&v(t);var o=t.__c;o&&o.__H&&(o.__H.__h.length&&(1!==c.push(o)&&i===n.requestAnimationFrame||((i=n.requestAnimationFrame)||function(n){var t,r=function(){clearTimeout(u),g&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);g&&(t=requestAnimationFrame(r))})(b)),o.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==f&&(n.__=n.__V),n.i=void 0,n.__V=f})),u=r=null},n.__c=function(t,r){r.some(function(t){try{t.__h.forEach(j),t.__h=t.__h.filter(function(n){return!n.__||k(n)})}catch(u){r.some(function(n){n.__h&&(n.__h=[])}),r=[],n.__e(u,t.__v)}}),l&&l(t,r)},n.unmount=function(t){m&&m(t);var r,u=t.__c;u&&u.__H&&(u.__H.__.forEach(function(n){try{j(n)}catch(n){r=n}}),r&&n.__e(r,u.__v))};var g=\"function\"==typeof requestAnimationFrame;function j(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function k(n){var t=r;n.__c=n.__(),r=t}function w(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function z(n,t){return\"function\"==typeof t?t(n):t}export{p as useState,y as useReducer,h as useEffect,s as useLayoutEffect,_ as useRef,A as useImperativeHandle,F as useMemo,T as useCallback,q as useContext,x as useDebugValue,V as useErrorBoundary};\n//# sourceMappingURL=hooks.module.js.map\n","//@ts-check\n/// <reference path=\"types.js\" />\nimport { assertNonNull, assert, until, sleep } from './utils.js';\nimport { BaseParser, NewParser } from './parser.js';\nimport { load, parseKey, injectStyle } from './script-loader';\nimport * as preact from 'preact';\nimport { useMemo, useCallback, useState, useEffect} from 'preact/hooks';\n\n/** @typedef {(props:Object)=>Elem} Component */\n\nexport const preactParser = new class {\n  \n  /** @type {'@katex'|'@mathjax'} */\n  mathParser = '@katex';\n  codeParser = '@codeFallback';\n\n  _parser = NewParser;\n\n  parseAst = this._parser.parseAst;\n\n  _evalAst = this._parser.evalAstFactory({\n    createElement: this.createElement.bind(this),\n    FragmentComponent: preact.Fragment,\n  })\n  /** @type {(literals:TemplateStringsArray, ...values)=>Elem}*/\n  parse = this._parser.parserFactory(this._evalAst);\n  parseNoMarkup = BaseParser.parserFactory(this._evalAst);\n\n  parseHtml(/** @type {string}*/str){\n    //@ts-ignore\n    return this._evalAst(this._parser.parseAstHtml(str));\n  }\n\n  constructor() {\n    this.contexts = {};\n    this.contexts['core-menu'] = preact.createContext(null);\n  }\n\n  createElement(type, props, ...children) {\n    if (props && props.hasOwnProperty('data-caph')) {\n      let pluginKey = props['data-caph'];\n      if (pluginKey == '@math') pluginKey = this.mathParser;\n      if (pluginKey == '@code') pluginKey = this.codeParser;\n      if (pluginKey) type = this.plugin(pluginKey);\n      else console.warn('caph tag without plugin attribute');\n    }\n    // if(type=='span' && children.length && is_string(children[0]) && children[0].startsWith('\\\\Prob')){\n    //   console.log(type, props, children);\n    // }\n    const vDom = preact.createElement(type, props, ...children);\n    return vDom;\n  }\n\n  /** @type {{[key:string]: Component|Promise<Component>}} */\n  pluginDefs = {\n    'core-error': (async () => ({ children, tooltip }) => {\n      const help = useCallback(() => {\n        const win = window.open('', '_blank');\n        if (!win) throw new Error('Popup blocked');\n        win.document.write(`\n          <div>\n            1. In tex, use \\\\lt and \\\\gt instead of &lt; and &gt;.\n            <br/>\n            2. In html, use \\\\$ instead of $.\n            <br/>\n            This prevents any parsing misunderstanding.\n          </div>\n        `);\n      }, []);\n      return this.parse`\n        <a href=\"./error-help\" onclick=${(e) => {\n        e.preventDefault();\n          help();\n        }}>(help?)</a> \n        <code class=\"caph-flashing caph-error\" title=${tooltip}>${children || tooltip || 'Error'}</code>\n      `;\n    })(),\n    '@paragraphs': (async () =>({ children }) => useMemo(\n        ()=>this._evalAst([null, null, this._parser.spacingRulesParagraphs(preact.toChildArray(children))]),\n        [children],\n    ))(),\n    '@codeFallback': (async () => ({ children, progLang }) => useMemo(\n      ()=>this.parse`<code>${children}</code>`,\n      [children],\n    ))(),\n  };\n\n\n  /** @type {{[key:string]: Component}} */\n  _pluginComponents = {}\n  plugin(key) { // key is either a tag or a url\n    const cache = this._pluginComponents;\n    return cache[key] || (cache[key] = this.componentWrapper(key));\n  }\n\n  /** @type {{[key:string]: Component}} */\n  _componentWrappers = {};\n  componentWrapper(key) {\n    const cache = this._componentWrappers;\n    return cache[key] || (cache[key] = this.newPluginLoader(key));\n  }\n\n  /** @returns {Component} */\n  newPluginLoader(/** @type {string}*/ key){\n    const pluginDefs = this.pluginDefs;\n    const parent = this;\n  \n    //scriptLoader.load('caph-docs/core/plugin-loader.css');\n\n    const loadStatus = {\n      Component: /** @type {null|Component}*/(null),\n      error: null,\n      renderReady: false,\n    }\n\n    function FinalComponent({ children, ...props }) {\n      try {\n        const Component = assertNonNull(loadStatus.Component);\n        const out = Component({ children, ...props });\n        assert(!out.then, `Your component can not be a promise itself (${key}).\n        Maybe you defined pluginDefs[...] = (async ()=>{...}) instead of pluginDefs[...] = (async ()=>{...})()?\n        Please follow the IIFE pattern for async promises.`);\n        return out;\n      } catch (err) {\n        console.error(`Rendering error in plugin ${key}:`, err);\n        return parent.parse`<code class=\"caph-flashing\">${children || '...error...'}</code>`;\n      }\n    }\n\n    function LoadingComponent({ children }) {\n      return parent.parse`\n      <code class=\"caph-flashing\" title=${`${key} is loading...`}>${children || '...'}</code>`;\n    }\n\n    function LoadErrorComponent({}) {\n      return parent.parse`<${parent.plugin('core-error')} tooltip=${loadStatus.error}/>`;\n    }\n\n    const {url, proxyKey} = parseKey(key);\n    const main = async ()=>{\n      // 1. Put the plugin script in the document head and wait for the browser to load the script\n      try{\n        if (pluginDefs.hasOwnProperty(key)){} // already loaded\n        else if (proxyKey) {\n          pluginDefs[key] = parent.componentWrapper(proxyKey);\n        } else if(url) {\n          load(url);\n          await until(() => pluginDefs[url], { timeout: 3800});\n          // assert(pluginDefs[url], `Plugin ${key} not declared in file ${url}`);\n          pluginDefs[key] = pluginDefs[url];\n          if (key != url) delete pluginDefs[url];\n        } else {\n          await until(() => pluginDefs[key], {timeout: 3800});\n        } // User plugin\n      } catch(err){\n        loadStatus.error = err || true;\n        console.error(`Could not load plugin ${key}`, err);\n        return;\n      }\n      // 3. Start the plugin promise but don't wait for it\n      (async()=>{\n        try {\n          loadStatus.Component = await pluginDefs[key];\n          loadStatus.renderReady = true;\n        } catch (err) {\n          loadStatus.error = err || true;\n          console.log(pluginDefs[key])\n          console.error(`Error while awaiting pluginDefs[\"${key}\"]`, err);\n        }\n      })();\n    }\n    main();\n    return ({ children, ...props })=>{\n      const [trigger, setTrigger] = useState(0);\n\n      const asyncLoad = useCallback(async () => {\n        await until(() => loadStatus.renderReady || loadStatus.error);\n        setTrigger(Math.random() * 1e12); // refresh this component\n      }, []);\n      useEffect(()=>{asyncLoad()}, []);\n      \n      const Component = useMemo(()=>{\n        if (loadStatus.renderReady) return FinalComponent;\n        else if (loadStatus.error) return LoadErrorComponent;\n        else return LoadingComponent;\n      }, [trigger]);\n      \n      return Component({ children, ...props })\n    };\n  }\n\n  /**\n   * @param {string} eventName \n   * @param {(data:any)=>void} callback \n   */\n  listenToEvent(eventName, callback) {\n    useEffect(() => {\n      const actualCallback = (/** @type {Event|CustomEvent}*/ e) => {\n        //@ts-ignore: event.detail is not defined for non-custom events\n        try{callback(e.detail);}\n        catch(err){}\n      }\n      window.addEventListener(eventName, actualCallback);\n      return () => {\n        window.removeEventListener(eventName, actualCallback);\n      }\n    }, [eventName, callback]);\n  }\n\n  _globals = {};\n  dispatchGlobal(eventName, value) {\n    this._globals[eventName] = value;\n    let event = new CustomEvent(eventName, {detail:value});\n    window.dispatchEvent(event);\n    return;\n  }\n  async untilGlobal(eventName) {\n    await until(() => this._globals[eventName]);\n    await sleep(500);\n  }\n  listenToGlobal(eventName) {\n    const initial = useMemo(()=>this._globals[eventName], [eventName]);\n    const [value, setValue] = useState(initial);\n    this.listenToEvent(eventName, setValue);\n    return value;\n  }\n\n  // _URL_is_absolute(url) {\n  //   //https://stackoverflow.com/q/10687099\n  //   return new URL(document.baseURI).origin !== new URL(url, document.baseURI).origin;\n  // }\n\n}\n\ninjectStyle(`\n.caph-error{\n  color: #ce1111;\n}\n.caph-flashing{\n  -webkit-animation: caphFlashingAnimation 1s linear infinite;\n  animation: caphFlashingAnimation 1s linear infinite;\n}\n@keyframes caphFlashingAnimation {\n  0% { opacity: 0.3; }\n  100% { opacity: 1; }\n}\n\n.caph-hidden{\n  display: none;\n}\n\n.caph-box-shadow{\n  box-shadow: 0px 0px 0.3rem 0.05rem var(--box-shadow);\n}\n.caph-box-shadow:hover{\n  box-shadow: 0px 0px 0.3rem 0.2rem var(--box-shadow);\n}\n.caph-fullscreen-layer{\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 100;\n}\n.caph-hbox{ display: flex; }\n.caph-vbox{ display: flex; flex-direction: column; }\n.caph-boxcenter{ justify-content: center; }\n.caph-space-around{ justify-content: space-around; }\n.caph-space-between{ justify-content: space-between; }\n.caph-flex{ flex: 1; }\n.caph-hidden{ display:none; }\n.caph-plugin-hidden{ display:none; }\n.caph-border{\n  border: solid 2px var(--text-strong);\n}`)\n","//@ts-check\nimport { MyPromise } from \"./utils\";\nimport { preactParser } from \"./preact-parser\";\nimport { createContext, render } from \"preact\";\nimport {useMemo, useCallback, useState, useEffect} from 'preact/hooks';\n\nexport const parser = preactParser;\nexport const contexts = {};\ncontexts['core-menu'] = createContext(null);\n\nexport const _globals = {};\nexport function dispatchGlobal(eventName, value) {\n  //console.log('Dispatch', eventName, value);\n  _globals[eventName] = value;\n  let event = new CustomEvent(eventName, {detail:value});\n  window.dispatchEvent(event);\n  return;\n}\nexport async function untilGlobal(eventName) {\n  await MyPromise.until(() => _globals[eventName]);\n  await MyPromise.sleep(500);\n}\nexport function listenToGlobal(eventName) {\n  const initial = useMemo(()=>_globals[eventName], [eventName]);\n  const [value, setValue] = useState(initial);\n  listenToEvent(eventName, setValue);\n  return value;\n}\n\nexport const menu = new class {\n  constructor() {\n    this.addOption('Default', { hold: true });\n    this.latest = this.option = 'Default';\n  }\n  options = [];\n  onEnter = {};\n  onExit = {};\n  hold = {};\n\n  /**\n   * @param {string} option\n   * @param {{onEnter?:()=>void, onExit?:()=>void, hold?:boolean}} options\n  */\n  addOption(option, { onEnter, onExit, hold } = {}) {\n    this.onEnter[option] = onEnter;\n    this.onExit[option] = onExit;\n    this.hold[option] = hold;\n    if (this.options[option]) return;\n    this.options.push(option);\n    this.options[option] = 1;\n    dispatchGlobal('caph-menu-options', Math.random());\n  }\n  setOption(option) {\n    dispatchGlobal('caph-menu-option', Math.random());\n    if (this.hold[option]) {\n      this.onExit[this.latest] && this.onExit[this.latest]();\n      this.latest = this.option;\n      this.option = option;\n    }\n    this.onEnter[option] && this.onEnter[option]();\n  }\n};\n\nexport async function inject(vDom) {\n  // const node = MyDocument.createElement('div', {\n  //   parent: document.body,\n  //   where: 'afterbegin',\n  //   id: 'core-body',\n  // })\n  const node = document.body;\n  render(vDom, node);\n}\n\nMyPromise.until(() => document.body).then(()=>{\n  inject(parser.parse`\n    <${parser.plugin('@core-menu')}/>\n    <${parser.plugin('@core-about')}/>\n  `);\n});\n\n/**\n * @param {string} eventName \n * @param {(data:any)=>void} callback \n */\nexport function listenToEvent(eventName, callback) {\n  useEffect(() => {\n    const actualCallback = (/** @type {Event|CustomEvent}*/ e) => {\n      //@ts-ignore: event.detail is not defined for non-custom events\n      try{callback(e.detail);}\n      catch(err){}\n    }\n    window.addEventListener(eventName, actualCallback);\n    return () => {\n      window.removeEventListener(eventName, actualCallback);\n    }\n  }, [eventName, callback]);\n}\n\n","//@ts-check\nimport { MyPromise, sleep, assert, Queue, assertNonNull } from \"./utils\";\nimport { NewParser } from \"./parser\";\nimport { preactParser } from \"./preact-parser\";\nimport { contexts, menu, listenToEvent, listenToGlobal } from \"./preact-globals\";\nimport { toChildArray } from \"preact\";\nimport { useMemo, useState } from \"preact/hooks\";\nimport { load, injectStyle } from \"./script-loader\";\nimport * as scriptLoader from \"./script-loader\";\nimport * as preactBase from \"preact\";\nimport * as preactHooks from \"preact/hooks\";\nimport { compressor, decompress } from \"./build-constants\";\n/** @typedef {import(\"./preact-parser\").Component} Component */ \n\n\nexport const preact = {...preactBase, ...preactHooks};\nwindow[\"preact\"] = preact;\n\nexport { scriptLoader, load, injectStyle };\n\n/** @template {Function} T @param {T} func @param {Object} obj @returns {T} */\nconst bind = (func, obj)=>func.bind(obj);\n\nexport const parseAst = bind(NewParser.parseAst, NewParser);\nexport const parser = preactParser;\nexport const pluginDefs = parser.pluginDefs;\nexport const parse = bind(parser.parse, parser);\nexport const parseNoMarkup = bind(parser.parseNoMarkup, parser);\nexport const plugin = bind(parser.plugin, parser);\n\nexport const parseHtmlAst = (/** @type {string}*/str)=>{\n  return NewParser.parseAstHtml(str);\n}\nexport const parseHtml = (/** @type {string}*/str)=>{\n  //@ts-ignore\n  return parser._evalAst(parseHtmlAst(str));\n}\nexport const parseElem = (/** @type {HTMLElement}*/elem, /** @type {('clear'|'hide'|'remove')?}*/action) => {\n  const html = elem.innerHTML;\n  if(!action){} // Do nothing\n  else if(action=='clear') elem.innerHTML = '';\n  else if(action=='remove') elem.remove();\n  else if (action=='hide') elem.classList.add('caph-hidden');\n  return parseHtml(html);\n}\n\nexport const until = MyPromise.until;\nexport {assert, sleep};\nexport const collections = { Queue };\nexport {contexts, menu, listenToEvent, listenToGlobal};\n\n\n/** @param {Component | Promise<Component>} definition */ \nexport const defineFileComponent = (definition)=>{\n  const elem = assertNonNull(document?.currentScript);\n  /** @type {string}*/\n  const src = elem.getAttribute('data-original-src')||elem['src'];\n  pluginDefs[src] = definition;\n}\n\n/** @param {string} dist @param {string} compressedSequence */ \nexport const injectCompressedScript = async (dist, compressedSequence)=>{\n  /* Used in all compressed plugins. See build-plugins.js */  \n  await load(compressor.dist);\n  await until(()=>window['LZUTF8']);\n  const jsCode = decompress(window[\"LZUTF8\"], compressedSequence);\n  const e = document.createElement('script');\n  const {url} = scriptLoader.parseKey(dist);\n  e.setAttribute('data-original-src', url);\n  e.innerHTML = jsCode;\n  document.getElementById('core-sources')?.insertAdjacentElement('beforeend', e);\n}\n\n\n\nexport const settings = {\n  get mathParser(){ return parser.mathParser; },\n  mathMacros: {},\n  set mathParser(/** @type {'@katex'|'@mathjax'} */value) {\n    parser.mathParser = value;\n  }\n};\n\ninjectStyle(`\ndiv.caph-paragraph + div.caph-paragraph { margin-top: 1em; }\n.caph-paragraph h1,h2,h3,h4,h5,h6,ul,ol{ margin:0; }\n`);\n\n// tab effects: https://alvarotrigo.com/blog/html-css-tabs/\ninjectStyle(`\n.tabs-header>label>input { display: none; }\n.tabs-parent { width: 100%; }\n.tabs-header {\n  margin-top: 0.1em;\n  border-bottom: 1px solid;\n}\n.tab-label:hover {\n  top: -0.25rem;\n  transition: top 0.25s;\n}\n.tabs{\n  border: solid 1px;\n  border-top: none;\n}\n.tab-label {\n  padding-left: 1em;\n  padding-right: 1em;\n  border-radius: 0.3em 0.3em 0 0;\n  background: unset;\n  border: solid 1px;\n  white-space:nowrap;\n}\n/* https://stackoverflow.com/a/10148189/3671939 */\n.tab-label { white-space:nowrap; }\n.tab-label > span{ white-space: normal; }\n\n.tab-label-true {\n  font-weight: bold;\n  border-bottom: solid 2px white;\n}\n.tab-content-false { display:none; }\n.tab-content-true {\n  display: true;\n  opacity: 1;\n\tanimation-name: fadeInOpacity;\n\tanimation-iteration-count: 1;\n\tanimation-timing-function: ease-in;\n\tanimation-duration: 0.15s;\n}\n@keyframes fadeInOpacity {\n\t0% { opacity: 0; }\n\t100% { opacity: 1;}\n}\n.tab-content-true { padding: 1vw; }\n`);\npluginDefs['@tabs'] = ({/** @type {string[]} */ labels, defaultLabel, children})=>{\n  const zipped = useMemo(()=>toChildArray(children).map(\n    (child,i) => ({label:labels[i]||`Tab ${i+1}`, child})\n  ), [labels, children]);\n  const [option, setOption] = useState(defaultLabel || zipped[0]?.label);\n  return parse`\n  <div class=\"tabs-parent\">\n    <div class=\"tabs-header\">\n      ${labels.map((label)=>parse`\n        <label class=\"tab-label\" class=${'tab-label-'+(option==label)}>\n          <input type=\"radio\" checked=${option==label} onClick=${()=>setOption(label)}/>\n          <span>${label}</>\n        </label>`\n      )}\n    </div>\n    <div class=\"tabs\">\n      ${zipped.map(({label, child})=>parse`\n        <div class=${'tab-content-'+(option==label)}>${child}</>`\n      )}\n    </div>\n  </>`;\n}\n","import * as caph from './main';\n\nexport default caph;"],"names":["ConsoleProxy","log","args","console","warn","this","error","BaseParser","ESC","SPEC","DEBUG","static","raw","strings","values","root","constructor","debug","cls","str","join","escaped","regEscaped","RegExp","replace","match","index","pos","valueIndex","errorStop","customRules","optionalClose","bind","REG_EXP_TEXT","map","regStart","parent","parseRoot","parseChildrenAndParentClose","name","length","parentTag","parentProps","children","childlessTags","br","area","base","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","tag","_optionalClose","run","regExp","lastIndex","exec","throw","tryRun","e","tryRunUndo","debugPosition","delta","at","Math","max","slice","text","push","value","Array","isArray","startsWith","consumeComment","endReached","parsedRule","regEnd","parser","m","replaceText","result","_tag","newParent","grandParent","parseParent","pop","reg","undefined","admitsChildren","toLowerCase","spacing","key","_value","endsWith","eval","prevValue","includes","code","htmlSafe","spacingRulesJsx","spacingRulesParagraphs","stack","filter","x","reverse","newChildren","split","forEach","i","_","l","middle","r","trimText","first","elems","reason","Error","regComment","posOfText","original","Option","innerHTML","content","DOMParser","parseFromString","documentElement","textContent","astUndoHtml","htmlSafeUndo","child","tmp","parseAst","post","createElement","FragmentComponent","type","props","createTree","evalAst","evalAstFactory","parse","parserFactory","parse1","parse2","parseAst1","parseAst2","NewParser","super","displayMode","inline","progLang","assertNonNull","isString","obj","Object","prototype","toString","call","assert","condition","messages","sleep","ms","Promise","ok","err","setTimeout","MyPromise","promises","any_error","cnt","outs","p","all","async","finish_all","func","timeout","t0","Date","getTime","Timeout","promise","finished","resp","then","until","MyDocument","style","id","classList","html","eventListeners","where","attrs","document","setAttribute","s","add","innerText","MyObject","addEventListener","body","insertAdjacentElement","element","focus","window","CustomEvent","dispatchEvent","createEvent","ev","initEvent","fireEvent","arr","M","_object_op","op","src","dest","keys","_func","dotted","v","k","indexOf","no_dots","start","end","reduce_dots","objs","o","deep_assign","deep_copy","default_obj","filter_func","Queue","data","lr","capacity","j","toArray","concat","Symbol","iterator","next","done","resize","newLength","fill","_mod_add","lrIndex","retK","afterK","mod","out","pushRight","pushLeft","popRight","popLeft","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","defineProperty","enumerable","get","prop","hasOwnProperty","toStringTag","compressed","distPlugins","dist","plugins","fromEntries","scriptLoader","querySelectorAll","div","getElementById","head","_randomSessionSuffix","random","parseKey","url","URL","baseURI","href","proxyKey","status","injectStyle","styleStr","load","ref","autoAttrs","refBase","ext","defaults","rel","_ok","_err","onload","onerror","_load_elem","n","u","t","f","c","a","parentNode","removeChild","h","arguments","defaultProps","__k","__","__b","__e","__d","__c","__h","__v","vnode","y","current","context","b","g","__r","debounceRendering","sort","some","__P","__n","ownerSVGElement","z","w","C","A","N","appendChild","nextSibling","insertBefore","$","setProperty","test","H","cssText","T","I","removeEventListener","removeAttribute","event","contextType","__E","render","O","sub","state","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","L","diffed","localName","nodeType","createTextNode","createElementNS","is","childNodes","dangerouslySetInnerHTML","attributes","__html","checked","unmount","componentWillUnmount","P","firstChild","S","q","B","Consumer","Provider","splice","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","__H","__V","__N","every","F","V","shift","clearTimeout","cancelAnimationFrame","requestAnimationFrame","preactParser","mathParser","codeParser","_parser","_evalAst","parseNoMarkup","parseHtml","parseAstHtml","contexts","pluginKey","plugin","pluginDefs","tooltip","help","win","open","write","preventDefault","_pluginComponents","cache","componentWrapper","_componentWrappers","newPluginLoader","loadStatus","Component","renderReady","FinalComponent","LoadingComponent","LoadErrorComponent","main","trigger","setTrigger","asyncLoad","listenToEvent","eventName","callback","actualCallback","detail","_globals","dispatchGlobal","listenToGlobal","initial","setValue","menu","addOption","hold","latest","option","options","onEnter","onExit","setOption","vDom","inject","preact","parseHtmlAst","parseElem","elem","action","remove","collections","defineFileComponent","currentScript","getAttribute","injectCompressedScript","compressedSequence","jsCode","compressor","decompress","inputEncoding","settings","mathMacros","labels","defaultLabel","zipped","label"],"sourceRoot":""}